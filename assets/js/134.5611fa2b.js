(window.webpackJsonp=window.webpackJsonp||[]).push([[134],{561:function(t,s,a){"use strict";a.r(s);var e=a(1),n=Object(e.a)({},(function(){var t=this,s=t.$createElement,a=t._self._c||s;return a("ContentSlotsDistributor",{attrs:{"slot-key":t.$parent.slotKey}},[a("h1",{attrs:{id:"如何理解回流和重绘"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#如何理解回流和重绘"}},[t._v("#")]),t._v(" 如何理解回流和重绘")]),t._v(" "),a("p",[a("code",[t._v("回流")]),t._v("：当我们对 DOM 的修改引发了 "),a("strong",[t._v("DOM 几何尺寸的变化")]),t._v("（比如修改元素的"),a("code",[t._v("宽、高或隐藏元素")]),t._v("等）时，浏览器"),a("strong",[t._v("需要重新计算")]),t._v("元素的几何属性（其他元素的几何属性和位置也会因此受到影响），然后再将计算的结果绘制出来。这个过程就是"),a("strong",[t._v("回流")]),t._v("（也叫"),a("strong",[t._v("重排")]),t._v("）。")]),t._v(" "),a("p",[a("code",[t._v("重绘")]),t._v("：当我们对 DOM 的修改导致了"),a("strong",[t._v("样式的变化")]),t._v("、却并未影响其几何属性（比如修改了"),a("code",[t._v("颜色或背景色")]),t._v("）时，浏览器"),a("strong",[t._v("不需重新计算")]),t._v("元素的几何属性、直接为该元素"),a("strong",[t._v("绘制新的样式")]),t._v("（跳过了上图所示的回流环节）。这个过程叫做"),a("strong",[t._v("重绘")]),t._v("。 由此我们可以看出，重绘不一定导致回流，回流一定会导致重绘")]),t._v(" "),a("h2",{attrs:{id:"常见的会导致回流的元素"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#常见的会导致回流的元素"}},[t._v("#")]),t._v(" 常见的会导致回流的元素")]),t._v(" "),a("p",[t._v("常见的几何属性有 "),a("code",[t._v("width、height、padding、margin、left、top、border")]),t._v(" 等等。\n最容易被忽略的操作：获取一些需要通过即时计算得到的属性,当你要用到像这样的属性："),a("code",[t._v("offsetTop、offsetLeft、 offsetWidth、offsetHeight、scrollTop、scrollLeft、scrollWidth、scrollHeight、clientTop、clientLeft、clientWidth、clientHeight")]),t._v(" 时，浏览器为了获取这些最新的值，就会进行回流。\n当我们调用了 "),a("code",[t._v("getComputedStyle")]),t._v(" 方法，或者 IE 里的 "),a("code",[t._v("currentStyle")]),t._v(" 时，也会触发回流。原理是一样的，都为求一个“即时性”和“准确性”。")]),t._v(" "),a("h2",{attrs:{id:"避免方式"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#避免方式"}},[t._v("#")]),t._v(" 避免方式")]),t._v(" "),a("ol",[a("li",[a("p",[t._v("避免逐条改变样式，使用"),a("strong",[t._v("类名")]),t._v("去合并样式")])]),t._v(" "),a("li",[a("p",[t._v("将 DOM “离线”, 使用文档片段 "),a("code",[t._v("DocumentFragment")])]),t._v(" "),a("p",[t._v("可以看下如下 demo：")]),t._v(" "),a("div",{staticClass:"language-js extra-class"},[a("pre",{pre:!0,attrs:{class:"language-js"}},[a("code",[a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// Create the fragment")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("var")]),t._v(" fragment "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" document"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("createDocumentFragment")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("//add DOM to fragment")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("var")]),t._v(" spanNode "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" document"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("createElement")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'span'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\nspanNode"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("innerHTML "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'Hello World'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\nfragment"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("appendChild")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("spanNode"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n")])])]),a("p",[t._v("//add this DOM to body\ndocument.body.appendChild(spanNode);")]),t._v(" "),a("div",{staticClass:"language- extra-class"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[t._v("\n")])])])]),t._v(" "),a("li",[a("p",[t._v("提升为合成层,如使用"),a("code",[t._v("will-change")])])])]),t._v(" "),a("div",{staticClass:"language-css extra-class"},[a("pre",{pre:!0,attrs:{class:"language-css"}},[a("code",[a("span",{pre:!0,attrs:{class:"token selector"}},[t._v("#divId")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token property"}},[t._v("will-change")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" transform"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n")])])]),a("h2",{attrs:{id:"优点"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#优点"}},[t._v("#")]),t._v(" 优点")]),t._v(" "),a("ul",[a("li",[t._v("合成层的位图，会交由 "),a("code",[t._v("GPU")]),t._v(" 合成，比 "),a("code",[t._v("CPU")]),t._v(" 处理要快")]),t._v(" "),a("li",[t._v("当需要 "),a("code",[t._v("repaint")]),t._v(" 时，只需要 "),a("code",[t._v("repaint")]),t._v(" 本身，不会影响到其他的层")]),t._v(" "),a("li",[t._v("对于 "),a("code",[t._v("transform")]),t._v(" 和 "),a("code",[t._v("opacity")]),t._v(" 效果，不会触发 "),a("code",[t._v("layout")]),t._v(" 和 "),a("code",[t._v("paint")])])]),t._v(" "),a("h2",{attrs:{id:"注意"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#注意"}},[t._v("#")]),t._v(" 注意")]),t._v(" "),a("p",[t._v("部分浏览器缓存了一个 "),a("code",[t._v("flush")]),t._v(" 队列，把我们触发的回流与重绘任务都塞进去，待到队列里的任务多起来、或者达到了一定的时间间隔，或者“不得已”的时候，再将这些任务一口气出队。但是当我们访问一些"),a("strong",[t._v("即时属性")]),t._v("时，浏览器会为了获得"),a("strong",[t._v("此时此刻的、最准确")]),t._v("的属性值，而提前将 "),a("code",[t._v("flush")]),t._v(" 队列的任务出队。")]),t._v(" "),a("h2",{attrs:{id:"最后"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#最后"}},[t._v("#")]),t._v(" 最后")]),t._v(" "),a("p",[t._v("文中若有不准确或错误的地方，欢迎指出，有兴趣可以的关注下"),a("a",{attrs:{href:"https://github.com/GolderBrother",target:"_blank",rel:"noopener noreferrer"}},[t._v("Github"),a("OutboundLink")],1),t._v("，一起学习呀~~")]),t._v(" "),a("comment")],1)}),[],!1,null,null,null);s.default=n.exports}}]);