(window.webpackJsonp=window.webpackJsonp||[]).push([[170],{609:function(a,s,t){"use strict";t.r(s);var e=t(1),n=Object(e.a)({},(function(){var a=this,s=a.$createElement,t=a._self._c||s;return t("ContentSlotsDistributor",{attrs:{"slot-key":a.$parent.slotKey}},[t("h1",{attrs:{id:"rn-配置热更新-使用文档"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#rn-配置热更新-使用文档"}},[a._v("#")]),a._v(" RN 配置热更新+使用文档")]),a._v(" "),t("h2",{attrs:{id:"一、搭建本地code-push服务"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#一、搭建本地code-push服务"}},[a._v("#")]),a._v(" 一、搭建本地"),t("code",[a._v("Code Push")]),a._v("服务")]),a._v(" "),t("p",[a._v("配置本地服务端和注册 app 等，参考")]),a._v(" "),t("p",[t("a",{attrs:{href:"https://www.wddsss.com/main/displayArticle/224",target:"_blank",rel:"noopener noreferrer"}},[a._v("最新 React Native 搭建本地 Code Push 服务(非常全！)"),t("OutboundLink")],1)]),a._v(" "),t("h3",{attrs:{id:"_1-首先全局安装微软提供的-code-push-cli-工具"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_1-首先全局安装微软提供的-code-push-cli-工具"}},[a._v("#")]),a._v(" 1. 首先全局安装微软提供的 code-push-cli 工具")]),a._v(" "),t("div",{staticClass:"language-bash extra-class"},[t("pre",{pre:!0,attrs:{class:"language-bash"}},[t("code",[t("span",{pre:!0,attrs:{class:"token function"}},[a._v("npm")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token function"}},[a._v("install")]),a._v(" code-push-cli@latest -g\n")])])]),t("h4",{attrs:{id:"常用code-push命令"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#常用code-push命令"}},[a._v("#")]),a._v(" 常用"),t("code",[a._v("code-push")]),a._v("命令")]),a._v(" "),t("ul",[t("li",[t("p",[a._v("注册账号: code-push register")])]),a._v(" "),t("li",[t("p",[a._v("登陆: code-push login")])]),a._v(" "),t("li",[t("p",[a._v("注销: code-push logout")])]),a._v(" "),t("li",[t("p",[a._v("添加项目: code-push app add app 名称")])]),a._v(" "),t("li",[t("p",[a._v("删除项目: code-push app remove app 名称")])]),a._v(" "),t("li",[t("p",[a._v("列出账号下的所有项目: code-push app list")])]),a._v(" "),t("li",[t("p",[a._v("显示登陆的 token: code-push access-key ls")])]),a._v(" "),t("li",[t("p",[a._v("部署一个环境: code-push deployment add appName deploymentName")])]),a._v(" "),t("li",[t("p",[a._v("删除部署: code-push deployment rm appName")])]),a._v(" "),t("li",[t("p",[a._v("列出应用的部署: code-push deployment ls appName")])]),a._v(" "),t("li",[t("p",[a._v("查询部署环境的 key: code-push deployment ls appName -k")])])]),a._v(" "),t("p",[a._v("我们会在后面使用此工具创建，发布，更新 App")]),a._v(" "),t("h3",{attrs:{id:"_2-登录code-push服务器"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_2-登录code-push服务器"}},[a._v("#")]),a._v(" 2. 登录"),t("code",[a._v("Code Push")]),a._v("服务器")]),a._v(" "),t("div",{staticClass:"language-bash extra-class"},[t("pre",{pre:!0,attrs:{class:"language-bash"}},[t("code",[t("span",{pre:!0,attrs:{class:"token comment"}},[a._v("# code-push login http://localhost:3000")]),a._v("\ncode-push login http://172.16.6.190:3000\n")])])]),t("div",{staticClass:"language- extra-class"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[a._v("账号：\nadmin\n密码：\n123456\n")])])]),t("blockquote",[t("p",[a._v("如已经登陆, 需要注销, 执行下面命令")])]),a._v(" "),t("div",{staticClass:"language-bash extra-class"},[t("pre",{pre:!0,attrs:{class:"language-bash"}},[t("code",[a._v("code-push "),t("span",{pre:!0,attrs:{class:"token builtin class-name"}},[a._v("logout")]),a._v("\n")])])]),t("h3",{attrs:{id:"_3-创建应用"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_3-创建应用"}},[a._v("#")]),a._v(" 3. 创建应用")]),a._v(" "),t("h4",{attrs:{id:"android-应用"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#android-应用"}},[a._v("#")]),a._v(" "),t("code",[a._v("Android")]),a._v(" 应用")]),a._v(" "),t("div",{staticClass:"language-bash extra-class"},[t("pre",{pre:!0,attrs:{class:"language-bash"}},[t("code",[a._v("code-push app "),t("span",{pre:!0,attrs:{class:"token function"}},[a._v("add")]),a._v(" CodePushAndroid android react-native\n")])])]),t("h4",{attrs:{id:"ios-应用"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#ios-应用"}},[a._v("#")]),a._v(" "),t("code",[a._v("iOS")]),a._v(" 应用")]),a._v(" "),t("div",{staticClass:"language-bash extra-class"},[t("pre",{pre:!0,attrs:{class:"language-bash"}},[t("code",[a._v("code-push app "),t("span",{pre:!0,attrs:{class:"token function"}},[a._v("add")]),a._v(" CodePushIos iOS react-native\n")])])]),t("p",[a._v("然后输入到命令行终端中，执行完毕会生成两个 "),t("code",[a._v("key")]),a._v(", 发给原生开发人员")]),a._v(" "),t("p",[a._v("就像这样 👇")]),a._v(" "),t("div",{staticClass:"language-command extra-class"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[a._v('Successfully added the "CodePushAndroid" app, along with the following default deployments:\n┌────────────┬───────────────────────────────────────┐\n│ Name       │ Deployment Key                        │\n├────────────┼───────────────────────────────────────┤\n│ Production │ kl6jlkEF5tIH34QVuuxkPrVNQKOl4ksvOXqog │\n├────────────┼───────────────────────────────────────┤\n│ Staging    │ YTMOeRcENaByW4jIvl8CVFnTJAYm4ksvOXqog │\n└────────────┴───────────────────────────────────────┘\n')])])]),t("blockquote",[t("p",[a._v("如果已经存在应用, 需要删除后重新创建, 或者直接使用原来的 "),t("code",[a._v("key")]),a._v(" (原生那边就不用更改), 具体的查看下面的"),t("strong",[a._v("获取应用的 "),t("code",[a._v("Key")])])])]),a._v(" "),t("h3",{attrs:{id:"_4-更新应用"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_4-更新应用"}},[a._v("#")]),a._v(" 4. 更新应用")]),a._v(" "),t("p",[t("code",[a._v("react-native")]),a._v(" 项目下执行，"),t("code",[a._v("test")]),a._v(" 用来匹配是否检查安装应用")]),a._v(" "),t("div",{staticClass:"language-bash extra-class"},[t("pre",{pre:!0,attrs:{class:"language-bash"}},[t("code",[a._v("code-push release-react CodePushAndroid android --d Production --t "),t("span",{pre:!0,attrs:{class:"token number"}},[a._v("0.1")]),a._v(".0 --des "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("[")]),a._v("test"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("]")]),a._v("生产环境更新1 --m "),t("span",{pre:!0,attrs:{class:"token boolean"}},[a._v("true")]),a._v("\n")])])]),t("div",{staticClass:"language-bash extra-class"},[t("pre",{pre:!0,attrs:{class:"language-bash"}},[t("code",[a._v("code-push release-react CodePushAndroid android --d Staging --t "),t("span",{pre:!0,attrs:{class:"token number"}},[a._v("0.1")]),a._v(".0 --des "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("[")]),a._v("test"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("]")]),a._v("测试环境更新1 --m "),t("span",{pre:!0,attrs:{class:"token boolean"}},[a._v("true")]),a._v("\n")])])]),t("div",{staticClass:"language-bash extra-class"},[t("pre",{pre:!0,attrs:{class:"language-bash"}},[t("code",[a._v("code-push release-react CodePushIos ios --d Production --t "),t("span",{pre:!0,attrs:{class:"token number"}},[a._v("0.1")]),a._v(".0 --des "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("[")]),a._v("test"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("]")]),a._v("生产环境更新1 --m "),t("span",{pre:!0,attrs:{class:"token boolean"}},[a._v("true")]),a._v("\n")])])]),t("div",{staticClass:"language-bash extra-class"},[t("pre",{pre:!0,attrs:{class:"language-bash"}},[t("code",[a._v("code-push release-react CodePushIos ios --d Staging --t "),t("span",{pre:!0,attrs:{class:"token number"}},[a._v("0.1")]),a._v(".0 --des "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("[")]),a._v("test"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("]")]),a._v("测试环境更新1 --m "),t("span",{pre:!0,attrs:{class:"token boolean"}},[a._v("true")]),a._v("\n")])])]),t("p",[a._v("参数说明：")]),a._v(" "),t("ul",[t("li",[t("code",[a._v("d")]),a._v(": 发布的环境，"),t("code",[a._v("Staging")]),a._v(" 表示开发人员自己调试使用的环境，"),t("code",[a._v("Production")]),a._v(" 表示发布给测试人员使用的环境")]),a._v(" "),t("li",[t("code",[a._v("t")]),a._v(": 版本号，只支持 3 位数，跟原生应用约定好一致")]),a._v(" "),t("li",[t("code",[a._v("des")]),a._v(": 版本描述：其中的 "),t("code",[a._v("test")]),a._v(" 表示发给设定了版本表示为 "),t("code",[a._v("test")]),a._v(" 的安装包, 如果没有写, 表示通知所有安装包")])]),a._v(" "),t("p",[a._v("更新成功后, 是这样的 👇")]),a._v(" "),t("div",{staticClass:"language-command extra-class"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[a._v('node node_modules\\react-native\\local-cli\\cli.js bundle --assets-dest C:\\Users\\12047\\AppData\\Local\\Temp\\CodePush\\CodePush --bundle-output C:\\Users\\12047\\AppData\\Local\\Temp\\CodePush\\CodePush\\index.android.bundle --dev false --entry-file index.js --platform android\nWelcome to React Native!\n                Learn once, write anywhere\n\ninfo Writing bundle output to:, C:\\Users\\12047\\AppData\\Local\\Temp\\CodePush\\CodePush\\index.android.bundle\ninfo Done writing bundle output\ninfo Copying 192 asset files\ninfo Done copying assets\n\nReleasing update contents to CodePush:\n\n\nSuccessfully released an update containing the "C:\\Users\\12047\\AppData\\Local\\Temp\\CodePush\\CodePush" directory to the "Staging" deployment of the "CodePushAndroid" app.\n\n')])])]),t("h4",{attrs:{id:"静默更新应用-不弹窗，后台下载"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#静默更新应用-不弹窗，后台下载"}},[a._v("#")]),a._v(" 静默更新应用(不弹窗，后台下载)")]),a._v(" "),t("p",[a._v("比如在"),t("code",[a._v("iOS")]),a._v("平台，执行以下命令：")]),a._v(" "),t("p",[a._v("测试环境")]),a._v(" "),t("div",{staticClass:"language-bash extra-class"},[t("pre",{pre:!0,attrs:{class:"language-bash"}},[t("code",[a._v("\ncode-push release-react CodePushIos ios --d Staging --t "),t("span",{pre:!0,attrs:{class:"token number"}},[a._v("1.2")]),a._v(".1 --des "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("[")]),a._v("test"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("]")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("{")]),a._v("SilentUpdate"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("}")]),a._v("测试环境静默更新 --m "),t("span",{pre:!0,attrs:{class:"token boolean"}},[a._v("true")]),a._v("\n")])])]),t("p",[a._v("生产环境")]),a._v(" "),t("div",{staticClass:"language-bash extra-class"},[t("pre",{pre:!0,attrs:{class:"language-bash"}},[t("code",[a._v("code-push release-react CodePushIos ios --d Production --t "),t("span",{pre:!0,attrs:{class:"token number"}},[a._v("1.2")]),a._v(".1 --des "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("[")]),a._v("test"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("]")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("{")]),a._v("SilentUpdate"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("}")]),a._v("测试环境静默更新 --m "),t("span",{pre:!0,attrs:{class:"token boolean"}},[a._v("true")]),a._v("\n")])])]),t("p",[a._v("其中, 在"),t("code",[a._v("des")]),a._v("中添加"),t("code",[a._v("{SilentUpdate}")]),a._v("表示走静默更新，这边是完全匹配，如果匹配的话就在后台自动下载更新，不会再弹框提示")]),a._v(" "),t("h3",{attrs:{id:"_5-获取应用的-key"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_5-获取应用的-key"}},[a._v("#")]),a._v(" 5. 获取应用的 "),t("code",[a._v("Key")])]),a._v(" "),t("div",{staticClass:"language-bash extra-class"},[t("pre",{pre:!0,attrs:{class:"language-bash"}},[t("code",[a._v("code-push deployment "),t("span",{pre:!0,attrs:{class:"token function"}},[a._v("ls")]),a._v(" CodePushAndroid -k\n")])])]),t("div",{staticClass:"language-bash extra-class"},[t("pre",{pre:!0,attrs:{class:"language-bash"}},[t("code",[a._v("code-push deployment "),t("span",{pre:!0,attrs:{class:"token function"}},[a._v("ls")]),a._v(" CodePushIos -k\n")])])]),t("h3",{attrs:{id:"_6-清除推送的更新-终止"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_6-清除推送的更新-终止"}},[a._v("#")]),a._v(" 6. 清除推送的更新(终止)")]),a._v(" "),t("div",{staticClass:"language-bash extra-class"},[t("pre",{pre:!0,attrs:{class:"language-bash"}},[t("code",[a._v("code-push deployment "),t("span",{pre:!0,attrs:{class:"token function"}},[a._v("clear")]),a._v(" CodePushAndroid staging\n")])])]),t("div",{staticClass:"language-bash extra-class"},[t("pre",{pre:!0,attrs:{class:"language-bash"}},[t("code",[a._v("code-push deployment "),t("span",{pre:!0,attrs:{class:"token function"}},[a._v("clear")]),a._v(" CodePushIos staging\n")])])]),t("h2",{attrs:{id:"二、配置安卓环境（自动-link-可能会导致失败）"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#二、配置安卓环境（自动-link-可能会导致失败）"}},[a._v("#")]),a._v(" 二、配置安卓环境（自动 "),t("code",[a._v("link")]),a._v(" 可能会导致失败）")]),a._v(" "),t("h3",{attrs:{id:"_1-android-settings-gradle-file-添加"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_1-android-settings-gradle-file-添加"}},[a._v("#")]),a._v(" 1. "),t("code",[a._v("android/settings.gradle file")]),a._v(" 添加")]),a._v(" "),t("div",{staticClass:"language- extra-class"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[a._v("include ':app', ':react-native-code-push'\nproject(':react-native-code-push').projectDir = new File(rootProject.projectDir, '../node_modules/react-native-code-push/android/app')\n")])])]),t("h3",{attrs:{id:"_2-android-app-build-gradle-添加"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_2-android-app-build-gradle-添加"}},[a._v("#")]),a._v(" 2. "),t("code",[a._v("android/app/build.gradle")]),a._v(" 添加")]),a._v(" "),t("div",{staticClass:"language- extra-class"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[a._v('apply from: "../../node_modules/react-native-code-push/android/codepush.gradle"\n')])])]),t("h3",{attrs:{id:"_3-mainapplication-java-添加"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_3-mainapplication-java-添加"}},[a._v("#")]),a._v(" 3. "),t("code",[a._v("MainApplication.java")]),a._v(" 添加")]),a._v(" "),t("div",{staticClass:"language-java extra-class"},[t("pre",{pre:!0,attrs:{class:"language-java"}},[t("code",[t("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("import")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token namespace"}},[a._v("com"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(".")]),a._v("microsoft"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(".")]),a._v("codepush"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(".")]),a._v("react")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(".")]),t("span",{pre:!0,attrs:{class:"token class-name"}},[a._v("CodePush")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(";")]),a._v("\n\n"),t("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("public")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("class")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token class-name"}},[a._v("MainApplication")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("extends")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token class-name"}},[a._v("Application")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("implements")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token class-name"}},[a._v("ReactApplication")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("{")]),a._v("\n  "),t("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("private")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("final")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token class-name"}},[a._v("ReactNativeHost")]),a._v(" mReactNativeHost "),t("span",{pre:!0,attrs:{class:"token operator"}},[a._v("=")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("new")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token class-name"}},[a._v("ReactNativeHost")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("(")]),t("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("this")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(")")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("{")]),a._v("\n      "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(".")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(".")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(".")]),a._v("\n\n      "),t("span",{pre:!0,attrs:{class:"token comment"}},[a._v("// 2. Override the getJSBundleFile method in order to let")]),a._v("\n      "),t("span",{pre:!0,attrs:{class:"token comment"}},[a._v("// the CodePush runtime determine where to get the JS")]),a._v("\n      "),t("span",{pre:!0,attrs:{class:"token comment"}},[a._v("// bundle location from on each app start")]),a._v("\n      "),t("span",{pre:!0,attrs:{class:"token annotation punctuation"}},[a._v("@Override")]),a._v("\n      "),t("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("protected")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token class-name"}},[a._v("String")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token function"}},[a._v("getJSBundleFile")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("(")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(")")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("{")]),a._v("\n          "),t("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("return")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token class-name"}},[a._v("CodePush")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(".")]),t("span",{pre:!0,attrs:{class:"token function"}},[a._v("getJSBundleFile")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("(")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(";")]),a._v("\n      "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("}")]),a._v("\n  "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("}")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(";")]),a._v("\n"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("}")]),a._v("\n")])])]),t("h3",{attrs:{id:"_4-strings-xml-添加"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_4-strings-xml-添加"}},[a._v("#")]),a._v(" 4. "),t("code",[a._v("strings.xml")]),a._v(" 添加")]),a._v(" "),t("div",{staticClass:"language-xml extra-class"},[t("pre",{pre:!0,attrs:{class:"language-xml"}},[t("code",[t("span",{pre:!0,attrs:{class:"token tag"}},[t("span",{pre:!0,attrs:{class:"token tag"}},[t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("<")]),a._v("resources")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(">")])]),a._v("\n    "),t("span",{pre:!0,attrs:{class:"token tag"}},[t("span",{pre:!0,attrs:{class:"token tag"}},[t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("<")]),a._v("string")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token attr-name"}},[a._v("name")]),t("span",{pre:!0,attrs:{class:"token attr-value"}},[t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("=")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v('"')]),a._v("app_name"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v('"')])]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(">")])]),a._v("gms"),t("span",{pre:!0,attrs:{class:"token tag"}},[t("span",{pre:!0,attrs:{class:"token tag"}},[t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("</")]),a._v("string")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(">")])]),a._v("\n    "),t("span",{pre:!0,attrs:{class:"token tag"}},[t("span",{pre:!0,attrs:{class:"token tag"}},[t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("<")]),a._v("string")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token attr-name"}},[a._v("moduleConfig")]),t("span",{pre:!0,attrs:{class:"token attr-value"}},[t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("=")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v('"')]),a._v("true"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v('"')])]),a._v(" "),t("span",{pre:!0,attrs:{class:"token attr-name"}},[a._v("name")]),t("span",{pre:!0,attrs:{class:"token attr-value"}},[t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("=")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v('"')]),a._v("CodePushDeploymentKey"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v('"')])]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(">")])]),a._v("you key"),t("span",{pre:!0,attrs:{class:"token tag"}},[t("span",{pre:!0,attrs:{class:"token tag"}},[t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("</")]),a._v("string")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(">")])]),a._v("\n    "),t("span",{pre:!0,attrs:{class:"token tag"}},[t("span",{pre:!0,attrs:{class:"token tag"}},[t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("<")]),a._v("string")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token attr-name"}},[a._v("moduleConfig")]),t("span",{pre:!0,attrs:{class:"token attr-value"}},[t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("=")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v('"')]),a._v("true"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v('"')])]),a._v(" "),t("span",{pre:!0,attrs:{class:"token attr-name"}},[a._v("translatable")]),t("span",{pre:!0,attrs:{class:"token attr-value"}},[t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("=")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v('"')]),a._v("false"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v('"')])]),a._v(" "),t("span",{pre:!0,attrs:{class:"token attr-name"}},[a._v("name")]),t("span",{pre:!0,attrs:{class:"token attr-value"}},[t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("=")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v('"')]),a._v("CodePushServerUrl"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v('"')])]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(">")])]),a._v("serverUrl"),t("span",{pre:!0,attrs:{class:"token tag"}},[t("span",{pre:!0,attrs:{class:"token tag"}},[t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("</")]),a._v("string")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(">")])]),a._v("\n"),t("span",{pre:!0,attrs:{class:"token tag"}},[t("span",{pre:!0,attrs:{class:"token tag"}},[t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("</")]),a._v("resources")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(">")])]),a._v("\n\n")])])]),t("h3",{attrs:{id:"_5-bulid-gradle"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_5-bulid-gradle"}},[a._v("#")]),a._v(" 5. "),t("code",[a._v("bulid.gradle")])]),a._v(" "),t("p",[a._v("配置 "),t("code",[a._v("defaultConfig")]),a._v(" 中的 "),t("code",[a._v("versionName")]),a._v(" 为 3 位数，例如 "),t("code",[a._v("versionName")]),a._v(' "1.0.0"')]),a._v(" "),t("h3",{attrs:{id:"_6-安装-react-native-code-push-6-1-1"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_6-安装-react-native-code-push-6-1-1"}},[a._v("#")]),a._v(" 6.安装 "),t("code",[a._v("react-native-code-push 6.1.1")])]),a._v(" "),t("div",{staticClass:"language-bash extra-class"},[t("pre",{pre:!0,attrs:{class:"language-bash"}},[t("code",[t("span",{pre:!0,attrs:{class:"token function"}},[a._v("yarn")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token function"}},[a._v("add")]),a._v(" react-native-code-push@6.1.1 -S\n")])])]),t("h3",{attrs:{id:"_7-更新命令"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_7-更新命令"}},[a._v("#")]),a._v(" 7.更新命令")]),a._v(" "),t("div",{staticClass:"language-bash extra-class"},[t("pre",{pre:!0,attrs:{class:"language-bash"}},[t("code",[a._v("code-push release-react CodePushDemoAndroid android --d Staging --t "),t("span",{pre:!0,attrs:{class:"token number"}},[a._v("1.0")]),a._v(".0 --des 测试环境更新 --m "),t("span",{pre:!0,attrs:{class:"token boolean"}},[a._v("true")]),a._v("\n")])])]),t("h2",{attrs:{id:"配置-ios-环境（link）"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#配置-ios-环境（link）"}},[a._v("#")]),a._v(" 配置 ios 环境（link）")]),a._v(" "),t("h3",{attrs:{id:"_1-运行-cd-ios-pod-install"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_1-运行-cd-ios-pod-install"}},[a._v("#")]),a._v(" 1. 运行 cd ios && pod install")]),a._v(" "),t("p",[t("code",[a._v("pod")]),a._v(" 如果失败, 就切换源，"),t("code",[a._v("profile")]),a._v(" 文件头部添加")]),a._v(" "),t("div",{staticClass:"language- extra-class"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[a._v("source 'https://mirrors.tuna.tsinghua.edu.cn/git/CocoaPods/Specs.git'\n")])])]),t("h3",{attrs:{id:"_2-appdelegate-m-添加-及替换"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_2-appdelegate-m-添加-及替换"}},[a._v("#")]),a._v(" 2. AppDelegate.m 添加,及替换")]),a._v(" "),t("div",{staticClass:"language- extra-class"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[a._v('#import <CodePush/CodePush.h>\n...\n...\n- (NSURL *)sourceURLForBridge:(RCTBridge *)bridge\n{\n  #if DEBUG\n    return [[RCTBundleURLProvider sharedSettings] jsBundleURLForBundleRoot:@"index" fallbackResource:nil];\n  #else\n    return [CodePush bundleURL];\n  #endif\n}\n')])])]),t("h3",{attrs:{id:"_3-xcode-project-info-configurations-点击-选泽-duplicate-“release-configaration-，-输入-staging。-这表示新建一种打包方式-名称是-staging。"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_3-xcode-project-info-configurations-点击-选泽-duplicate-“release-configaration-，-输入-staging。-这表示新建一种打包方式-名称是-staging。"}},[a._v("#")]),a._v(" 3.xcode -> PROJECT -> Info -> Configurations -> 点击+ -> 选泽 Duplicate “Release Configaration ， 输入 Staging。 这表示新建一种打包方式 名称是 Staging。")]),a._v(" "),t("h3",{attrs:{id:"_4-xcode-target-build-setting，点击-，add-user-defined-setting"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_4-xcode-target-build-setting，点击-，add-user-defined-setting"}},[a._v("#")]),a._v(" 4.xcode -> TARGET -> Build Setting，点击+，Add User-Defined Setting")]),a._v(" "),t("p",[a._v("然后输入 CODEPUSH_KEY，然后在下面的 release 中填写 product deployment key， 在 Staging 下填写 staging deploymeng key, debug 可以不用填写。")]),a._v(" "),t("p",[a._v("同理，新增 CODEPUSH_HOST， 填写各个环境的 code-push 服务器地址，如 Staging 我们可以填写 本机 iP://3000;（此处可能不执行，若失败可不添加）")]),a._v(" "),t("h3",{attrs:{id:"_5-ios-项目-info-plist-中新增"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_5-ios-项目-info-plist-中新增"}},[a._v("#")]),a._v(" 5.ios/<项目>/info.plist 中新增")]),a._v(" "),t("div",{staticClass:"language- extra-class"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[a._v("    <key>CodePushDeploymentKey</key>\n    <string>$(CODEPUSH_KEY)</string>\n    <key>CodePushServerURL</key>\n    <string>$(CODEPUSH_HOST)</string>\n    // 上一步的CODEPUSH_HOST若添加不成功，此处写死\n    // 修改为三位数版本号\n    <key>CFBundleShortVersionString</key>\n    <string>1.7.0</string>\n")])])]),t("h3",{attrs:{id:"更新命令模板"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#更新命令模板"}},[a._v("#")]),a._v(" 更新命令模板")]),a._v(" "),t("div",{staticClass:"language-bash extra-class"},[t("pre",{pre:!0,attrs:{class:"language-bash"}},[t("code",[a._v("code-push release-react CodePushDemoAndroid android --d Staging --t "),t("span",{pre:!0,attrs:{class:"token number"}},[a._v("1.0")]),a._v(".0 --des 测试环境更新1 --m "),t("span",{pre:!0,attrs:{class:"token boolean"}},[a._v("true")]),a._v("\n")])])]),t("div",{staticClass:"language-bash extra-class"},[t("pre",{pre:!0,attrs:{class:"language-bash"}},[t("code",[a._v("code-push release-react CodePushDemoIos ios --d Staging --t "),t("span",{pre:!0,attrs:{class:"token number"}},[a._v("1.0")]),a._v(".0 --des 测试环境更新1 --m "),t("span",{pre:!0,attrs:{class:"token boolean"}},[a._v("true")]),a._v("\n")])])])])}),[],!1,null,null,null);s.default=n.exports}}]);