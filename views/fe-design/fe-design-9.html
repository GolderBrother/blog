<!DOCTYPE html>
<html lang="zh-CN">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width,initial-scale=1" />
    <!-- 为了可以访问第三方图床的图片，才添加了这句代码，如果你的图片是存在本地的，去掉这句代码即可 -->
    <meta id="referrer" name="referrer" content="never" />
    <!-- <meta id="referrer" name="referrer" content="always" /> -->
    <title>前端应知应会的 9 种设计模式(详细篇) | 全栈修炼</title>
    <meta name="description" content="GolderBrother的博客" />
    <link rel="icon" href="/blog/assets/favicon.ico">  <link rel="preload" href="/blog/assets/css/0.styles.2dde6c16.css" as="style"><link rel="preload" href="/blog/assets/js/app.74817549.js" as="script"><link rel="preload" href="/blog/assets/js/2.f761193d.js" as="script"><link rel="preload" href="/blog/assets/js/4.bb581d32.js" as="script"><link rel="preload" href="/blog/assets/js/23.dbb39e0a.js" as="script"><link rel="prefetch" href="/blog/assets/js/10.ea66aff3.js"><link rel="prefetch" href="/blog/assets/js/100.1650309e.js"><link rel="prefetch" href="/blog/assets/js/101.dd5cdc51.js"><link rel="prefetch" href="/blog/assets/js/102.81a755d8.js"><link rel="prefetch" href="/blog/assets/js/103.84d1e041.js"><link rel="prefetch" href="/blog/assets/js/104.6bb79eda.js"><link rel="prefetch" href="/blog/assets/js/105.ac0fa491.js"><link rel="prefetch" href="/blog/assets/js/106.e7f21162.js"><link rel="prefetch" href="/blog/assets/js/107.a932b9dd.js"><link rel="prefetch" href="/blog/assets/js/108.08337848.js"><link rel="prefetch" href="/blog/assets/js/109.0a8ac1ac.js"><link rel="prefetch" href="/blog/assets/js/11.2b17f742.js"><link rel="prefetch" href="/blog/assets/js/110.63f713ce.js"><link rel="prefetch" href="/blog/assets/js/111.3ded28af.js"><link rel="prefetch" href="/blog/assets/js/112.feb77183.js"><link rel="prefetch" href="/blog/assets/js/113.ca7a3dfe.js"><link rel="prefetch" href="/blog/assets/js/114.278aaabb.js"><link rel="prefetch" href="/blog/assets/js/115.3f930fa5.js"><link rel="prefetch" href="/blog/assets/js/116.0686a02f.js"><link rel="prefetch" href="/blog/assets/js/117.22090497.js"><link rel="prefetch" href="/blog/assets/js/118.d7f089fa.js"><link rel="prefetch" href="/blog/assets/js/119.3c8db627.js"><link rel="prefetch" href="/blog/assets/js/12.d4feb8d0.js"><link rel="prefetch" href="/blog/assets/js/120.e516c49a.js"><link rel="prefetch" href="/blog/assets/js/121.d702cc4d.js"><link rel="prefetch" href="/blog/assets/js/122.13d4f773.js"><link rel="prefetch" href="/blog/assets/js/123.6905c46b.js"><link rel="prefetch" href="/blog/assets/js/124.ccac9465.js"><link rel="prefetch" href="/blog/assets/js/125.3fad187d.js"><link rel="prefetch" href="/blog/assets/js/126.065c2aad.js"><link rel="prefetch" href="/blog/assets/js/127.d4aef2ae.js"><link rel="prefetch" href="/blog/assets/js/128.00766f11.js"><link rel="prefetch" href="/blog/assets/js/129.51d245ca.js"><link rel="prefetch" href="/blog/assets/js/13.21c8139a.js"><link rel="prefetch" href="/blog/assets/js/130.82b8009d.js"><link rel="prefetch" href="/blog/assets/js/131.fb8da159.js"><link rel="prefetch" href="/blog/assets/js/132.2484fde1.js"><link rel="prefetch" href="/blog/assets/js/133.177fe1b1.js"><link rel="prefetch" href="/blog/assets/js/134.5611fa2b.js"><link rel="prefetch" href="/blog/assets/js/135.4d1053c3.js"><link rel="prefetch" href="/blog/assets/js/136.2973975f.js"><link rel="prefetch" href="/blog/assets/js/137.7c44ba09.js"><link rel="prefetch" href="/blog/assets/js/138.16973a68.js"><link rel="prefetch" href="/blog/assets/js/139.2f797054.js"><link rel="prefetch" href="/blog/assets/js/14.8cf70ab3.js"><link rel="prefetch" href="/blog/assets/js/140.f94ba770.js"><link rel="prefetch" href="/blog/assets/js/141.69f9800f.js"><link rel="prefetch" href="/blog/assets/js/142.b567c447.js"><link rel="prefetch" href="/blog/assets/js/143.f1ee0ada.js"><link rel="prefetch" href="/blog/assets/js/144.138163b4.js"><link rel="prefetch" href="/blog/assets/js/145.e3bee357.js"><link rel="prefetch" href="/blog/assets/js/146.3a9fd8c7.js"><link rel="prefetch" href="/blog/assets/js/147.0b8e88a6.js"><link rel="prefetch" href="/blog/assets/js/148.81da2cf3.js"><link rel="prefetch" href="/blog/assets/js/149.d44d0121.js"><link rel="prefetch" href="/blog/assets/js/15.ea38d450.js"><link rel="prefetch" href="/blog/assets/js/150.7665d423.js"><link rel="prefetch" href="/blog/assets/js/151.1ab5f781.js"><link rel="prefetch" href="/blog/assets/js/152.620db4ac.js"><link rel="prefetch" href="/blog/assets/js/153.695d756f.js"><link rel="prefetch" href="/blog/assets/js/154.ee82e0a2.js"><link rel="prefetch" href="/blog/assets/js/155.d7bc8987.js"><link rel="prefetch" href="/blog/assets/js/156.95cf0d01.js"><link rel="prefetch" href="/blog/assets/js/157.76159f7e.js"><link rel="prefetch" href="/blog/assets/js/158.e27d7f12.js"><link rel="prefetch" href="/blog/assets/js/159.84d58dcb.js"><link rel="prefetch" href="/blog/assets/js/16.7794197c.js"><link rel="prefetch" href="/blog/assets/js/160.44f17ac0.js"><link rel="prefetch" href="/blog/assets/js/161.a9fc1420.js"><link rel="prefetch" href="/blog/assets/js/162.953ffb8f.js"><link rel="prefetch" href="/blog/assets/js/163.d4b64d04.js"><link rel="prefetch" href="/blog/assets/js/164.d718bdc2.js"><link rel="prefetch" href="/blog/assets/js/165.464562ce.js"><link rel="prefetch" href="/blog/assets/js/166.3486924a.js"><link rel="prefetch" href="/blog/assets/js/167.044ce06a.js"><link rel="prefetch" href="/blog/assets/js/168.81e22c48.js"><link rel="prefetch" href="/blog/assets/js/169.4c4a576c.js"><link rel="prefetch" href="/blog/assets/js/17.7083b50c.js"><link rel="prefetch" href="/blog/assets/js/170.4b71dfab.js"><link rel="prefetch" href="/blog/assets/js/171.d2051e87.js"><link rel="prefetch" href="/blog/assets/js/172.eeb81923.js"><link rel="prefetch" href="/blog/assets/js/173.aafb24fa.js"><link rel="prefetch" href="/blog/assets/js/174.2e261a79.js"><link rel="prefetch" href="/blog/assets/js/175.aafd75a2.js"><link rel="prefetch" href="/blog/assets/js/176.b7681070.js"><link rel="prefetch" href="/blog/assets/js/177.e9bdb5f5.js"><link rel="prefetch" href="/blog/assets/js/178.4a3ca305.js"><link rel="prefetch" href="/blog/assets/js/179.40201a86.js"><link rel="prefetch" href="/blog/assets/js/18.3dbb7741.js"><link rel="prefetch" href="/blog/assets/js/180.68c6346e.js"><link rel="prefetch" href="/blog/assets/js/181.326c1f42.js"><link rel="prefetch" href="/blog/assets/js/182.92780c32.js"><link rel="prefetch" href="/blog/assets/js/183.65f40b5a.js"><link rel="prefetch" href="/blog/assets/js/19.78fd69da.js"><link rel="prefetch" href="/blog/assets/js/20.be39648e.js"><link rel="prefetch" href="/blog/assets/js/21.80a318b4.js"><link rel="prefetch" href="/blog/assets/js/22.4040efb3.js"><link rel="prefetch" href="/blog/assets/js/24.f27f8467.js"><link rel="prefetch" href="/blog/assets/js/25.448302be.js"><link rel="prefetch" href="/blog/assets/js/26.78106ffa.js"><link rel="prefetch" href="/blog/assets/js/27.2a65554d.js"><link rel="prefetch" href="/blog/assets/js/28.55501022.js"><link rel="prefetch" href="/blog/assets/js/29.af733838.js"><link rel="prefetch" href="/blog/assets/js/3.df759ff3.js"><link rel="prefetch" href="/blog/assets/js/30.8ce1d72b.js"><link rel="prefetch" href="/blog/assets/js/31.7925ec43.js"><link rel="prefetch" href="/blog/assets/js/32.f9892d98.js"><link rel="prefetch" href="/blog/assets/js/33.afd7fd02.js"><link rel="prefetch" href="/blog/assets/js/34.ee49fe13.js"><link rel="prefetch" href="/blog/assets/js/35.0e4f5335.js"><link rel="prefetch" href="/blog/assets/js/36.96311e99.js"><link rel="prefetch" href="/blog/assets/js/37.fb3163b1.js"><link rel="prefetch" href="/blog/assets/js/38.778ed95b.js"><link rel="prefetch" href="/blog/assets/js/39.0531a2e1.js"><link rel="prefetch" href="/blog/assets/js/40.ec9153c6.js"><link rel="prefetch" href="/blog/assets/js/41.2e9e71db.js"><link rel="prefetch" href="/blog/assets/js/42.af718b8a.js"><link rel="prefetch" href="/blog/assets/js/43.7a4efaa6.js"><link rel="prefetch" href="/blog/assets/js/44.21916db9.js"><link rel="prefetch" href="/blog/assets/js/45.c02e6427.js"><link rel="prefetch" href="/blog/assets/js/46.c95ab531.js"><link rel="prefetch" href="/blog/assets/js/47.d505fc9f.js"><link rel="prefetch" href="/blog/assets/js/48.9291572a.js"><link rel="prefetch" href="/blog/assets/js/49.79fd5fda.js"><link rel="prefetch" href="/blog/assets/js/5.cc289552.js"><link rel="prefetch" href="/blog/assets/js/50.40ff6888.js"><link rel="prefetch" href="/blog/assets/js/51.d16aa2b4.js"><link rel="prefetch" href="/blog/assets/js/52.4528f49d.js"><link rel="prefetch" href="/blog/assets/js/53.b16b42d4.js"><link rel="prefetch" href="/blog/assets/js/54.4fff7e01.js"><link rel="prefetch" href="/blog/assets/js/55.6832b1c5.js"><link rel="prefetch" href="/blog/assets/js/56.d16f1707.js"><link rel="prefetch" href="/blog/assets/js/57.de08e9ba.js"><link rel="prefetch" href="/blog/assets/js/58.6ca6f21b.js"><link rel="prefetch" href="/blog/assets/js/59.e518317a.js"><link rel="prefetch" href="/blog/assets/js/6.4efa9fa4.js"><link rel="prefetch" href="/blog/assets/js/60.935521f1.js"><link rel="prefetch" href="/blog/assets/js/61.ce9eda13.js"><link rel="prefetch" href="/blog/assets/js/62.e6c745bf.js"><link rel="prefetch" href="/blog/assets/js/63.647fd8d7.js"><link rel="prefetch" href="/blog/assets/js/64.4c9b4781.js"><link rel="prefetch" href="/blog/assets/js/65.80857907.js"><link rel="prefetch" href="/blog/assets/js/66.b89b796a.js"><link rel="prefetch" href="/blog/assets/js/67.b9798c32.js"><link rel="prefetch" href="/blog/assets/js/68.49b67f24.js"><link rel="prefetch" href="/blog/assets/js/69.665837ff.js"><link rel="prefetch" href="/blog/assets/js/7.b94332e9.js"><link rel="prefetch" href="/blog/assets/js/70.ce57ed8e.js"><link rel="prefetch" href="/blog/assets/js/71.71ae5067.js"><link rel="prefetch" href="/blog/assets/js/72.69c7c32d.js"><link rel="prefetch" href="/blog/assets/js/73.6b47b8f7.js"><link rel="prefetch" href="/blog/assets/js/74.bd6cd299.js"><link rel="prefetch" href="/blog/assets/js/75.297a83bc.js"><link rel="prefetch" href="/blog/assets/js/76.e49268ee.js"><link rel="prefetch" href="/blog/assets/js/77.6efa828f.js"><link rel="prefetch" href="/blog/assets/js/78.c38cb032.js"><link rel="prefetch" href="/blog/assets/js/79.478e1642.js"><link rel="prefetch" href="/blog/assets/js/8.80c6038b.js"><link rel="prefetch" href="/blog/assets/js/80.ff9e57e9.js"><link rel="prefetch" href="/blog/assets/js/81.e3dbf4d0.js"><link rel="prefetch" href="/blog/assets/js/82.270df640.js"><link rel="prefetch" href="/blog/assets/js/83.3bc7036f.js"><link rel="prefetch" href="/blog/assets/js/84.a3ccc99e.js"><link rel="prefetch" href="/blog/assets/js/85.7cdab723.js"><link rel="prefetch" href="/blog/assets/js/86.9f0c2ccd.js"><link rel="prefetch" href="/blog/assets/js/87.b7e93260.js"><link rel="prefetch" href="/blog/assets/js/88.557a99bb.js"><link rel="prefetch" href="/blog/assets/js/89.16a0d8d1.js"><link rel="prefetch" href="/blog/assets/js/9.4fbaf7a8.js"><link rel="prefetch" href="/blog/assets/js/90.52190781.js"><link rel="prefetch" href="/blog/assets/js/91.b9507740.js"><link rel="prefetch" href="/blog/assets/js/92.c0eb92c0.js"><link rel="prefetch" href="/blog/assets/js/93.ca3ba1d1.js"><link rel="prefetch" href="/blog/assets/js/94.a8ffcee7.js"><link rel="prefetch" href="/blog/assets/js/95.23fe688e.js"><link rel="prefetch" href="/blog/assets/js/96.b5d64bc6.js"><link rel="prefetch" href="/blog/assets/js/97.c41d4d64.js"><link rel="prefetch" href="/blog/assets/js/98.c415501d.js"><link rel="prefetch" href="/blog/assets/js/99.ab069b22.js"> <link rel="stylesheet" href="/blog/assets/css/0.styles.2dde6c16.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/blog/" class="home-link router-link-active"><img src="/blog/assets/logo.jpg" alt="全栈修炼" class="logo"> <span class="site-name can-hide">全栈修炼</span></a> <div class="links"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><a href="/blog/" class="nav-link">首页</a></div><div class="nav-item"><a href="/blog/guide/" class="nav-link">主页</a></div><div class="nav-item"><a href="/blog/views/" class="nav-link router-link-active">大前端</a></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="Select language" class="dropdown-title"><span class="title">Languages</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/blog/views/fe-design/fe-design-9.html" class="nav-link router-link-exact-active router-link-active">zh-CN</a></li><li class="dropdown-item"><!----> <a href="/blog/en/" class="nav-link">en-US</a></li></ul></div></div> <a href="https://github.com/GolderBrother/blog" target="_blank" rel="noopener noreferrer" class="repo-link">
    GitHub
    <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></nav></div></header> <div class="sidebar-mask"></div> <aside class="sidebar"><nav class="nav-links"><div class="nav-item"><a href="/blog/" class="nav-link">首页</a></div><div class="nav-item"><a href="/blog/guide/" class="nav-link">主页</a></div><div class="nav-item"><a href="/blog/views/" class="nav-link router-link-active">大前端</a></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="Select language" class="dropdown-title"><span class="title">Languages</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/blog/views/fe-design/fe-design-9.html" class="nav-link router-link-exact-active router-link-active">zh-CN</a></li><li class="dropdown-item"><!----> <a href="/blog/en/" class="nav-link">en-US</a></li></ul></div></div> <a href="https://github.com/GolderBrother/blog" target="_blank" rel="noopener noreferrer" class="repo-link">
    GitHub
    <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></nav>  <ul class="sidebar-links"><li><a href="/blog/views/" class="sidebar-link">大前端知识大集合</a></li><li><section class="sidebar-group depth-0"><p class="sidebar-heading"><span>GitHub 软技能</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/blog/views/github/follow.html" class="sidebar-link">GitHub 挖宝技巧</a></li><li><a href="/blog/views/github/star.html" class="sidebar-link">GitHub 吸星大法</a></li></ul></section></li><li><section class="sidebar-group depth-0"><p class="sidebar-heading"><span>浏览器工作原理</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/blog/views/browser/input-url-course.html" class="sidebar-link">导航流程：从输入 URL 到页面展示，这中间发生了什么</a></li><li><a href="/blog/views/browser/dom-bind-event.html" class="sidebar-link">一个DOM元素绑定多个事件时，先执行冒泡还是捕获</a></li></ul></section></li><li><section class="sidebar-group depth-0"><p class="sidebar-heading"><span>css</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/blog/views/css/css-skills1.html" class="sidebar-link">10 个让你受益匪浅的 css 使用技巧</a></li><li><a href="/blog/views/css/css-knowledge.html" class="sidebar-link">你未必知道的 49 个 CSS 知识点</a></li><li><a href="/blog/views/css/css-knowledge2.html" class="sidebar-link">你未必知道的 49 个 CSS 知识点二~</a></li><li><a href="/blog/views/css/css-center.html" class="sidebar-link">一起搞懂 CSS 水平居中与垂直居中的 16 个方法</a></li><li><a href="/blog/views/css/css-flex.html" class="sidebar-link">弹性盒子中 flex: 0 1 auto 表示什么意思</a></li><li><a href="/blog/views/css/css-BFC.html" class="sidebar-link">CSS 中的 BFC 详解</a></li></ul></section></li><li><section class="sidebar-group depth-0"><p class="sidebar-heading"><span>移动端h5</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/blog/views/h5/h5-demo1.html" class="sidebar-link">移动端 H5 和 Hybrid 相关基础技术概览</a></li><li><a href="/blog/views/mobile/mobile-skill.html" class="sidebar-link">总结移动端 H5 开发常用技巧</a></li><li><a href="/blog/views/mobile/mobile-optmization.html" class="sidebar-link">关于移动端体验优化经验总结</a></li></ul></section></li><li><section class="sidebar-group depth-0"><p class="sidebar-heading"><span>Javascript</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/blog/views/javascript/js-skills.html" class="sidebar-link">你可能不知道的 JS 开发技巧</a></li><li><a href="/blog/views/javascript/js-skills2.html" class="sidebar-link">一个合格的中级前端er需要掌握的 28 个 JavaScript 技巧</a></li><li><a href="/blog/views/javascript/js-utils.html" class="sidebar-link">书到用时方恨少，一大波 JS 开发工具函数来了</a></li><li><a href="/blog/views/javascript/js-utils2.html" class="sidebar-link">前端常用的 60 余种工具方法</a></li></ul></section></li><li><section class="sidebar-group depth-0"><p class="sidebar-heading"><span>Typescript</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/blog/views/typescript/ts-demo.html" class="sidebar-link">TypeScript 高级用法详解</a></li><li><a href="/blog/views/typescript/ts-difficult.html" class="sidebar-link">TypeScript 重难点梳理</a></li><li><a href="/blog/views/typescript/ts-problem.html" class="sidebar-link">TS 常见问题整理（60 多个）</a></li></ul></section></li><li><section class="sidebar-group depth-0"><p class="sidebar-heading"><span>Vue.js</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/blog/views/vue/vue-ts.html" class="sidebar-link">Vue + TS + El 搭建博客及踩坑记</a></li><li><a href="/blog/views/vue/vue-lazyload.html" class="sidebar-link">vue 路由懒加载及组件懒加载</a></li><li><a href="/blog/views/vue/vue-skills-36.html" class="sidebar-link">Vue 开发必须知道的 36 个技巧</a></li><li><a href="/blog/views/vue/vue-interview.html" class="sidebar-link">30 道 Vue 面试题，内含详细讲解（涵盖入门到精通，自测 Vue 掌握程度）</a></li><li><a href="/blog/views/vue/vue-interview/part-one/note.html" class="sidebar-link">Vue 面试题汇总</a></li></ul></section></li><li><section class="sidebar-group depth-0"><p class="sidebar-heading"><span>React.js</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/blog/views/react/react-hooks.html" class="sidebar-link">React Hooks 相关 API 总结</a></li><li><a href="/blog/views/react/react-lifecycle.html" class="sidebar-link">React v16.0 前的生命周期</a></li><li><a href="/blog/views/react/react-skill.html" class="sidebar-link">5 个技巧助你编写更好的 React 代码</a></li><li><a href="/blog/views/react/react-nice-library.html" class="sidebar-link">5 个很棒的 React.js 库，值得你亲手试试！</a></li><li><a href="/blog/views/react/react-interview.html" class="sidebar-link">35 道咱们必须要清楚的 React 面试题</a></li></ul></section></li><li><section class="sidebar-group depth-0"><p class="sidebar-heading"><span>React-Native</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/blog/views/react-native/RN&amp;Native-message.html" class="sidebar-link">React Native 跟原生之间的通信</a></li><li><a href="/blog/views/react-native/ReactNative&amp;Flutter&amp;uni-app.html" class="sidebar-link">一、技术学习成本和难度</a></li><li><a href="/blog/views/react-native/ReactNative&amp;Flutter&amp;uni-app.html" class="sidebar-link">一、技术学习成本和难度</a></li><li><a href="/blog/views/react-native/codepush-config.html" class="sidebar-link">RN 配置热更新+使用文档</a></li><li><a href="/blog/views/react-native/codepush-deploy.html" class="sidebar-link">React Native + 热更新(Code Push) 部署文档</a></li></ul></section></li><li><section class="sidebar-group depth-0"><p class="sidebar-heading"><span>webpack</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/blog/views/webpack/webpack1.html" class="sidebar-link">一大波 Webpack 面试题来啦~</a></li><li><a href="/blog/views/webpack/webpack-optimize.html" class="sidebar-link">webpack 优化篇</a></li></ul></section></li><li><section class="sidebar-group depth-0"><p class="sidebar-heading"><span>前端跨域相关</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/blog/views/cors/corssOrigin-pro.html" class="sidebar-link">10 种跨域解决方案（附终极方案）</a></li></ul></section></li><li><section class="sidebar-group depth-0"><p class="sidebar-heading"><span>vite</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/blog/views/vite/vite-study.html" class="sidebar-link">vite原理剖析</a></li></ul></section></li><li><section class="sidebar-group depth-0"><p class="sidebar-heading"><span>cli</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/blog/views/cli/james-cli.html" class="sidebar-link">手撸一个自己的前端脚手架</a></li></ul></section></li><li><section class="sidebar-group depth-0"><p class="sidebar-heading"><span>Node.js</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/blog/views/node/node1.html" class="sidebar-link">/views/node/node1.html</a></li></ul></section></li><li><section class="sidebar-group depth-0"><p class="sidebar-heading open"><span>前端设计模式之美</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/blog/views/fe-design/fe-design-9.html" class="active sidebar-link">前端应知应会的 9 种设计模式(详细篇)</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/blog/views/fe-design/fe-design-9.html#一、设计原则" class="sidebar-link">一、设计原则</a></li><li class="sidebar-sub-header"><a href="/blog/views/fe-design/fe-design-9.html#二、设计模式的类型和具体实现" class="sidebar-link">二、设计模式的类型和具体实现</a></li><li class="sidebar-sub-header"><a href="/blog/views/fe-design/fe-design-9.html#一-结构型模式（structural-patterns）" class="sidebar-link">一. 结构型模式（Structural Patterns）</a></li><li class="sidebar-sub-header"><a href="/blog/views/fe-design/fe-design-9.html#二-创建型模式（creational-patterns）" class="sidebar-link">二. 创建型模式（Creational Patterns）</a></li><li class="sidebar-sub-header"><a href="/blog/views/fe-design/fe-design-9.html#三-行为型模式（behavioral-patterns）" class="sidebar-link">三. 行为型模式（Behavioral Patterns）</a></li><li class="sidebar-sub-header"><a href="/blog/views/fe-design/fe-design-9.html#最后" class="sidebar-link">最后</a></li></ul></li></ul></section></li><li><section class="sidebar-group depth-0"><p class="sidebar-heading"><span>前端数据结构之美</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/blog/views/data-structure/data-structure.html" class="sidebar-link">前端数据结构之美</a></li></ul></section></li><li><section class="sidebar-group depth-0"><p class="sidebar-heading"><span>前端算法学习指南</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/blog/views/algorithms/sort.html" class="sidebar-link">十大经典算法</a></li><li><a href="/blog/views/algorithms/interview.html" class="sidebar-link">面试必刷-《剑指 offer》刷题小结</a></li><li><a href="/blog/views/algorithms/string.html" class="sidebar-link">字符串相关算法</a></li><li><a href="/blog/views/algorithms/array.html" class="sidebar-link">数组串相关算法</a></li><li><a href="/blog/views/algorithms/linklist.html" class="sidebar-link">链表相关算法题</a></li><li><a href="/blog/views/algorithms/tree.html" class="sidebar-link">二叉树相关算法</a></li><li><a href="/blog/views/algorithms/tencent/array&amp;string.html" class="sidebar-link">腾讯算法题-数组与字符串</a></li><li><a href="/blog/views/algorithms/tencent/number.html" class="sidebar-link">腾讯算法题-数学与数字</a></li></ul></section></li><li><section class="sidebar-group depth-0"><p class="sidebar-heading"><span>前端面试集锦</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/blog/views/fe-interview/alibaba.html" class="sidebar-link">阿里面试题</a></li><li><a href="/blog/views/fe-interview/bytedance.html" class="sidebar-link">字节跳动面试题</a></li><li><a href="/blog/views/fe-interview/bytedance-algorithms.html" class="sidebar-link">字节跳动算法题</a></li><li><a href="/blog/views/fe-interview/tencent.html" class="sidebar-link">微信面试题</a></li><li><a href="/blog/views/fe-interview/classic-layout.html" class="sidebar-link">掌握两大经典布局方案</a></li><li><a href="/blog/views/fe-interview/web-safe.html" class="sidebar-link">谈谈 web 安全问题及解决方案</a></li><li><a href="/blog/views/fe-interview/http&amp;https.html" class="sidebar-link">http2/http3 协议有什么优劣</a></li><li><a href="/blog/views/fe-interview/webpack-performance-optimization.html" class="sidebar-link">Webpack 性能优化你知道哪些</a></li><li><a href="/blog/views/fe-interview/webpack-principle.html" class="sidebar-link">说说 webpack 打包的原理</a></li><li><a href="/blog/views/fe-interview/webpack-HMR.html" class="sidebar-link">HMR 的原理是什么</a></li><li><a href="/blog/views/fe-interview/chrome-start-process.html" class="sidebar-link">Chrome 打开一个页面需要启动多少进程？分别有哪些进程</a></li><li><a href="/blog/views/fe-interview/dns-prefetch.html" class="sidebar-link">谈谈你对 dns-prefetch 的理解</a></li><li><a href="/blog/views/fe-interview/browser-cache.html" class="sidebar-link">浏览器缓存一探究竟~</a></li><li><a href="/blog/views/fe-interview/send-content-to-browser.html" class="sidebar-link">如何保证页面文件能被完整送达浏览器</a></li><li><a href="/blog/views/fe-interview/browser-render.html" class="sidebar-link">浏览器渲染过程是怎样的</a></li><li><a href="/blog/views/fe-interview/browser-reflow&amp;repain.html" class="sidebar-link">如何理解回流和重绘</a></li><li><a href="/blog/views/fe-interview/renderEngine-createNewLayer.html" class="sidebar-link">渲染引擎什么情况下才会为特定的节点创建新的图层</a></li><li><a href="/blog/views/fe-interview/UDP&amp;TCP-different.html" class="sidebar-link">UDP 和 TCP 有什么区别</a></li><li><a href="/blog/views/fe-interview/js-modules.html" class="sidebar-link">说说 js 的模块化</a></li><li><a href="/blog/views/fe-interview/lazyMan.html" class="sidebar-link">实现一个 LazyMan，可以按照以下方式调用</a></li><li><a href="/blog/views/fe-interview/handwriting-promise.html" class="sidebar-link">少年，来，手写一个 Promise 吧</a></li><li><a href="/blog/views/fe-interview/fetch&amp;ajax-diference.html" class="sidebar-link">请说下 fetch 和 ajax 的区别吧</a></li><li><a href="/blog/views/fe-interview/browser-input-url.html" class="sidebar-link">细说浏览器输入 URL 后发生了什么</a></li><li><a href="/blog/views/fe-interview/picture-optimization.html" class="sidebar-link">前端的图片优化方案你知道多少</a></li><li><a href="/blog/views/fe-interview/node-eventLoop.html" class="sidebar-link">来，说说 node 的事件循环机制吧</a></li><li><a href="/blog/views/fe-interview/browser-eventLoop.html" class="sidebar-link">小伙子，谈谈浏览器端的事件循环吧</a></li><li><a href="/blog/views/fe-interview/setTimeout&amp;setImmediate.html" class="sidebar-link">node中的setTimeout 和 setImmediate有什么区别</a></li><li><a href="/blog/views/fe-interview/js-interview.html" class="sidebar-link">收集一些 javascript 相关的面试题</a></li><li><a href="/blog/views/fe-interview/fuck-interview.html" class="sidebar-link">那些恶心的面试题</a></li></ul></section></li><li><section class="sidebar-group depth-0"><p class="sidebar-heading"><span>前端必知必会的网络基础</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/blog/views/network/http-interview.html" class="sidebar-link">HTTP 灵魂之问，巩固你的 HTTP 知识体系</a></li><li><a href="/blog/views/network/tcp-interview.html" class="sidebar-link">TCP 协议灵魂之问，巩固你的网络底层基础</a></li></ul></section></li><li><section class="sidebar-group depth-0"><p class="sidebar-heading"><span>前端应知应会的Nginx知识</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/blog/views/nginx/nginx-details.html" class="sidebar-link">Nginx 从入门到实践，万字详解！</a></li></ul></section></li><li><section class="sidebar-group depth-0"><p class="sidebar-heading"><span>前端必不可少的git知识</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/blog/views/git/git-command-animation.html" class="sidebar-link">相见恨晚的 Git 命令动画演示，一看就懂！</a></li></ul></section></li><li><section class="sidebar-group depth-0"><p class="sidebar-heading"><span>前端性能优化专题，让你的网站飞起来吧</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/blog/views/performance/code-split.html" class="sidebar-link">项目不知道如何做性能优化？不妨试试代码分割吧</a></li></ul></section></li><li><section class="sidebar-group depth-0"><p class="sidebar-heading"><span>前端高手进阶专题，告别小菜鸟</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/blog/views/fe-advanced/ad1.html" class="sidebar-link">你真的熟悉 HTML 标签吗？</a></li><li><a href="/blog/views/fe-advanced/ad2.html" class="sidebar-link">如何高效操作 DOM 元素？</a></li><li><a href="/blog/views/fe-advanced/ad3.html" class="sidebar-link">3 个使用场景助你用好 DOM 事件</a></li><li><a href="/blog/views/fe-advanced/ad6.html" class="sidebar-link">浏览器如何渲染页面？</a></li><li><a href="/blog/views/fe-advanced/ad7.html" class="sidebar-link">关于 JavaScript 的数据类型，你知多少</a></li></ul></section></li></ul> </aside> <main class="page"> <div class="theme-default-content content__default"><h1 id="前端应知应会的-9-种设计模式-详细篇"><a href="#前端应知应会的-9-种设计模式-详细篇" class="header-anchor">#</a> 前端应知应会的 9 种设计模式(详细篇)</h1> <h2 id="一、设计原则"><a href="#一、设计原则" class="header-anchor">#</a> 一、设计原则</h2> <h3 id="什么是设计模式？"><a href="#什么是设计模式？" class="header-anchor">#</a> 什么是设计模式？</h3> <p>设计模式是对软件设计开发过程中反复出现的某类问题的通用解决方案。设计模式更多的是指导思想和方法论，而不是现成的代码，当然每种设计模式都有每种语言中的具体实现方式。学习设计模式更多的是理解各种模式的内在思想和解决的问题，毕竟这是前人无数经验总结成的最佳实践，而代码实现则是对加深理解的辅助。</p> <ul><li>按哪一种思路或者标准来实现功能</li> <li>功能相同，可以有不同设计的方式</li> <li>需求如果不断变化，设计的作用才能体现出来</li></ul> <h3 id="solid-五大设计原则"><a href="#solid-五大设计原则" class="header-anchor">#</a> SOLID 五大设计原则</h3> <table><thead><tr><th>首字母</th> <th>指代</th> <th>概念</th></tr></thead> <tbody><tr><td>S</td> <td>单一职责原则</td> <td>单一功能原则认为对象应该仅具有一种单一功能的概念</td></tr> <tr><td>O</td> <td>开放封闭原则</td> <td>开闭原则认为软件体应该是对于扩展开放的，但是对于修改封闭的的概念</td></tr> <tr><td>L</td> <td>里氏替换原则</td> <td>里氏替换原则认为程序中的对象应该是可以在不改变程序正确性的前提下被它的子类所替换的的概念</td></tr> <tr><td>I</td> <td>接口隔离原则</td> <td>接口隔离原则认为多个特定客户端接口要好于一个宽泛用途的接口的概念</td></tr> <tr><td>D</td> <td>依赖反转原则</td> <td>依赖反转原则认为一个方法应该遵从依赖于抽象而不是一个实例的概念,依赖注入是该原则的一种实现方式。</td></tr></tbody></table> <h4 id="o-开放封闭原则"><a href="#o-开放封闭原则" class="header-anchor">#</a> O 开放封闭原则</h4> <p>Open Closed Principle</p> <ul><li>对扩展开放，对修改关闭</li> <li>增加需求时，扩展新代码，而非修改已有代码</li> <li>开闭原则是设计模式中的总原则</li> <li>对近期可能会变化并且如果有变化但改动量巨大的地方要增加扩展点,扩展点过多会降低可读性</li></ul> <div class="language-ts extra-class"><pre class="language-ts"><code><span class="token keyword">class</span> <span class="token class-name">Customer</span> <span class="token punctuation">{</span>
  <span class="token keyword">constructor</span><span class="token punctuation">(</span><span class="token parameter"><span class="token keyword">public</span> rank<span class="token operator">:</span> <span class="token builtin">string</span></span><span class="token punctuation">)</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>
<span class="token punctuation">}</span>
<span class="token keyword">class</span> <span class="token class-name">Product</span> <span class="token punctuation">{</span>
  <span class="token keyword">constructor</span><span class="token punctuation">(</span><span class="token parameter"><span class="token keyword">public</span> name<span class="token operator">:</span> <span class="token builtin">string</span><span class="token punctuation">,</span> <span class="token keyword">public</span> price<span class="token operator">:</span> <span class="token builtin">number</span></span><span class="token punctuation">)</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>
  <span class="token function">cost</span><span class="token punctuation">(</span><span class="token parameter">customer<span class="token operator">:</span> Customer</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">switch</span> <span class="token punctuation">(</span>customer<span class="token punctuation">.</span>rank<span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token keyword">case</span> <span class="token string">'member'</span><span class="token operator">:</span>
        <span class="token keyword">return</span> <span class="token keyword">this</span><span class="token punctuation">.</span>price <span class="token operator">*</span> <span class="token number">0.8</span><span class="token punctuation">;</span>
      <span class="token keyword">case</span> <span class="token string">'vip'</span><span class="token operator">:</span>
        <span class="token keyword">return</span> <span class="token keyword">this</span><span class="token punctuation">.</span>price <span class="token operator">*</span> <span class="token number">0.6</span><span class="token punctuation">;</span>
      <span class="token keyword">default</span><span class="token operator">:</span>
        <span class="token keyword">return</span> <span class="token keyword">this</span><span class="token punctuation">.</span>price<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
<span class="token keyword">let</span> p1 <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Product</span><span class="token punctuation">(</span><span class="token string">'笔记本电脑'</span><span class="token punctuation">,</span> <span class="token number">1000</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">let</span> member <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Customer</span><span class="token punctuation">(</span><span class="token string">'member'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">let</span> vip <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Customer</span><span class="token punctuation">(</span><span class="token string">'vip'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">let</span> guest <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Customer</span><span class="token punctuation">(</span><span class="token string">'guest'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token builtin">console</span><span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>p1<span class="token punctuation">.</span><span class="token function">cost</span><span class="token punctuation">(</span>member<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token builtin">console</span><span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>p1<span class="token punctuation">.</span><span class="token function">cost</span><span class="token punctuation">(</span>vip<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token builtin">console</span><span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>p1<span class="token punctuation">.</span><span class="token function">cost</span><span class="token punctuation">(</span>guest<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><p>现在我们来改下代码</p> <div class="language-ts extra-class"><pre class="language-ts"><code><span class="token keyword">class</span> <span class="token class-name">Customer</span> <span class="token punctuation">{</span>
  <span class="token keyword">constructor</span><span class="token punctuation">(</span><span class="token parameter"><span class="token keyword">public</span> rank<span class="token operator">:</span> <span class="token builtin">string</span><span class="token punctuation">,</span> <span class="token keyword">public</span> discount<span class="token operator">:</span> <span class="token builtin">number</span> <span class="token operator">=</span> <span class="token number">1</span></span><span class="token punctuation">)</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>
  <span class="token function">getDiscount</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> <span class="token keyword">this</span><span class="token punctuation">.</span>discount<span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
<span class="token keyword">class</span> <span class="token class-name">Product</span> <span class="token punctuation">{</span>
  <span class="token keyword">constructor</span><span class="token punctuation">(</span><span class="token parameter"><span class="token keyword">public</span> name<span class="token operator">:</span> <span class="token builtin">string</span><span class="token punctuation">,</span> <span class="token keyword">public</span> price<span class="token operator">:</span> <span class="token builtin">number</span></span><span class="token punctuation">)</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>
  <span class="token function">cost</span><span class="token punctuation">(</span><span class="token parameter">customer<span class="token operator">:</span> Customer</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token comment">/*  switch (customer.rank) {
         case 'member':
             return this.price * .8;
         case 'vip':
             return this.price * .6;
         default:
             return this.price;
     } */</span>
    <span class="token keyword">return</span> <span class="token keyword">this</span><span class="token punctuation">.</span>price <span class="token operator">*</span> customer<span class="token punctuation">.</span><span class="token function">getDiscount</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
<span class="token keyword">let</span> p1 <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Product</span><span class="token punctuation">(</span><span class="token string">'笔记本电脑'</span><span class="token punctuation">,</span> <span class="token number">1000</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">let</span> member <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Customer</span><span class="token punctuation">(</span><span class="token string">'member'</span><span class="token punctuation">,</span> <span class="token number">0.8</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">let</span> vip <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Customer</span><span class="token punctuation">(</span><span class="token string">'vip'</span><span class="token punctuation">,</span> <span class="token number">0.6</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">let</span> guest <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Customer</span><span class="token punctuation">(</span><span class="token string">'guest'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token builtin">console</span><span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>p1<span class="token punctuation">.</span><span class="token function">cost</span><span class="token punctuation">(</span>member<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token builtin">console</span><span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>p1<span class="token punctuation">.</span><span class="token function">cost</span><span class="token punctuation">(</span>vip<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token builtin">console</span><span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>p1<span class="token punctuation">.</span><span class="token function">cost</span><span class="token punctuation">(</span>guest<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><p>比如我们日常开发中使用过的基于<code>promise</code>的请求库<code>axios</code>, 也用到了设计模式</p> <div class="language-ts extra-class"><pre class="language-ts"><code><span class="token keyword">import</span> axios<span class="token punctuation">,</span> <span class="token punctuation">{</span> AxiosInstance<span class="token punctuation">,</span> AxiosRequestConfig <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'axios'</span><span class="token punctuation">;</span>
<span class="token keyword">let</span> instance<span class="token operator">:</span> AxiosInstance <span class="token operator">=</span> axios<span class="token punctuation">.</span><span class="token function">create</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
instance<span class="token punctuation">.</span>interceptors<span class="token punctuation">.</span>request<span class="token punctuation">.</span><span class="token function">use</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">config<span class="token operator">:</span> AxiosRequestConfig</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  config<span class="token punctuation">.</span>url <span class="token operator">=</span> <span class="token string">'http://localhost:8080'</span> <span class="token operator">+</span> config<span class="token punctuation">.</span>url<span class="token punctuation">;</span>
  <span class="token keyword">return</span> config<span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

instance<span class="token punctuation">.</span>interceptors<span class="token punctuation">.</span>response<span class="token punctuation">.</span><span class="token function">use</span><span class="token punctuation">(</span><span class="token parameter">response</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  <span class="token keyword">if</span> <span class="token punctuation">(</span>response<span class="token punctuation">.</span>status <span class="token operator">!==</span> <span class="token number">200</span> <span class="token operator">||</span> response<span class="token punctuation">.</span>data<span class="token punctuation">.</span>code <span class="token operator">!=</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> <span class="token builtin">Promise</span><span class="token punctuation">.</span><span class="token function">reject</span><span class="token punctuation">(</span>response<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> response<span class="token punctuation">.</span>data<span class="token punctuation">.</span>data<span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">/**
 * {code:0,data:{id:1,name:'golderbrother'}}
 */</span>
<span class="token function">instance</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
  url<span class="token operator">:</span> <span class="token string">'/api/users'</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span>
  <span class="token parameter">result</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    <span class="token builtin">console</span><span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>result<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token parameter">error</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    <span class="token builtin">console</span><span class="token punctuation">.</span><span class="token function">error</span><span class="token punctuation">(</span>error<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><h4 id="s-单一职责原则"><a href="#s-单一职责原则" class="header-anchor">#</a> S 单一职责原则</h4> <p>Single responsibility principle</p> <ul><li>一个类或者模块只负责完成一个职责，如果功能特别复杂就进行<strong>拆分</strong></li> <li>单一职责可以降低类的复杂性，提高代码可读性、可维护性</li> <li>当类代码行数过多、方法过多、功能太多、职责太杂的时候就要对类进行<strong>拆分</strong>了</li> <li><strong>拆分</strong>不能过度，如果<strong>拆分</strong>过度会损失<code>内聚性</code>和<code>维护性</code></li></ul> <p>可以参考下以下两个工具库源码</p> <ul><li><a href="https://www.lodashjs.com/docs/latest" target="_blank" rel="noopener noreferrer">lodashjs<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li> <li><a href="https://api.jquery.com/" target="_blank" rel="noopener noreferrer">jquery<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li></ul> <p><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAOMAAACxCAIAAAC5qp3nAAAACXBIWXMAABJ0AAASdAHeZh94AAAIhElEQVR42u2dMW7bShBAfYv4FrrAB/Ir6Qg2YMAufQLVQdy48xFSpU9vwPiNe7fu3boLYCCADWaRyZ8MZnZXpLxSSOq9IrAlcknFT8Pl7szyqAOYAkf8FwCmAmAqYCoApgJgKmAqAKYCYCpgKgCmAmAqzNLUb9++fQLYAUmtlqZeXFx8+PDhI0BTklRJrcambtEiQJ3tvMJUwFQATAVMxVTAVABMBUwFaGzq+fn5a463tzdM/c3V1dVRIL3Yqv3n5+fVarVYLB4fH5Gy5NXZ2dn3HC8vL5haMzVxeXlZ+W/av6npZC5/0eSsMHWqptogen9/L7KmH8Zjato9NYKpmHrlold68evXr+nX9K/8LFuKvrpNtregrie30s/WVGlEWlb/0gZJaPuK7i57yTkoTb5CmDpPU9frtQiULJEwWeotWNWUnqbGfWVHTMXU4tU/xjP1Q16JeskG0qC+Kxv3NFXeVentuclZcfXnjqp4+y+qqSIu4jrd47uun1oxVUN1NmRiKqZmTLUWiqkqLqZi6liu/o6dmir+YSqmtje1ST9V3lWt3a/0UzG1janvuffXASxhuVzW7/31C2B3tOEcUzG1aOp7xlPtYEJq4enpafWL+niqOyKmdmSoAKYCYCpgKqYCpgJgKmAq/7OAqYCpmAoHZepqtfoPoClJqvamHgHsAK7+QD8VAFMBUzEVMBUAUwFTMRUwFWCcpsriTfYVKY67vb3VGiBbXekK3LR6OO6VWrZ1drbO2DYyy9JNTN2fqVq5Jr9KwZr9uftVJec2s+vtyDJ3uiSOGim1ddLIjNdtxNQ9meoWccgWglYklqipcVSqPaO1cUvA1D+4emJX/y7OWXVKpko71lTdK/m3XC61nlijb/waxFcAUwfE1JKpcSGGLUytryoFmPpeU0VTtapJTAVMbW9q2jiuHTLI1EpfAjD1YtBJVEx1N/vr9fr09FTe6m+q3Pvbmy2eUoKpjU3tzNqlElx1TV1ZramPqV15ISfAVABMBUzFVMBUAEwFTMVUwFSA+ZrqEqMAU4mpgKkA4zc1ZqjIVKetM7Epf8vlUtKi5aJvr/4u7dXOx9oHM5NIhaktTdXp+JgwdXJyohaqqaKpNuWSp7KtAaY2MNU9MNeWA9jt1VSXkqLEhFSXOgiYWjS1Xp0SC5vUrWyalexV8i8m9ZHmh6ktY6rV0WXsDzU1fiUwFVN3YmrbmAqYuqt+qupYMbXeT6VIGlO75uOpG+/9s6a6NSZsCUraxoZbprUwtaWp2fHUiqld7/FUNMXUlqZyvQZMBUzFVDgcUwEwFTAVUwFTATAVMBVTAVMBU9ubenx8/C9AU5JU7U1dLBafAJqSpOLqD/RTATAVMBVTAVMBMLXt03ziE9tsMcKoTrX7vzjiy5cvdrUOTJ22qff39302i1mzYkOTWpd3muo+Qnyg3PzWjDlEU3tuls3vblWi/U5T3e72ccbxV0zd0tQ+9f7uaZTZYkB3gZZmS09blcZthaB7+rp95FXFVPuiHE5KC2P7buW20qlWPnuXK2mMH8EGVBv7ZxZWp2FqpcBamxJj7OP/9E9lA6Fbd00atE9pU1k3xtTU/nK5XK/XtlBW+wY9T7Xy2UtLxGU/gjvP+RWOT8PU7OJq7kIc11rLxhj3Z3YLsdgtN/ZT02buMYJupQzVpXKq9c+eXXojGhyv9fPrAIx0BbXKxVHdcpK5v188ejQ17mJf2Xjvr9+ZrPQ9T7Xy2UvLGdW/bG3708TUYTE1u7ha/AtV+qnaa4ymxu9P6dDxg9RN7XOqTUyNF3pM3Yep9ZDTP1Bpn6F/TN147z/I1C1iqn2LmDp2U2M3Lru4WqXz5/54tpE+AWk7U7PRcWg/1b1FP3Vc46nRHncJHnrvb81Im6Xb89PTU3uD7zoJ+k2w3gw1NXvvL7tXTrXy2etLxHHv/3dG/uvDjVuMp6Yf7BCpGKARzg6y2vFUuwzbUFO76opuPYd+3VulBu1HYDx1FHNULATUB+aoMHUaMO+PqZOBXKq/bCoApgKmYipgKmAq1SmZm7n+1SlNbv70zp3nvWDqKKpTspTyE6CjOmWQqd2OMz/ciH1p3h9TqU55V3WK294+vtWG4dLh4qQoYXV6pk6iOsVuXzri0MPxvPeJmTqV6hQXbrOfvXS47GQ9HYB9m3oI1Sl6qqWZ9/rhsuGTyeSJxdRJVKf0NLV0uGxON6aO2tSJVqdsEVM3dkkxddSmzqA6pdJPLR2OfuoExlPnUZ3i7v3d0Jjtkfc/HPf+oxv5n0F1yhbjqfZwjKdOw9S6wQfSUWOOClOnAfP+mDoZyKWaqqkAmAqYiqmAqRV2kfMfO4v770HKEe/u7ma2KBqmbmBQzr9btGf/ptpR20OeCCDnv2aqpJ/GPJi9mSpDAZXZAUwl5/+3qQ8PD04OZ6pOhrm5KImF6czjVJnb0jXi0nHclgcbVsn5ryXhyxSRS4WxplpvKtkLcj4nJycxR1v20kZiwsDG/ytMJef/z2SmyygoXf1ta65lu5e9iFfWB3aX/gPvAJDzX8v5V1NdRl+fzD134Y6ropZS/fWVbPg82FlWcv5rOf82QUQFrfRTbU+3v6nxBNTUmKGCqeT85+/9Xe9CRrhUQduvbRVT611STCXnf4Op2uzNzY3tR7pzG2pqJbWPfuroxlNHm/PvHNLegigYTzv9bFcD6GOqe+zExpDPvT85/5mc/xjtZF/3gBQ9AW0qbdbT1NjZrRRqM55KfupIYY4KUycD8/6YOhnIperITwVMBcBUwFRMBUwFwFTAVEwFTAXAVMBUTAVMBcBUwFTX4mKx+ATQlCRVY1Ovr68/lvkHYFs+f/7c0tQKr6+v3wFag6mAqQCYCpiKqYCpAJgKmDqMt7e3F4DW/Pjxo7GpAHsGUwFTATAVDo2ftZ9cKknODicAAAAASUVORK5CYII=" alt="product"></p> <h4 id="l-里氏替换原则"><a href="#l-里氏替换原则" class="header-anchor">#</a> L 里氏替换原则</h4> <p>Liskov Substitution Principle</p> <ul><li>所有引用基类的地方必须能透明地使用其子类的对象</li> <li>子类能替换掉父类，使用者可能根本就不需要知道是父类还是子类，反之则不行</li> <li><code>里氏替换原则</code>是开闭原则的实现基础，程序设计的时候尽量使用<strong>基类定义及引用</strong>，运行时再决定使用哪个子类</li> <li><code>里氏替换原则</code>可以提高代码的复用性，提高代码的可扩展性，也增加了耦合性</li> <li>相对于多态，这个原则是讲的是类如何设计，子类如果违反了父类的功能则表示违反了<code>里氏替换原则</code></li></ul> <p><img src="data:image/png;base64,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" alt="Substitution"></p> <div class="language-ts extra-class"><pre class="language-ts"><code><span class="token keyword">abstract</span> <span class="token keyword">class</span> <span class="token class-name">AbstractDrink</span> <span class="token punctuation">{</span>
  <span class="token keyword">abstract</span> <span class="token function">getName</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">:</span> <span class="token builtin">string</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token keyword">class</span> <span class="token class-name">CocaCola</span> <span class="token keyword">extends</span> <span class="token class-name">AbstractDrink</span> <span class="token punctuation">{</span>
  <span class="token function">getName</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">:</span> <span class="token builtin">string</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> <span class="token string">'可乐'</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
<span class="token keyword">class</span> <span class="token class-name">Sprite</span> <span class="token keyword">extends</span> <span class="token class-name">AbstractDrink</span> <span class="token punctuation">{</span>
  <span class="token function">getName</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">:</span> <span class="token builtin">string</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> <span class="token string">'雪碧'</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
<span class="token keyword">class</span> <span class="token class-name">Fanta</span> <span class="token keyword">extends</span> <span class="token class-name">AbstractDrink</span> <span class="token punctuation">{</span>
  <span class="token function">getName</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">:</span> <span class="token builtin">string</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> <span class="token string">'芬达'</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
<span class="token keyword">class</span> <span class="token class-name">Customer</span> <span class="token punctuation">{</span>
  <span class="token function">drink</span><span class="token punctuation">(</span><span class="token parameter">drink<span class="token operator">:</span> AbstractDrink</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token builtin">console</span><span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'喝'</span> <span class="token operator">+</span> drink<span class="token punctuation">.</span><span class="token function">getName</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
<span class="token keyword">let</span> customer <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Customer</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">let</span> cocaCola <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">CocaCola</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">let</span> sprite <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Sprite</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">let</span> fanta <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Fanta</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
customer<span class="token punctuation">.</span><span class="token function">drink</span><span class="token punctuation">(</span>cocaCola<span class="token punctuation">)</span><span class="token punctuation">;</span>
customer<span class="token punctuation">.</span><span class="token function">drink</span><span class="token punctuation">(</span>sprite<span class="token punctuation">)</span><span class="token punctuation">;</span>
customer<span class="token punctuation">.</span><span class="token function">drink</span><span class="token punctuation">(</span>fanta<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">import</span> React <span class="token keyword">from</span> <span class="token string">'react'</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> ReactDOM <span class="token keyword">from</span> <span class="token string">'react-dom'</span><span class="token punctuation">;</span>
<span class="token keyword">class</span> <span class="token class-name">App</span> <span class="token keyword">extends</span> <span class="token class-name">React<span class="token punctuation">.</span>Component</span> <span class="token punctuation">{</span>
  <span class="token function">render</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> <span class="token operator">&lt;</span>div<span class="token operator">&gt;</span>App <span class="token operator">&lt;</span><span class="token operator">/</span>div<span class="token operator">&gt;</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
<span class="token keyword">let</span> element <span class="token operator">=</span> React<span class="token punctuation">.</span><span class="token function">createElement</span><span class="token punctuation">(</span>App<span class="token punctuation">)</span><span class="token punctuation">;</span>
ReactDOM<span class="token punctuation">.</span><span class="token function">render</span><span class="token punctuation">(</span>element<span class="token punctuation">,</span> document<span class="token punctuation">.</span><span class="token function">getElementById</span><span class="token punctuation">(</span><span class="token string">'root'</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><div class="language-ts extra-class"><pre class="language-ts"><code><span class="token keyword">abstract</span> <span class="token keyword">class</span> <span class="token class-name">AbstractDrink</span> <span class="token punctuation">{</span>
  <span class="token keyword">abstract</span> <span class="token function">getName</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">:</span> <span class="token builtin">any</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token keyword">class</span> <span class="token class-name">CocaCola</span> <span class="token keyword">extends</span> <span class="token class-name">AbstractDrink</span> <span class="token punctuation">{</span>
  <span class="token function">getName</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">:</span> <span class="token builtin">any</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> <span class="token number">100</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><h4 id="d-依赖倒置原则"><a href="#d-依赖倒置原则" class="header-anchor">#</a> D 依赖倒置原则</h4> <p>Dependence Inversion Principle</p> <ul><li>面向<strong>接口</strong>编程，依赖于抽象而不依赖于具体实现</li> <li>要求我们在程序代码中传递参数时或在关联关系中，尽量引用层次高的抽象层类</li> <li>使用方只关注<strong>接口</strong>而不关注具体类的实现</li></ul> <p><img src="data:image/png;base64,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" alt="Inversion"></p> <p>比如 <code>SingleDog</code> 自己 <code>new</code> 个 <code>GirlFriend</code></p> <div class="language-ts extra-class"><pre class="language-ts"><code><span class="token keyword">abstract</span> <span class="token keyword">class</span> <span class="token class-name">GirlFriend</span> <span class="token punctuation">{</span>
  <span class="token keyword">public</span> age<span class="token operator">:</span> <span class="token builtin">number</span><span class="token punctuation">;</span>
  <span class="token keyword">public</span> height<span class="token operator">:</span> <span class="token builtin">number</span><span class="token punctuation">;</span>
  <span class="token keyword">public</span> <span class="token keyword">abstract</span> <span class="token function">cook</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">:</span> <span class="token keyword">void</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token keyword">class</span> <span class="token class-name">LinZhiLing</span> <span class="token keyword">extends</span> <span class="token class-name">GirlFriend</span> <span class="token punctuation">{</span>
  <span class="token keyword">public</span> <span class="token function">cook</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">:</span> <span class="token keyword">void</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>
<span class="token punctuation">}</span>
<span class="token keyword">class</span> <span class="token class-name">HanMeiMei</span> <span class="token keyword">extends</span> <span class="token class-name">GirlFriend</span> <span class="token punctuation">{</span>
  <span class="token keyword">public</span> <span class="token function">cook</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">:</span> <span class="token keyword">void</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>
<span class="token punctuation">}</span>
<span class="token keyword">class</span> <span class="token class-name">SingleDog</span> <span class="token punctuation">{</span>
  <span class="token keyword">constructor</span><span class="token punctuation">(</span><span class="token parameter"><span class="token keyword">public</span> girlFriend<span class="token operator">:</span> GirlFriend</span><span class="token punctuation">)</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>
<span class="token punctuation">}</span>
<span class="token keyword">let</span> s1 <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">SingleDog</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">LinZhiLing</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">let</span> s2 <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">SingleDog</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">HanMeiMei</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><div class="language-ts extra-class"><pre class="language-ts"><code><span class="token keyword">import</span> <span class="token punctuation">{</span> createStore <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'redux'</span><span class="token punctuation">;</span>
<span class="token keyword">let</span> store <span class="token operator">=</span> <span class="token function">createStore</span><span class="token punctuation">(</span><span class="token parameter">state</span> <span class="token operator">=&gt;</span> state<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">export</span> <span class="token keyword">interface</span> <span class="token class-name">Action</span><span class="token operator">&lt;</span><span class="token constant">T</span> <span class="token operator">=</span> <span class="token builtin">any</span><span class="token operator">&gt;</span> <span class="token punctuation">{</span>
  <span class="token keyword">type</span><span class="token operator">:</span> <span class="token constant">T</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token keyword">export</span> <span class="token keyword">interface</span> <span class="token class-name">AnyAction</span> <span class="token keyword">extends</span> <span class="token class-name">Action</span> <span class="token punctuation">{</span>
  <span class="token comment">// Allows any extra properties to be defined in an action.</span>
  <span class="token punctuation">[</span>extraProps<span class="token operator">:</span> <span class="token builtin">string</span><span class="token punctuation">]</span><span class="token operator">:</span> <span class="token builtin">any</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token keyword">let</span> action<span class="token operator">:</span> AnyAction <span class="token operator">=</span> <span class="token punctuation">{</span> <span class="token keyword">type</span><span class="token operator">:</span> <span class="token string">'increment'</span><span class="token punctuation">,</span> payload<span class="token operator">:</span> <span class="token number">5</span> <span class="token punctuation">}</span><span class="token punctuation">;</span>
store<span class="token punctuation">.</span><span class="token function">dispatch</span><span class="token punctuation">(</span>action<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><h4 id="i-接口隔离原则"><a href="#i-接口隔离原则" class="header-anchor">#</a> I 接口隔离原则</h4> <p>Interface Segregation Principle</p> <ul><li>保持接口的单一独立，避免出现胖接口</li> <li>客户端不应该依赖它不需要的接口，类间的依赖关系应该建立在最小的接口上</li> <li>接口尽量细化，而且接口中的方法尽量的少</li> <li>类似于单一职责原则，更关注接口</li></ul> <div class="language-ts extra-class"><pre class="language-ts"><code><span class="token keyword">interface</span> <span class="token class-name">IUserManager</span> <span class="token punctuation">{</span>
  <span class="token function">updateUserInfo</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">:</span> <span class="token keyword">void</span><span class="token punctuation">;</span>
  <span class="token function">updatePassword</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">:</span> <span class="token keyword">void</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token keyword">interface</span> <span class="token class-name">IProductManager</span> <span class="token punctuation">{</span>
  <span class="token function">updateProduct</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">:</span> <span class="token keyword">void</span><span class="token punctuation">;</span>
  <span class="token function">updatePrice</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">:</span> <span class="token keyword">void</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre></div><p>比如如果想让飞机(<code>Flying</code>)在水里(<code>Swimming</code>)运行(<code>Running</code>)，怎么实现？</p> <p><img src="/blog/assets/img/play.d9862e43.jpg" alt="play"></p> <p>遵循<strong>接口隔离</strong>原则，我们可以这样做</p> <p>伪代码如下：</p> <div class="language-ts extra-class"><pre class="language-ts"><code><span class="token keyword">interface</span> <span class="token class-name">Running</span> <span class="token punctuation">{</span>
  <span class="token function">run</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">:</span> <span class="token keyword">void</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token keyword">interface</span> <span class="token class-name">Flying</span> <span class="token punctuation">{</span>
  <span class="token function">fly</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">:</span> <span class="token keyword">void</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token keyword">interface</span> <span class="token class-name">Swimming</span> <span class="token punctuation">{</span>
  <span class="token function">swim</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">:</span> <span class="token keyword">void</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token keyword">class</span> <span class="token class-name">Automobile</span> <span class="token keyword">implements</span> <span class="token class-name">Running</span><span class="token punctuation">,</span> Flying<span class="token punctuation">,</span> Swimming <span class="token punctuation">{</span>
  <span class="token function">run</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>
  <span class="token function">fly</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>
  <span class="token function">swim</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><h3 id="其他原则"><a href="#其他原则" class="header-anchor">#</a> 其他原则</h3> <h4 id="迪米特法则"><a href="#迪米特法则" class="header-anchor">#</a> 迪米特法则</h4> <p>Law of Demeter，LOD</p> <ul><li>有时候也叫做<strong>最少知识</strong>原则</li> <li>一个软件实体应当尽可能少地与其它实体发生相互作用</li> <li>迪米特法则的初衷在于<strong>降低类之间的耦合</strong></li> <li>类定义时尽量要实现<strong>内聚</strong>，少使用 <code>public</code> 修饰符，尽量使用 <code>private</code>、<code>protected</code> 等</li></ul> <p>比如我们看下产品销售关联职位关系的流程</p> <p><img src="data:image/png;base64,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TE1NzQJDQ/ifZAJgpU2wYcOGrcDQsGXLFiYAtA5B6xATAEwAJmACgAnABEwAMAGYgAkAJgATMAGwZkzQPRV728ZnOOEJmABggpE0QT6poRljmIAJgHE0QTEZbzGzMZiACYBVMEFspanjdeOM9vlk6/lU9YUJ8gnQ87hfz3KuWsAETAAMowmKcnrYIEbzItznk8Lnq6It0jHDhySDxilw0/HdYCZgAmBYTFA04LSRR//8cxHZ81WNR9ZAxARMAKyCCYoJyot53mPJPW8UaiRv6knhvm7tyZc0Fv8bKwpgAgCrWScoVNHRTxBoNEHtmGSCetgoEzABEwDDaIKc1NAfQ3bqJ+hZJyjOpU4AJgBGzwQpUhdxPBdD0U/Q9ryYfgIwATCMJhhYck9fi8FCMzMz09PT0SL12KFUdciL/MYOgQmA0TBBjM6NzxOEuJ8/JRA3CzWAubm5tucJ8scOPE8AJgBGxgTLh2eMwQTAuJvAe4fABMC4m+C0d5EyARMATAAmYAKACcAETAAwAZiACQAmABMwAcAEYAImAJgATMAEwMqYYAIYPpgAWDkT3H333UdbOHLkyG3ozYF55MOScPvttzMBsHIm6ODUqVP3oTeXzCMflhsmAJiACZiACQAmYAImAMAETMAEAJiACZgAABMwARMAYAImYAIAy26C8JM7hd7Ep7Xlw3Ljdw6sqAmwIPbMIx8AMAETAAATMAEAMAETAAATMAEAMAETAAATMAEAMAETAAATMAEAMAETAAATMAEAMAETAAATMAEAMAETAAATMAEAMAETAAATMAEAMAETAAATMAEAMAETAAATMAEAMAETAAATMAEAMAETAAATMAEAMAETAAATMAEAMAETAAATMAEAMAETAAATMAEAMAETAAATMAEAMAETAAATMAEAMAETAAATMAEAMAETAAATMAEAMAETAAATMAEAMAETAAATMAEAMAETAAATMAEAMAETAAATMAEAMAETAAATMAEAMAETAAATMAEAMAETAAATMAEAMAETAAATMAEAMAETAAATMAEAMAETAAATMAEAMMEqsXueNhMUawGACdYg119//VlnnXXy5MnaBGFhWBU2kEsAmGCNc+655+7fv782QVgYVskfAEyw9pmdnd20aVNtgqCBsEr+AGCCtc+JEycmJiaOHj2amyB8DQvDKvkDgAnGgh07dsSe4WSC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HvSgB42eCXoW6/Lff/65KLHmq4rWj2LLvfM0BtO0ZV0GL0r33Q0yKfoXx4lf8+NEabVJpe3ai9wr3mrSaKa2CTc6xNDm5nxVR52jzvaUvFyW/S85v3fFidouP5mgoxIwkEOHDsWAFRSyZ8+ebn9A65DWod3dMahogigmdWsjjxopNNSROl9SOKYI4ikk1c3laUkdqvqboNgyT0x92G4dFtvnwTTFxJDamZmZPgkbOPVrkZ4UyjsyqmNi8TrbCyM29lrXtzs/cqMJ8rXFdQUThPD90Ic+NKTwoosuOpMgHuQRFPKc5zwnHOpRj3rUS17ykne9610f/vCHP/rRj3784x//xCc+sX///k996lOf/vSnP/vZzx44cOBzn/vcF77whZCAL33pSyFVX/3qV2+88cavfe1r3/jGN0L14pZbbvnWt751++23Hz58+Dvf+c4dd9zx3e9+93vf+973v//9H/7whz/60Y9+8pOfhNT+7Gc/+8UvfvHLX/4yZPWvf/3r3/72tydOnPj973//xz/+8U9/+tNf/vKXv/71r/fee+/f//73f/zjH//85z8X8WtnAiZY/X6CPDZ19BOkyFWYoG3Ouf4mqI9whiZoe1lu3srUbYK2a6/jbwqR3XWCxnCfx+62WZlyE7RlVH2Eop+gjwm6b/dAE3TXCc4+++y3ve1twQdhgze84Q2LHhoUQvAnP/nJ888/PxznkY985OMe97inPvWpz3rWs57xjGc87WlPe8pTnhIuIax98pOfvHnz5ic84QmPf/zjzzvvvHPOOecxj3nMxo0bJycn169fH3YMKXnEIx7xsIc97CEPeciKNRo8+MEPDmd8+MMfHs4e0vDoRz86pCekKmROSOGmTZvC5YQ0P/GJT3zSk54UruKCCy7YsmVLuK6nP/3pz3zmM5/97GdfeOGFz3ve857//Oe/8IUvDLXAF7/4xS996Utf8YpX7Nix41WvetXFF1/82te+dnp6+vWvf33I5BAK3vSmN4WQFHL+8ssvv/LKK9/+9rdfffXV73znO9/97ne/973vfd/73veBD3wgmJUJmKChQJcaHFIzdP86QUe7U/86QVthvL8JGsv4KX4NNEHHtedf22oSdT/BwEanvH+lf52g4y7n/QR9TDDwdreZYKH9BLfddtvLXvay1A/cvyoQNg67hB3PPffcq666arlbh8Iv9l//+ldIcCjp/+1vfwul/lD2//Of/xzqAX/4wx9+97vfhZrBb37zm1/96lehrnDXXXf9/Oc/D0n66U9/+uMf/zjUJ37wgx+EHAs1jOC8I0eOhDrHt7/97VD/CLWQb37zm6FG8vWvf/2mm24KdZSvfOUrX/7yl8PVffGLX/z85z8f6jHXXXfdZz7zmVCzCc7bt29fqOt87GMf+8hHPvKhD30oZPvs7OwHP/jB97///ddcc8173vOeENPf8Y53hAwJUf6KK6647LLLQtx/85vf/MY3vjGEgksuueR1r3tdcEOITa9+9auDLV75yle+/OUvD3WpcL9e9KIXveAFLwj7MgETNDSvx17Eon257p9M/QRtobmnCepAc+YmaCy0pvQMNEHHtefJmJmZ6cjMPM42ji9KWd3YEN/WT9DdwVA7pqcJBt7uRhMseuxQCJ0hbK1bty6UjjuGikYB7Ny5c8UEoJ8AY2GCRjc0BsFi9EiIeqFkUffxFlEyH47S0wR1iTit6jZB29ihtohZVGU6TNBx7UVDSp+4fPp/59vLE5NfZl7KzscIFWOHGjOqqC4UY4f6mGDg7e7fT9DHBJG5ublQ/g0hPo4LSk1GuQDi+CIPmjEBEyz7Hc2HqDe2OxdTkoYfcNvzBMW8Pz1NUKShY3BLHxN0PIoVT3rvvfcO7Cdou/Y8YQua0qjuU2lUS2ydz3uAO54nqIc/nUk/QfftXg4TpGeMQ6BPT5Pt2bMnDTA9dOiQsMIETOCODikd4y+xCBNETpw4MTs7SwBMwARMMBqsgTdADKEJwARMwAQj44DucTJgAiZgAiYAmIAJmIAJACYYNRNs2LBhK5aIyclJJgCYYPRMMDU1NYsl4vzzz2cCgAm0DmkdYgKACZiACZgAYAImYAImAJiACZhg9Uyg5wfDxs6dOzdu3MgETMAEK2cCo8EwbGzevHlycpIJxtwEjVO9Dty4bZ5wJuB2aB3CWjZB/l6v7klQmIAJwARYmyaoZ45qm6abCZgATIAVMkHjDFf5i9A7Zr1N7zMvTJC/zT6P+/WLfkeuWsAEABOMhQmKcnoxs1496ffpphmu8rkxkgwa5x0Zrbf/MgHABGNhgp4Tl+bRv5hUNd89X9V45NFqIBoXE4zPGAAwwdiaoJ5lL58pL5bc80ahRvKmnmL62FwtHVNq5y1OPSeLZQJjAMAEWIk6QaGKjn6COCFrbYLaMckEdZGRCUbbBKM+BgBMwARtJshJDf0xZKfg0LNOUJxLnWDZTWAMAJgAS26CFKmLOJ6LoegnaGsr1k+wOiYwBgBMwAQLbUsofsjpaxEoZmZmpqenY3yo40YKL3msMHZodUxgDACYgAkW0aoc5/Su2xJChMlbCOJmoQYwNzfX1paQNzl4nmC5TGAMAJgAS26C5cMzxqtQJzhtDACYgAmGyQTeO7Q6JsgxBgBMwASrjneRrrIJjAEAEzAB1rgJBpbcjQEAEzABxs4Ep40BABMwARMwwfLhGWMwARMwwbibwHuHwARMwATeSu1dpGCCETBB+JEexRKxdevWt771rUwAMMGImWACS4o6AcAEa4dTp07dh6WDCcAETMAETMAEYAImYAImYAIwARMwARMwAZiACZiACZbfBHrtMYQwARNg5Uxw9913tw1xPXLkyG3AKhH+/ZiACbBCJnBHMXKItkzABEwAJgDABGACAEwAJgDABGACAEwAJgDABGACAMtrggceeOAUMHz4qQMrZwIAABMAAJgAAMAEAAAmAAAwAQCACQAATAAAYAIAABMAAJgAAMAEAAAmAAAwAQCACQAATAAAYAIAABMAAJgAAMAEAIAh4r94PGZxfy1/kQAAAABJRU5ErkJggg==" alt="Demeter"></p> <div class="language-ts extra-class"><pre class="language-ts"><code><span class="token comment">// 销售员</span>
<span class="token keyword">class</span> <span class="token class-name">Salesman</span> <span class="token punctuation">{</span>
  <span class="token keyword">constructor</span><span class="token punctuation">(</span><span class="token parameter"><span class="token keyword">public</span> name<span class="token operator">:</span> <span class="token builtin">string</span></span><span class="token punctuation">)</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>
  <span class="token function">sale</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token builtin">console</span><span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>name <span class="token operator">+</span> <span class="token string">' 销售中....'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
<span class="token comment">// 销售经理</span>
<span class="token keyword">class</span> <span class="token class-name">SaleManager</span> <span class="token punctuation">{</span>
  <span class="token keyword">private</span> salesmen<span class="token operator">:</span> <span class="token builtin">Array</span><span class="token operator">&lt;</span>Salesman<span class="token operator">&gt;</span> <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token keyword">new</span> <span class="token class-name">Salesman</span><span class="token punctuation">(</span><span class="token string">'张三'</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token keyword">new</span> <span class="token class-name">Salesman</span><span class="token punctuation">(</span><span class="token string">'李四'</span><span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
  <span class="token function">sale</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span>salesmen<span class="token punctuation">.</span><span class="token function">forEach</span><span class="token punctuation">(</span><span class="token parameter">salesman</span> <span class="token operator">=&gt;</span> salesman<span class="token punctuation">.</span><span class="token function">sale</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
<span class="token comment">// 大老板</span>
<span class="token keyword">class</span> <span class="token class-name">CEO</span> <span class="token punctuation">{</span>
  <span class="token keyword">private</span> saleManager<span class="token operator">:</span> SaleManager <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">SaleManager</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token function">sale</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span>saleManager<span class="token punctuation">.</span><span class="token function">sale</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
<span class="token keyword">let</span> ceo <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">CEO</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
ceo<span class="token punctuation">.</span><span class="token function">sale</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><h4 id="合成复用原则"><a href="#合成复用原则" class="header-anchor">#</a> 合成复用原则</h4> <h4 id="类的关系"><a href="#类的关系" class="header-anchor">#</a> 类的关系</h4> <ul><li>类之间有三种基本关系，分别是<strong>关联(聚合和组合)、泛化和依赖</strong></li> <li>如果一个类单向依赖另一个类，那么它们之间就是单向关联。如果彼此依赖，则为相互依赖，即双向关联</li> <li>关联关系包括两种特例：聚合和组合
<ul><li>聚合，用来表示整体与部分的关系或者拥有关系，代表部分的对象可能会被整体拥有，但并不定定会随着整体的消亡而销毁,比如班级和学生</li> <li>合成，合成或者说组合要比聚合关系强的多，部分和整体的生命周期是一致的比如人和器官之间</li></ul></li></ul> <p><img src="data:image/png;base64,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" alt="composite"></p> <h4 id="合成复用"><a href="#合成复用" class="header-anchor">#</a> 合成复用</h4> <ul><li>合成复用原则是通过将已有的对象纳入新对象中，作为新对象的成员对象来实现的</li> <li>新对象可以调用已有对象的功能，从而达到复用</li> <li>原则是尽量首先使用<strong>组合/聚合</strong>的方式，而不是使用继承</li> <li>专业人做专业事</li></ul> <p>比如我们不会做饭，就请专业的厨师来做饭</p> <div class="language-ts extra-class"><pre class="language-ts"><code><span class="token keyword">class</span> <span class="token class-name">Cooker</span> <span class="token punctuation">{</span>
  <span class="token function">cook</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>
<span class="token punctuation">}</span>
<span class="token keyword">class</span> <span class="token class-name">Person</span> <span class="token punctuation">{</span>
  <span class="token keyword">private</span> cooker<span class="token operator">:</span> Cooker <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Cooker</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token function">cook</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span>cooker<span class="token punctuation">.</span><span class="token function">cook</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><p>总结</p> <ul><li><strong>开闭原则</strong>是核心，对修改关闭对扩展开放是软件设计的基石</li> <li>单一职责要求我们设计接口和模块功能的时候尽量保证<strong>单一性</strong>和<strong>原子性</strong>，修改一条不影响全局和其它模块</li> <li><strong>里氏替换原则</strong>和<strong>依赖倒置原则</strong>要求<strong>面向接口和抽象</strong>编程，不要依赖具体实现，否则实现一改，上层调用者就要对应修改</li></ul> <h3 id="如何写出好代码"><a href="#如何写出好代码" class="header-anchor">#</a> 如何写出好代码?</h3> <p>可以遵循一下几条原则来编写</p> <ul><li>可维护性 BUG 是否好改?</li> <li>可读性 是否容易看懂?</li> <li>可扩展性 是否可以添加新功能?</li> <li>灵活性 添加新功能是否容易?老方法和接口是否容易复用?</li> <li>简洁性 代码是否简单清晰?</li> <li>可复用性 相同的代码不要写 2 遍?</li> <li>可测试性 是否方便写单元测试和集成测试?</li></ul> <h2 id="二、设计模式的类型和具体实现"><a href="#二、设计模式的类型和具体实现" class="header-anchor">#</a> 二、设计模式的类型和具体实现</h2> <p>设计模式可以分为三大类：</p> <h3 id="结构型模式（structural-patterns）"><a href="#结构型模式（structural-patterns）" class="header-anchor">#</a> 结构型模式（Structural Patterns）</h3> <p>通过识别系统中组件间的简单关系来简化系统的设计。</p> <p>具体实现：</p> <ul><li>重要: 代理模式、桥接模式、装饰器模式、适配器模式</li> <li>不重要: 外观模式、组合模式、享元模式</li></ul> <h3 id="创建型模式（creational-patterns）"><a href="#创建型模式（creational-patterns）" class="header-anchor">#</a> 创建型模式（Creational Patterns）</h3> <p>处理对象的创建，根据实际情况使用合适的方式创建对象。常规的对象创建方式可能会导致设计上的问题，或增加设计的复杂度。创建型模式通过以某种方式控制对象的创建来解决问题。</p> <p>具体实现：</p> <ul><li>重要: 工厂模式(工厂方法模式、抽象工厂模式、简单工厂模式)、建造者模式、单例模式</li> <li>不重要: 原型模式</li></ul> <h3 id="行为型模式（behavioral-patterns）"><a href="#行为型模式（behavioral-patterns）" class="header-anchor">#</a> 行为型模式（Behavioral Patterns）</h3> <p>用于识别对象之间常见的交互模式并加以实现，如此，增加了这些交互的灵活性。</p> <p>具体实现：</p> <ul><li>重要: 观察者模式(发布订阅模式)、模版方法模式、策略模式、职责链模式、迭代器模式、状态模式</li> <li>不重要: 访问者模式、备忘录模式、命令模式、解释器模式、中介者模式</li></ul> <p><img src="/blog/assets/img/design-three.7eb6eba7.png" alt="design-three"></p> <h2 id="一-结构型模式（structural-patterns）"><a href="#一-结构型模式（structural-patterns）" class="header-anchor">#</a> 一. 结构型模式（Structural Patterns）</h2> <h3 id="_1-外观模式（facade-pattern）"><a href="#_1-外观模式（facade-pattern）" class="header-anchor">#</a> 1. 外观模式（Facade Pattern）</h3> <p>外观模式是最常见的设计模式之一，它为子系统中的一组接口提供一个统一的高层接口，使子系统更容易使用。简而言之外观设计模式就是把多个子系统中复杂逻辑进行抽象，从而提供一个更统一、更简洁、更易用的 API。很多我们常用的框架和库基本都遵循了外观设计模式，比如 JQuery 就把复杂的原生 DOM 操作进行了抽象和封装，并消除了浏览器之间的兼容问题，从而提供了一个更高级更易用的版本。其实在平时工作中我们也会经常用到外观模式进行开发，只是我们不自知而已。</p> <p>比如，我们可以应用外观模式封装一个统一的 DOM 元素事件绑定/取消方法，用于兼容不同版本的浏览器和更方便的调用：</p> <p><img src="/blog/assets/img/facade-pattern2.2d47c0b1.jpg" alt="facade-pattern2"></p> <h4 id="实现代码"><a href="#实现代码" class="header-anchor">#</a> 实现代码</h4> <div class="language-js extra-class"><pre class="language-js"><code><span class="token comment">// 绑定事件</span>
<span class="token keyword">function</span> <span class="token function">addEvent</span><span class="token punctuation">(</span><span class="token parameter">element<span class="token punctuation">,</span> event<span class="token punctuation">,</span> handler</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">if</span> <span class="token punctuation">(</span>element<span class="token punctuation">.</span>addEventListener<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    element<span class="token punctuation">.</span><span class="token function">addEventListener</span><span class="token punctuation">(</span>event<span class="token punctuation">,</span> handler<span class="token punctuation">,</span> <span class="token boolean">false</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token keyword">if</span> <span class="token punctuation">(</span>element<span class="token punctuation">.</span>attachEvent<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    element<span class="token punctuation">.</span><span class="token function">attachEvent</span><span class="token punctuation">(</span><span class="token string">'on'</span> <span class="token operator">+</span> event<span class="token punctuation">,</span> handler<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>
    element<span class="token punctuation">[</span><span class="token string">'on'</span> <span class="token operator">+</span> event<span class="token punctuation">]</span> <span class="token operator">=</span> fn<span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token comment">// 取消绑定</span>
<span class="token keyword">function</span> <span class="token function">removeEvent</span><span class="token punctuation">(</span><span class="token parameter">element<span class="token punctuation">,</span> event<span class="token punctuation">,</span> handler</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">if</span> <span class="token punctuation">(</span>element<span class="token punctuation">.</span>removeEventListener<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    element<span class="token punctuation">.</span><span class="token function">removeEventListener</span><span class="token punctuation">(</span>event<span class="token punctuation">,</span> handler<span class="token punctuation">,</span> <span class="token boolean">false</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token keyword">if</span> <span class="token punctuation">(</span>element<span class="token punctuation">.</span>detachEvent<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    element<span class="token punctuation">.</span><span class="token function">detachEvent</span><span class="token punctuation">(</span><span class="token string">'on'</span> <span class="token operator">+</span> event<span class="token punctuation">,</span> handler<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>
    element<span class="token punctuation">[</span><span class="token string">'on'</span> <span class="token operator">+</span> event<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token keyword">null</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><h3 id="_2-代理模式（proxy-pattern）"><a href="#_2-代理模式（proxy-pattern）" class="header-anchor">#</a> 2. 代理模式（Proxy Pattern）</h3> <p>首先，一切皆可代理，不管是在实现世界还是计算机世界。现实世界中买房有中介、打官司有律师、投资有经纪人，他们都是代理，由他们帮你处理由于你缺少时间或者专业技能而无法完成的事务。类比到计算机领域，代理也是一样的作用，当访问一个对象本身的代价太高（比如太占内存、初始化时间太长等）或者需要增加额外的逻辑又不修改对象本身时便可以使用代理。ES6 中也增加了 Proxy 的功能。</p> <p>归纳一下，代理模式可以解决以下的问题：</p> <ol><li><p>增加对一个对象的访问控制</p></li> <li><p>当访问一个对象的过程中需要增加额外的逻辑</p></li></ol> <p>要实现代理模式需要三部分：</p> <ol><li><p><code>Real Subject</code>：真实对象</p></li> <li><p><code>Proxy</code>：代理对象</p></li> <li><p><code>Subject</code>接口：Real Subject 和 Proxy 都需要实现的接口，这样 Proxy 才能被当成 Real Subject 的“替身”使用</p></li></ol> <h4 id="类图"><a href="#类图" class="header-anchor">#</a> 类图</h4> <p><code>Target</code> 目标对象，也就是被代理的对象，是具体业务的执行者
<code>Proxy</code> 代理对象，里面会包含一个目标对象的引用，可以实现对访问的扩展和额外处理</p> <p><img src="/blog/assets/img/proxystar.70e85706.png" alt="proxystar"></p> <h4 id="实现代码-2"><a href="#实现代码-2" class="header-anchor">#</a> 实现代码</h4> <div class="language-ts extra-class"><pre class="language-ts"><code><span class="token keyword">abstract</span> <span class="token keyword">class</span> <span class="token class-name">Star</span> <span class="token punctuation">{</span>
  <span class="token keyword">abstract</span> <span class="token function">answerPhone</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">:</span> <span class="token keyword">void</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token comment">// Target 目标对象</span>
<span class="token keyword">class</span> <span class="token class-name">Angelababy</span> <span class="token keyword">extends</span> <span class="token class-name">Star</span> <span class="token punctuation">{</span>
  <span class="token keyword">public</span> available<span class="token operator">:</span> <span class="token builtin">boolean</span> <span class="token operator">=</span> <span class="token boolean">true</span><span class="token punctuation">;</span>
  <span class="token function">answerPhone</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">:</span> <span class="token keyword">void</span> <span class="token punctuation">{</span>
    <span class="token builtin">console</span><span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'你好,我是Angelababy.'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
<span class="token comment">// 代理对象</span>
<span class="token keyword">class</span> <span class="token class-name">AngelababyAgent</span> <span class="token keyword">extends</span> <span class="token class-name">Star</span> <span class="token punctuation">{</span>
  <span class="token comment">// 包含一个目标对象的引用(angelababy)，可以实现对访问的扩展和额外处理</span>
  <span class="token keyword">constructor</span><span class="token punctuation">(</span><span class="token parameter"><span class="token keyword">private</span> angelababy<span class="token operator">:</span> Angelababy</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">super</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
  <span class="token function">answerPhone</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">:</span> <span class="token keyword">void</span> <span class="token punctuation">{</span>
    <span class="token builtin">console</span><span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'你好,我是Angelababy的经纪人.'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>angelababy<span class="token punctuation">.</span>available<span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token keyword">this</span><span class="token punctuation">.</span>angelababy<span class="token punctuation">.</span><span class="token function">answerPhone</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
<span class="token keyword">let</span> angelababyAgent <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">AngelababyAgent</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">Angelababy</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
angelababyAgent<span class="token punctuation">.</span><span class="token function">answerPhone</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><h4 id="使用场景"><a href="#使用场景" class="header-anchor">#</a> 使用场景</h4> <h5 id="事件委托代理"><a href="#事件委托代理" class="header-anchor">#</a> 事件委托代理</h5> <ul><li>事件捕获指的是从 document 到触发事件的那个节点，即自上而下的去触发事件</li> <li>事件冒泡是自下而上的去触发事件</li> <li>绑定事件方法的第三个参数，就是控制事件触发顺序是否为事件捕获。true 为事件捕获；false 为事件冒泡,默认 false。</li></ul> <p><img src="/blog/assets/img/captureevent.925b6588.jpg" alt="captureevent"></p> <div class="language-html extra-class"><pre class="language-html"><code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>body</span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>ul</span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>list<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>li</span><span class="token punctuation">&gt;</span></span>1<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>li</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>li</span><span class="token punctuation">&gt;</span></span>2<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>li</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>li</span><span class="token punctuation">&gt;</span></span>3<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>li</span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>ul</span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>script</span><span class="token punctuation">&gt;</span></span><span class="token script"><span class="token language-javascript">
    <span class="token comment">// list -&gt; 代理对象</span>
    <span class="token keyword">let</span> list <span class="token operator">=</span> document<span class="token punctuation">.</span><span class="token function">querySelector</span><span class="token punctuation">(</span><span class="token string">'#list'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    list<span class="token punctuation">.</span><span class="token function">addEventListener</span><span class="token punctuation">(</span><span class="token string">'click'</span><span class="token punctuation">,</span> <span class="token parameter">event</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
      <span class="token comment">// event.target -&gt; 目标对象</span>
      <span class="token function">alert</span><span class="token punctuation">(</span>event<span class="token punctuation">.</span>target<span class="token punctuation">.</span>innerHTML<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  </span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>script</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>body</span><span class="token punctuation">&gt;</span></span>
</code></pre></div><h5 id="缓存代理"><a href="#缓存代理" class="header-anchor">#</a> 缓存代理</h5> <p>比如有一个股票价格查询接口，调用这个接口需要比较久的时间（用 setTimeout 模拟 2s 的调用时间）：</p> <p>StockPriceAPI：</p> <p>实现代码</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">function</span> <span class="token function">StockPriceAPI</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token comment">// Subject Interface实现</span>
  <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function-variable function">getValue</span> <span class="token operator">=</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">stock<span class="token punctuation">,</span> callback</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'Calling external API ... '</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token function">setTimeout</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
      <span class="token keyword">switch</span> <span class="token punctuation">(</span>stock<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">case</span> <span class="token string">'GOOGL'</span><span class="token operator">:</span>
          <span class="token function">callback</span><span class="token punctuation">(</span><span class="token string">'$1265.23'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
          <span class="token keyword">break</span><span class="token punctuation">;</span>
        <span class="token keyword">case</span> <span class="token string">'AAPL'</span><span class="token operator">:</span>
          <span class="token function">callback</span><span class="token punctuation">(</span><span class="token string">'$287.05'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
          <span class="token keyword">break</span><span class="token punctuation">;</span>
        <span class="token keyword">case</span> <span class="token string">'MSFT'</span><span class="token operator">:</span>
          <span class="token function">callback</span><span class="token punctuation">(</span><span class="token string">'$173.70'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
          <span class="token keyword">break</span><span class="token punctuation">;</span>
        <span class="token keyword">default</span><span class="token operator">:</span>
          <span class="token function">callback</span><span class="token punctuation">(</span><span class="token string">''</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token punctuation">}</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token number">2000</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre></div><p>我们不希望每次都去请求远程接口，而是增加缓存机制，当有缓存的时候就直接从缓存中获取，否则再去请求远程接口。我们可以通过一个 proxy 来实现：</p> <p>StockPriceAPIProxy：</p> <p>实现代码</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">function</span> <span class="token function">StockPriceAPIProxy</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token comment">// 缓存对象</span>
  <span class="token keyword">this</span><span class="token punctuation">.</span>cache <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">;</span>
  <span class="token comment">// 真实API对象</span>
  <span class="token keyword">this</span><span class="token punctuation">.</span>realAPI <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">StockPriceAPI</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token comment">// Subject Interface实现</span>
  <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function-variable function">getValue</span> <span class="token operator">=</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">stock<span class="token punctuation">,</span> callback</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token comment">// 缓存代理：有缓存就直接取，没有重新去请求远程接口</span>
    <span class="token keyword">const</span> cachedPrice <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span>cache<span class="token punctuation">[</span>stock<span class="token punctuation">]</span><span class="token punctuation">;</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>cachedPrice<span class="token punctuation">)</span> <span class="token punctuation">{</span>
      console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'Got price from cache'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token function">callback</span><span class="token punctuation">(</span>cachedPrice<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>
      <span class="token keyword">this</span><span class="token punctuation">.</span>realAPI<span class="token punctuation">.</span><span class="token function">getValue</span><span class="token punctuation">(</span>stock<span class="token punctuation">,</span> <span class="token parameter">price</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>cache<span class="token punctuation">[</span>stock<span class="token punctuation">]</span> <span class="token operator">=</span> price<span class="token punctuation">;</span>
        <span class="token function">callback</span><span class="token punctuation">(</span>price<span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre></div><p>注意，Proxy 需要和真实对象一样实现 getValue() 方法，getValue()就属于 Subject 接口。</p> <p>测试一下：</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">const</span> api <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">StockPriceAPIProxy</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
api<span class="token punctuation">.</span><span class="token function">getValue</span><span class="token punctuation">(</span><span class="token string">'GOOGL'</span><span class="token punctuation">,</span> <span class="token parameter">price</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>price<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
api<span class="token punctuation">.</span><span class="token function">getValue</span><span class="token punctuation">(</span><span class="token string">'AAPL'</span><span class="token punctuation">,</span> <span class="token parameter">price</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>price<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
api<span class="token punctuation">.</span><span class="token function">getValue</span><span class="token punctuation">(</span><span class="token string">'MSFT'</span><span class="token punctuation">,</span> <span class="token parameter">price</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>price<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token function">setTimeout</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  api<span class="token punctuation">.</span><span class="token function">getValue</span><span class="token punctuation">(</span><span class="token string">'GOOGL'</span><span class="token punctuation">,</span> <span class="token parameter">price</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>price<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  api<span class="token punctuation">.</span><span class="token function">getValue</span><span class="token punctuation">(</span><span class="token string">'AAPL'</span><span class="token punctuation">,</span> <span class="token parameter">price</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>price<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  api<span class="token punctuation">.</span><span class="token function">getValue</span><span class="token punctuation">(</span><span class="token string">'MSFT'</span><span class="token punctuation">,</span> <span class="token parameter">price</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>price<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token number">3000</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><p>输出：</p> <div class="language- extra-class"><pre class="language-text"><code>Calling external API ...
Calling external API ...
Calling external API ...
$1265.23
$287.05
$173.70
Got price from cache
$1265.23
Got price from cache
$287.05
Got price from cache
$173.70
</code></pre></div><h3 id="_3-装饰器模式（decorator-pattern）"><a href="#_3-装饰器模式（decorator-pattern）" class="header-anchor">#</a> 3. 装饰器模式（Decorator Pattern）</h3> <ul><li>在<strong>不改变其原有的结构和功能</strong>为对象<strong>添加新功能</strong>的模式其实就叫做装饰器模式</li> <li>最直观地就是我们买房后的装修</li> <li>装饰比继承更加灵活,可以实现装饰者和被装饰者之间松耦合</li> <li>被装饰者可以使用装饰者动态地增加和撤销功能</li></ul> <p><img src="/blog/assets/img/shape-decorator.9d1e6fb9.png" alt="shape-decorator"></p> <div class="language-ts extra-class"><pre class="language-ts"><code><span class="token keyword">abstract</span> <span class="token keyword">class</span> <span class="token class-name">Shape</span> <span class="token punctuation">{</span>
  <span class="token keyword">abstract</span> <span class="token function">draw</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">:</span> <span class="token keyword">void</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token keyword">class</span> <span class="token class-name">Circle</span> <span class="token keyword">extends</span> <span class="token class-name">Shape</span> <span class="token punctuation">{</span>
  <span class="token function">draw</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token builtin">console</span><span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'绘制圆形'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
<span class="token keyword">class</span> <span class="token class-name">Rectangle</span> <span class="token keyword">extends</span> <span class="token class-name">Shape</span> <span class="token punctuation">{</span>
  <span class="token function">draw</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token builtin">console</span><span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'绘制矩形'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token keyword">abstract</span> <span class="token keyword">class</span> <span class="token class-name">ColorfulShape</span> <span class="token keyword">extends</span> <span class="token class-name">Shape</span> <span class="token punctuation">{</span>
  <span class="token keyword">public</span> <span class="token keyword">constructor</span><span class="token punctuation">(</span><span class="token parameter"><span class="token keyword">public</span> shape<span class="token operator">:</span> Shape</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">super</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
  <span class="token keyword">abstract</span> <span class="token function">draw</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">:</span> <span class="token keyword">void</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token keyword">class</span> <span class="token class-name">RedColorfulShape</span> <span class="token keyword">extends</span> <span class="token class-name">ColorfulShape</span> <span class="token punctuation">{</span>
  <span class="token function">draw</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span>shape<span class="token punctuation">.</span><span class="token function">draw</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token builtin">console</span><span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'把边框涂成红色'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
<span class="token keyword">class</span> <span class="token class-name">GreenColorfulShape</span> <span class="token keyword">extends</span> <span class="token class-name">ColorfulShape</span> <span class="token punctuation">{</span>
  <span class="token function">draw</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span>shape<span class="token punctuation">.</span><span class="token function">draw</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token builtin">console</span><span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'把边框涂成绿色'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token keyword">let</span> circle <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Circle</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">let</span> redColorfulShape <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">RedColorfulShape</span><span class="token punctuation">(</span>circle<span class="token punctuation">)</span><span class="token punctuation">;</span>
redColorfulShape<span class="token punctuation">.</span><span class="token function">draw</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token keyword">let</span> rectangle <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Rectangle</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">let</span> greenColorfulShape <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">GreenColorfulShape</span><span class="token punctuation">(</span>rectangle<span class="token punctuation">)</span><span class="token punctuation">;</span>
greenColorfulShape<span class="token punctuation">.</span><span class="token function">draw</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><h4 id="使用场景-2"><a href="#使用场景-2" class="header-anchor">#</a> 使用场景</h4> <h5 id="装饰器"><a href="#装饰器" class="header-anchor">#</a> 装饰器</h5> <ul><li>装饰器是一种特殊类型的声明，它能够被附加到类声明、方法、属性或参数上，可以修改类的行为</li> <li>常见的装饰器有类装饰器、属性装饰器、方法装饰器和参数装饰器</li> <li>装饰器的写法分为普通装饰器和装饰器工厂</li></ul> <ol><li>类装饰器</li></ol> <ul><li>类装饰器在类声明之前声明，用来监控、修改或替换类定义</li> <li>参数是类的定义或者说构造函数</li> <li><a href="https://babeljs.io/docs/en/babel-plugin-proposal-decorators" target="_blank" rel="noopener noreferrer">babel-plugin-proposal-decorators<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li></ul> <p>decorator</p> <div class="language-ts extra-class"><pre class="language-ts"><code><span class="token keyword">export</span> <span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">;</span>
<span class="token keyword">namespace</span> decorator <span class="token punctuation">{</span>
  <span class="token keyword">interface</span> <span class="token class-name">Animal</span> <span class="token punctuation">{</span>
    swings<span class="token operator">:</span> <span class="token builtin">string</span><span class="token punctuation">;</span>
    fly<span class="token operator">:</span> <span class="token builtin">any</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
  <span class="token keyword">function</span> <span class="token function">flyable</span><span class="token punctuation">(</span><span class="token parameter">target<span class="token operator">:</span> <span class="token builtin">any</span></span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token builtin">console</span><span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>target<span class="token punctuation">)</span><span class="token punctuation">;</span>

    target<span class="token punctuation">.</span>prototype<span class="token punctuation">.</span>swings <span class="token operator">=</span> <span class="token number">2</span><span class="token punctuation">;</span>
    target<span class="token punctuation">.</span>prototype<span class="token punctuation">.</span><span class="token function-variable function">fly</span> <span class="token operator">=</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token builtin">console</span><span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'I can fly'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
  @flyable
  <span class="token keyword">class</span> <span class="token class-name">Animal</span> <span class="token punctuation">{</span>
    <span class="token keyword">constructor</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>
  <span class="token punctuation">}</span>
  <span class="token keyword">let</span> animal<span class="token operator">:</span> Animal <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Animal</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token builtin">console</span><span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>animal<span class="token punctuation">.</span>swings<span class="token punctuation">)</span><span class="token punctuation">;</span>
  animal<span class="token punctuation">.</span><span class="token function">fly</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre></div><p>decorator_factory</p> <div class="language-ts extra-class"><pre class="language-ts"><code><span class="token keyword">namespace</span> decorator_factory <span class="token punctuation">{</span>
  <span class="token keyword">interface</span> <span class="token class-name">Animal</span> <span class="token punctuation">{</span>
    swings<span class="token operator">:</span> <span class="token builtin">string</span><span class="token punctuation">;</span>
    fly<span class="token operator">:</span> <span class="token builtin">any</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
  <span class="token keyword">function</span> <span class="token function">flyable</span><span class="token punctuation">(</span><span class="token parameter">swings<span class="token operator">:</span> <span class="token builtin">number</span></span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> <span class="token keyword">function</span> <span class="token function">flyable</span><span class="token punctuation">(</span><span class="token parameter">target<span class="token operator">:</span> <span class="token builtin">any</span></span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token builtin">console</span><span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>target<span class="token punctuation">)</span><span class="token punctuation">;</span>

      target<span class="token punctuation">.</span>prototype<span class="token punctuation">.</span>swings <span class="token operator">=</span> swings<span class="token punctuation">;</span>
      target<span class="token punctuation">.</span>prototype<span class="token punctuation">.</span><span class="token function-variable function">fly</span> <span class="token operator">=</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token builtin">console</span><span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'I can fly'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token punctuation">}</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>

  @<span class="token function">flyable</span><span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">)</span>
  <span class="token keyword">class</span> <span class="token class-name">Animal</span> <span class="token punctuation">{</span>
    <span class="token keyword">constructor</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>
  <span class="token punctuation">}</span>
  <span class="token keyword">let</span> animal<span class="token operator">:</span> Animal <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Animal</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token builtin">console</span><span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>animal<span class="token punctuation">.</span>swings<span class="token punctuation">)</span><span class="token punctuation">;</span>
  animal<span class="token punctuation">.</span><span class="token function">fly</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre></div><ol start="2"><li>属性装饰器</li></ol> <ul><li>属性装饰器表达式会在运行时当作<strong>函数</strong>被调用</li> <li>属性分为实例属性和类属性</li> <li>方法分为实例方法和类方法</li></ul> <div class="language-ts extra-class"><pre class="language-ts"><code><span class="token keyword">namespace</span> property_namespace <span class="token punctuation">{</span>
  <span class="token comment">//实例属性target是类的原型对象,key是属性名称</span>
  <span class="token keyword">function</span> <span class="token function">instancePropertyDecorator</span><span class="token punctuation">(</span><span class="token parameter">target<span class="token operator">:</span> <span class="token builtin">any</span><span class="token punctuation">,</span> key<span class="token operator">:</span> <span class="token builtin">string</span></span><span class="token punctuation">)</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>
  <span class="token comment">//类属性target是的构造函数</span>
  <span class="token keyword">function</span> <span class="token function">classPropertyDecorator</span><span class="token punctuation">(</span><span class="token parameter">target<span class="token operator">:</span> <span class="token builtin">any</span><span class="token punctuation">,</span> key<span class="token operator">:</span> <span class="token builtin">string</span></span><span class="token punctuation">)</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>
  <span class="token comment">//实例方法装饰器target是原型对象,key方法名,descriptor是方法描述符</span>
  <span class="token keyword">function</span> <span class="token function">instanceMethodDecorator</span><span class="token punctuation">(</span><span class="token parameter">target<span class="token operator">:</span> <span class="token builtin">any</span><span class="token punctuation">,</span> key<span class="token operator">:</span> <span class="token builtin">string</span><span class="token punctuation">,</span> descriptor<span class="token operator">:</span> PropertyDescriptor</span><span class="token punctuation">)</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>
  <span class="token comment">//类方法装饰器target是类的构造函数</span>
  <span class="token keyword">function</span> <span class="token function">classMethodDecorator</span><span class="token punctuation">(</span><span class="token parameter">target<span class="token operator">:</span> <span class="token builtin">any</span><span class="token punctuation">,</span> key<span class="token operator">:</span> <span class="token builtin">string</span><span class="token punctuation">,</span> descriptor<span class="token operator">:</span> PropertyDescriptor</span><span class="token punctuation">)</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>
  <span class="token keyword">class</span> <span class="token class-name">Person</span> <span class="token punctuation">{</span>
    @instancePropertyDecorator
    instanceProperty<span class="token operator">:</span> <span class="token builtin">string</span><span class="token punctuation">;</span>
    @classPropertyDecorator
    <span class="token keyword">public</span> <span class="token keyword">static</span> classProperty<span class="token operator">:</span> <span class="token builtin">string</span><span class="token punctuation">;</span>
    @instanceMethodDecorator
    <span class="token function">instanceMethod</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token builtin">console</span><span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'instanceMethod'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    @classMethodDecorator
    <span class="token function">classMethod</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token builtin">console</span><span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'classMethod'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><ol start="3"><li>core-decorator</li></ol> <ul><li>core-decorator</li> <li>deprecate-alias-deprecated</li></ul> <div class="language-ts extra-class"><pre class="language-ts"><code><span class="token keyword">let</span> <span class="token punctuation">{</span> <span class="token keyword">readonly</span> <span class="token punctuation">}</span> <span class="token operator">=</span> <span class="token keyword">require</span><span class="token punctuation">(</span><span class="token string">'core-decorators'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">function</span> <span class="token function">deprecate</span><span class="token punctuation">(</span><span class="token parameter">msg<span class="token operator">:</span> <span class="token builtin">string</span><span class="token punctuation">,</span> options<span class="token operator">:</span> <span class="token builtin">any</span></span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">return</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">target<span class="token operator">:</span> <span class="token builtin">any</span><span class="token punctuation">,</span> attr<span class="token operator">:</span> <span class="token builtin">any</span><span class="token punctuation">,</span> descriptor<span class="token operator">:</span> <span class="token builtin">any</span></span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token comment">//DEPRECATION Calculator#add: This function will be removed in future versions.</span>
    <span class="token keyword">let</span> oldVal <span class="token operator">=</span> descriptor<span class="token punctuation">.</span>value<span class="token punctuation">;</span>
    descriptor<span class="token punctuation">.</span><span class="token function-variable function">value</span> <span class="token operator">=</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter"><span class="token operator">...</span>args<span class="token operator">:</span> <span class="token builtin">any</span><span class="token punctuation">[</span><span class="token punctuation">]</span></span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token keyword">let</span> message <span class="token operator">=</span> msg
        <span class="token operator">?</span> msg
        <span class="token operator">:</span> <span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">DEPRECATION </span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>target<span class="token punctuation">.</span>constructor<span class="token punctuation">.</span>name<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">#</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>attr<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">: This function will be removed in future versions.</span><span class="token template-punctuation string">`</span></span><span class="token punctuation">;</span>
      <span class="token keyword">let</span> see <span class="token operator">=</span> options <span class="token operator">&amp;&amp;</span> options<span class="token punctuation">.</span>url <span class="token operator">?</span> <span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">see </span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>options<span class="token punctuation">.</span>url<span class="token interpolation-punctuation punctuation">}</span></span><span class="token template-punctuation string">`</span></span> <span class="token operator">:</span> <span class="token template-string"><span class="token template-punctuation string">`</span><span class="token template-punctuation string">`</span></span><span class="token punctuation">;</span>
      <span class="token builtin">console</span><span class="token punctuation">.</span><span class="token function">warn</span><span class="token punctuation">(</span>message <span class="token operator">+</span> <span class="token string">'\r\n'</span> <span class="token operator">+</span> see<span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token keyword">return</span> <span class="token function">oldVal</span><span class="token punctuation">(</span><span class="token operator">...</span>args<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token keyword">class</span> <span class="token class-name">Calculator</span> <span class="token punctuation">{</span>
  @<span class="token function">deprecate</span><span class="token punctuation">(</span><span class="token string">'stop using this'</span><span class="token punctuation">,</span> <span class="token punctuation">{</span> url<span class="token operator">:</span> <span class="token string">'http://www.baidu.com'</span> <span class="token punctuation">}</span><span class="token punctuation">)</span>
  <span class="token function">add</span><span class="token punctuation">(</span><span class="token parameter">a<span class="token operator">:</span> <span class="token builtin">number</span><span class="token punctuation">,</span> b<span class="token operator">:</span> <span class="token builtin">number</span></span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> a <span class="token operator">+</span> b<span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
<span class="token keyword">let</span> calculator <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Calculator</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
calculator<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><h5 id="aop-概念"><a href="#aop-概念" class="header-anchor">#</a> AOP 概念</h5> <p>在软件业，<code>AOP</code> 为 <code>Aspect Oriented Programming</code> 的缩写,意为<strong>面向切面编程</strong>
可以通过预编译方式和运行期动态代理实现在不修改源代码的情况下给程序动态统一添加功能的一种技术</p> <p><img src="data:image/jpeg;base64,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" alt="springaop2"></p> <p><img src="/blog/assets/img/apoprogram.c6d9cedf.jpg" alt="apoprogram"></p> <h5 id="埋点"><a href="#埋点" class="header-anchor">#</a> 埋点</h5> <ul><li>埋点分析: 是网站分析的一种常用的数据采集方法</li> <li>无痕埋点: 通过技术手段，完成对用户行为数据无差别的统计上传的工作,后期数据分析处理的时候通过技术手段筛选出合适的数据进行统计分析</li></ul> <p>项目配置</p> <ol><li>创建项目</li></ol> <div class="language-bash extra-class"><pre class="language-bash"><code>create-react-app james_tract
<span class="token function">yarn</span> <span class="token function">add</span> customize-cra react-app-rewired --dev
</code></pre></div><ol start="2"><li>config-overrides.js</li></ol> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">const</span> <span class="token punctuation">{</span> override<span class="token punctuation">,</span> addDecoratorsLegacy <span class="token punctuation">}</span> <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'customize-cra'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
module<span class="token punctuation">.</span>exports <span class="token operator">=</span> <span class="token function">override</span><span class="token punctuation">(</span><span class="token function">addDecoratorsLegacy</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><ol start="3"><li>jsconfig.json</li></ol> <div class="language-json extra-class"><pre class="language-json"><code><span class="token punctuation">{</span>
  <span class="token property">&quot;compilerOptions&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
    <span class="token property">&quot;experimentalDecorators&quot;</span><span class="token operator">:</span> <span class="token boolean">true</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><p>index.js</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">import</span> React <span class="token keyword">from</span> <span class="token string">'react'</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token punctuation">{</span> render <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'react-dom'</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token punctuation">{</span> before<span class="token punctuation">,</span> after <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'./track'</span><span class="token punctuation">;</span>

<span class="token keyword">class</span> <span class="token class-name">App</span> <span class="token keyword">extends</span> <span class="token class-name">React<span class="token punctuation">.</span>Component</span> <span class="token punctuation">{</span>
  @<span class="token function">before</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'点击方法执行前'</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
  <span class="token function">onClickBeforeButton</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'beforeClick'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>

  @<span class="token function">after</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'点击方法执行后'</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
  <span class="token function">onClickAfterButton</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'afterClick'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>

  @<span class="token function">after</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token function">fetch</span><span class="token punctuation">(</span><span class="token string">'/api/report'</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
  <span class="token function">onClickAjaxButton</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'ajaxClick'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>

  <span class="token function">render</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> <span class="token punctuation">(</span>
      <span class="token operator">&lt;</span>div<span class="token operator">&gt;</span>
        <span class="token operator">&lt;</span>button onClick<span class="token operator">=</span><span class="token punctuation">{</span><span class="token keyword">this</span><span class="token punctuation">.</span>onClickBeforeButton<span class="token punctuation">}</span><span class="token operator">&gt;</span>beforeClick<span class="token operator">&lt;</span><span class="token operator">/</span>button<span class="token operator">&gt;</span>
        <span class="token operator">&lt;</span>button onClick<span class="token operator">=</span><span class="token punctuation">{</span><span class="token keyword">this</span><span class="token punctuation">.</span>onClickAfterButton<span class="token punctuation">}</span><span class="token operator">&gt;</span>afterClick<span class="token operator">&lt;</span><span class="token operator">/</span>button<span class="token operator">&gt;</span>
        <span class="token operator">&lt;</span>button onClick<span class="token operator">=</span><span class="token punctuation">{</span><span class="token keyword">this</span><span class="token punctuation">.</span>onClickAjaxButton<span class="token punctuation">}</span><span class="token operator">&gt;</span>ajaxClick<span class="token operator">&lt;</span><span class="token operator">/</span>button<span class="token operator">&gt;</span>
      <span class="token operator">&lt;</span><span class="token operator">/</span>div<span class="token operator">&gt;</span>
    <span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
<span class="token function">render</span><span class="token punctuation">(</span><span class="token operator">&lt;</span>App <span class="token operator">/</span><span class="token operator">&gt;</span><span class="token punctuation">,</span> document<span class="token punctuation">.</span><span class="token function">getElementById</span><span class="token punctuation">(</span><span class="token string">'root'</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><p>track.js</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">export</span> <span class="token keyword">const</span> <span class="token function-variable function">before</span> <span class="token operator">=</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">beforeFn</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">return</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">target<span class="token punctuation">,</span> methodName<span class="token punctuation">,</span> descriptor</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">let</span> oldMethod <span class="token operator">=</span> descriptor<span class="token punctuation">.</span>value<span class="token punctuation">;</span>
    descriptor<span class="token punctuation">.</span><span class="token function-variable function">value</span> <span class="token operator">=</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token function">beforeFn</span><span class="token punctuation">.</span><span class="token function">apply</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">,</span> arguments<span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token keyword">return</span> <span class="token function">oldMethod</span><span class="token punctuation">.</span><span class="token function">apply</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">,</span> arguments<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>

<span class="token keyword">export</span> <span class="token keyword">const</span> <span class="token function-variable function">after</span> <span class="token operator">=</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">afterFn</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">return</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">target<span class="token punctuation">,</span> methodName<span class="token punctuation">,</span> descriptor</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">let</span> oldMethod <span class="token operator">=</span> descriptor<span class="token punctuation">.</span>value<span class="token punctuation">;</span>
    descriptor<span class="token punctuation">.</span><span class="token function-variable function">value</span> <span class="token operator">=</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token function">oldMethod</span><span class="token punctuation">.</span><span class="token function">apply</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">,</span> arguments<span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token function">afterFn</span><span class="token punctuation">.</span><span class="token function">apply</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">,</span> arguments<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
</code></pre></div><p>表单校验</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token operator">&lt;</span><span class="token operator">!</span><span class="token constant">DOCTYPE</span> html<span class="token operator">&gt;</span>
<span class="token operator">&lt;</span>html lang<span class="token operator">=</span><span class="token string">&quot;en&quot;</span><span class="token operator">&gt;</span>

<span class="token operator">&lt;</span>head<span class="token operator">&gt;</span>
  <span class="token operator">&lt;</span>meta charset<span class="token operator">=</span><span class="token string">&quot;UTF-8&quot;</span><span class="token operator">&gt;</span>
  <span class="token operator">&lt;</span>meta name<span class="token operator">=</span><span class="token string">&quot;viewport&quot;</span> content<span class="token operator">=</span><span class="token string">&quot;width=device-width, initial-scale=1.0&quot;</span><span class="token operator">&gt;</span>
  <span class="token operator">&lt;</span>meta http<span class="token operator">-</span>equiv<span class="token operator">=</span><span class="token string">&quot;X-UA-Compatible&quot;</span> content<span class="token operator">=</span><span class="token string">&quot;ie=edge&quot;</span><span class="token operator">&gt;</span>
  <span class="token operator">&lt;</span>title<span class="token operator">&gt;</span>用户注册<span class="token operator">&lt;</span><span class="token operator">/</span>title<span class="token operator">&gt;</span>
<span class="token operator">&lt;</span><span class="token operator">/</span>head<span class="token operator">&gt;</span>

<span class="token operator">&lt;</span>body<span class="token operator">&gt;</span>
  <span class="token operator">&lt;</span>form action<span class="token operator">=</span><span class="token string">&quot;&quot;</span><span class="token operator">&gt;</span>
      用户名<span class="token operator">&lt;</span>input type<span class="token operator">=</span><span class="token string">&quot;text&quot;</span> name<span class="token operator">=</span><span class="token string">&quot;username&quot;</span> id<span class="token operator">=</span><span class="token string">&quot;username&quot;</span><span class="token operator">&gt;</span>
      密码<span class="token operator">&lt;</span>input type<span class="token operator">=</span><span class="token string">&quot;text&quot;</span> name<span class="token operator">=</span><span class="token string">&quot;password&quot;</span> id<span class="token operator">=</span><span class="token string">&quot;password&quot;</span><span class="token operator">&gt;</span>
      <span class="token operator">&lt;</span>button id<span class="token operator">=</span><span class="token string">&quot;submit-btn&quot;</span><span class="token operator">&gt;</span>注册<span class="token operator">&lt;</span><span class="token operator">/</span>button<span class="token operator">&gt;</span>
  <span class="token operator">&lt;</span><span class="token operator">/</span>form<span class="token operator">&gt;</span>
  <span class="token operator">&lt;</span>script<span class="token operator">&gt;</span>
      <span class="token class-name">Function</span><span class="token punctuation">.</span>prototype<span class="token punctuation">.</span><span class="token function-variable function">before</span> <span class="token operator">=</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token parameter">beforeFn</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
          <span class="token keyword">let</span> _this <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">;</span>
          <span class="token keyword">return</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
              <span class="token keyword">let</span> ret <span class="token operator">=</span> <span class="token function">beforeFn</span><span class="token punctuation">.</span><span class="token function">apply</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">,</span> arguments<span class="token punctuation">)</span><span class="token punctuation">;</span>
              <span class="token keyword">if</span> <span class="token punctuation">(</span>ret<span class="token punctuation">)</span>
                  <span class="token function">_this</span><span class="token punctuation">.</span><span class="token function">apply</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">,</span> arguments<span class="token punctuation">)</span><span class="token punctuation">;</span>
          <span class="token punctuation">}</span>
      <span class="token punctuation">}</span>
      <span class="token keyword">function</span> <span class="token function">submit</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
          <span class="token function">alert</span><span class="token punctuation">(</span><span class="token string">'提交表单'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token punctuation">}</span>
      submit <span class="token operator">=</span> submit<span class="token punctuation">.</span><span class="token function">before</span><span class="token punctuation">(</span><span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
          <span class="token keyword">let</span> username <span class="token operator">=</span> document<span class="token punctuation">.</span><span class="token function">getElementById</span><span class="token punctuation">(</span><span class="token string">'username'</span><span class="token punctuation">)</span><span class="token punctuation">.</span>value<span class="token punctuation">;</span>
          <span class="token keyword">if</span> <span class="token punctuation">(</span>username<span class="token punctuation">.</span>length <span class="token operator">&lt;</span> <span class="token number">6</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
              <span class="token keyword">return</span> <span class="token function">alert</span><span class="token punctuation">(</span><span class="token string">'用户名不能少于6位'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
          <span class="token punctuation">}</span>
          <span class="token keyword">return</span> <span class="token boolean">true</span><span class="token punctuation">;</span>
      <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      submit <span class="token operator">=</span> submit<span class="token punctuation">.</span><span class="token function">before</span><span class="token punctuation">(</span><span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
          <span class="token keyword">let</span> username <span class="token operator">=</span> document<span class="token punctuation">.</span><span class="token function">getElementById</span><span class="token punctuation">(</span><span class="token string">'username'</span><span class="token punctuation">)</span><span class="token punctuation">.</span>value<span class="token punctuation">;</span>
          <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span>username<span class="token punctuation">)</span> <span class="token punctuation">{</span>
              <span class="token keyword">return</span> <span class="token function">alert</span><span class="token punctuation">(</span><span class="token string">'用户名不能为空'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
          <span class="token punctuation">}</span>
          <span class="token keyword">return</span> <span class="token boolean">true</span><span class="token punctuation">;</span>
      <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      document<span class="token punctuation">.</span><span class="token function">getElementById</span><span class="token punctuation">(</span><span class="token string">'submit-btn'</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">addEventListener</span><span class="token punctuation">(</span><span class="token string">'click'</span><span class="token punctuation">,</span> submit<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token operator">&lt;</span><span class="token operator">/</span>script<span class="token operator">&gt;</span>
<span class="token operator">&lt;</span><span class="token operator">/</span>body<span class="token operator">&gt;</span>
<span class="token operator">&lt;</span><span class="token operator">/</span>html<span class="token operator">&gt;</span>
</code></pre></div><p>、</p> <h3 id="_4-适配器模式（adapter-pattern）"><a href="#_4-适配器模式（adapter-pattern）" class="header-anchor">#</a> 4. 适配器模式（Adapter Pattern）</h3> <ul><li>适配器模式又称包装器模式,将一个类的接口转化为用户需要的另一个接口,解决类(对象)之间接口不兼容的问题</li> <li>旧的接口和使用者不兼容</li> <li>中间加一个适配器转换接口</li></ul> <p><img src="/blog/assets/img/power-adaptor4.2747498e.png" alt="power-adaptor4"></p> <p><img src="/blog/assets/img/my-adapter.5fb856c4.jpg" alt="my-adapter"></p> <h4 id="实现代码-3"><a href="#实现代码-3" class="header-anchor">#</a> 实现代码</h4> <div class="language-ts extra-class"><pre class="language-ts"><code><span class="token keyword">class</span> <span class="token class-name">Socket</span> <span class="token punctuation">{</span>
  <span class="token function">output</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> <span class="token string">'输出220V'</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token keyword">abstract</span> <span class="token keyword">class</span> <span class="token class-name">Power</span> <span class="token punctuation">{</span>
  <span class="token keyword">abstract</span> <span class="token function">charge</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">:</span> <span class="token builtin">string</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token keyword">class</span> <span class="token class-name">PowerAdapter</span> <span class="token keyword">extends</span> <span class="token class-name">Power</span> <span class="token punctuation">{</span>
  <span class="token keyword">constructor</span><span class="token punctuation">(</span><span class="token parameter"><span class="token keyword">public</span> socket<span class="token operator">:</span> Socket</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">super</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
  <span class="token comment">//转换后的接口和转换前不一样</span>
  <span class="token function">charge</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> <span class="token keyword">this</span><span class="token punctuation">.</span>socket<span class="token punctuation">.</span><span class="token function">output</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token string">' 经过转换 输出24V'</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
<span class="token keyword">let</span> powerAdapter <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">PowerAdapter</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">Socket</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token builtin">console</span><span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>powerAdapter<span class="token punctuation">.</span><span class="token function">charge</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><h4 id="使用场景-3"><a href="#使用场景-3" class="header-anchor">#</a> 使用场景</h4> <ol><li>axios</li></ol> <ul><li>Axios</li> <li>dispatchRequest</li> <li>defaults</li> <li>xhr</li> <li>http</li></ul> <p>这些适配器的入参都是 config,返回的都是 promise</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token comment">//let axios = require('axios');</span>
<span class="token keyword">let</span> url <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'url'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">function</span> <span class="token function">axios</span><span class="token punctuation">(</span><span class="token parameter">config<span class="token operator">:</span> any</span><span class="token punctuation">)</span><span class="token operator">:</span> any <span class="token punctuation">{</span>
  <span class="token keyword">let</span> adaptor <span class="token operator">=</span> <span class="token function">getDefaultAdapter</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token keyword">return</span> <span class="token function">adaptor</span><span class="token punctuation">(</span>config<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token function">axios</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
  method<span class="token operator">:</span> <span class="token string">'GET'</span><span class="token punctuation">,</span>
  url<span class="token operator">:</span> <span class="token string">'http://localhost:8080/api/user?id=1'</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span>
  <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">response<span class="token operator">:</span> any</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>response<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">error<span class="token operator">:</span> any</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>error<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token keyword">function</span> <span class="token function">xhr</span><span class="token punctuation">(</span><span class="token parameter">config<span class="token operator">:</span> any</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">return</span> <span class="token keyword">new</span> <span class="token class-name">Promise</span><span class="token punctuation">(</span><span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">resolve<span class="token punctuation">,</span> reject</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">var</span> request <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">XMLHttpRequest</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    request<span class="token punctuation">.</span><span class="token function">open</span><span class="token punctuation">(</span>config<span class="token punctuation">.</span>method<span class="token punctuation">,</span> config<span class="token punctuation">.</span>url<span class="token punctuation">,</span> <span class="token boolean">true</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    request<span class="token punctuation">.</span><span class="token function-variable function">onreadystatechange</span> <span class="token operator">=</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token keyword">if</span> <span class="token punctuation">(</span>request<span class="token punctuation">.</span>readyState <span class="token operator">==</span> <span class="token number">4</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span>request<span class="token punctuation">.</span>status <span class="token operator">==</span> <span class="token number">200</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
          <span class="token function">resolve</span><span class="token punctuation">(</span>request<span class="token punctuation">.</span>response<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>
          <span class="token function">reject</span><span class="token punctuation">(</span><span class="token string">'请求失败'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
      <span class="token punctuation">}</span>
    <span class="token punctuation">}</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token keyword">function</span> <span class="token function">http</span><span class="token punctuation">(</span><span class="token parameter">config<span class="token operator">:</span> any</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">let</span> http <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'http'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token keyword">let</span> urlObject <span class="token operator">=</span> url<span class="token punctuation">.</span><span class="token function">parse</span><span class="token punctuation">(</span>config<span class="token punctuation">.</span>url<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token keyword">return</span> <span class="token keyword">new</span> <span class="token class-name">Promise</span><span class="token punctuation">(</span><span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">resolve<span class="token punctuation">,</span> reject</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">const</span> options <span class="token operator">=</span> <span class="token punctuation">{</span>
      hostname<span class="token operator">:</span> urlObject<span class="token punctuation">.</span>hostname<span class="token punctuation">,</span>
      port<span class="token operator">:</span> urlObject<span class="token punctuation">.</span>port<span class="token punctuation">,</span>
      path<span class="token operator">:</span> urlObject<span class="token punctuation">.</span>pathname<span class="token punctuation">,</span>
      method<span class="token operator">:</span> config<span class="token punctuation">.</span>method
    <span class="token punctuation">}</span><span class="token punctuation">;</span>
    <span class="token keyword">var</span> req <span class="token operator">=</span> http<span class="token punctuation">.</span><span class="token function">request</span><span class="token punctuation">(</span>options<span class="token punctuation">,</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">res<span class="token operator">:</span> any</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token keyword">let</span> chunks<span class="token operator">:</span> any<span class="token punctuation">[</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
      res<span class="token punctuation">.</span><span class="token function">on</span><span class="token punctuation">(</span><span class="token string">'data'</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token parameter">chunk<span class="token operator">:</span> any</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
        chunks<span class="token punctuation">.</span><span class="token function">push</span><span class="token punctuation">(</span>chunk<span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      res<span class="token punctuation">.</span><span class="token function">on</span><span class="token punctuation">(</span><span class="token string">'end'</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
        <span class="token function">resolve</span><span class="token punctuation">(</span>Buffer<span class="token punctuation">.</span><span class="token function">concat</span><span class="token punctuation">(</span>chunks<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">toString</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    req<span class="token punctuation">.</span><span class="token function">on</span><span class="token punctuation">(</span><span class="token string">'error'</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token parameter">err<span class="token operator">:</span> any</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
      <span class="token function">reject</span><span class="token punctuation">(</span>err<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    req<span class="token punctuation">.</span><span class="token function">end</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token keyword">function</span> <span class="token function">getDefaultAdapter</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">:</span> any <span class="token punctuation">{</span>
  <span class="token keyword">var</span> adapter<span class="token punctuation">;</span>
  <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token keyword">typeof</span> XMLHttpRequest <span class="token operator">!==</span> <span class="token string">'undefined'</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    adapter <span class="token operator">=</span> xhr<span class="token punctuation">;</span>
  <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token keyword">typeof</span> process <span class="token operator">!==</span> <span class="token string">'undefined'</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    adapter <span class="token operator">=</span> http<span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
  <span class="token keyword">return</span> adapter<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre></div><p>server.js</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">let</span> express <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'express'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">let</span> app <span class="token operator">=</span> <span class="token function">express</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
app<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token string">'/api/user'</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token parameter">req<span class="token punctuation">,</span> res</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  res<span class="token punctuation">.</span><span class="token function">json</span><span class="token punctuation">(</span><span class="token punctuation">{</span> id<span class="token operator">:</span> req<span class="token punctuation">.</span>query<span class="token punctuation">.</span>id<span class="token punctuation">,</span> name<span class="token operator">:</span> <span class="token string">'golderbrother'</span> <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
app<span class="token punctuation">.</span><span class="token function">listen</span><span class="token punctuation">(</span><span class="token number">8080</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><ol start="2"><li>toAxiosAdapter</li></ol> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">function</span> <span class="token function">toAxiosAdapter</span><span class="token punctuation">(</span><span class="token parameter">options<span class="token operator">:</span> any</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">return</span> <span class="token function">axios</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
    url<span class="token operator">:</span> options<span class="token punctuation">.</span>url<span class="token punctuation">,</span>
    method<span class="token operator">:</span> options<span class="token punctuation">.</span>type
  <span class="token punctuation">}</span><span class="token punctuation">)</span>
    <span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span>options<span class="token punctuation">.</span>success<span class="token punctuation">)</span>
    <span class="token punctuation">.</span><span class="token function">catch</span><span class="token punctuation">(</span>options<span class="token punctuation">.</span>error<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

$<span class="token punctuation">.</span><span class="token function-variable function">ajax</span> <span class="token operator">=</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">options<span class="token operator">:</span> any</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">return</span> <span class="token function">toAxiosAdapter</span><span class="token punctuation">(</span>options<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>

$<span class="token punctuation">.</span><span class="token function">ajax</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
  url<span class="token operator">:</span> <span class="token string">'/api/user'</span><span class="token punctuation">,</span>
  type<span class="token operator">:</span> <span class="token string">'GET'</span><span class="token punctuation">,</span>
  <span class="token function-variable function">success</span><span class="token operator">:</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">data<span class="token operator">:</span> any</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>data<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token function-variable function">error</span><span class="token operator">:</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">err<span class="token operator">:</span> any</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    console<span class="token punctuation">.</span><span class="token function">error</span><span class="token punctuation">(</span>err<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><ol start="3"><li>promisify</li></ol> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">let</span> fs <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'fs'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">let</span> Bluebird <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'bluebird'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">let</span> readFile <span class="token operator">=</span> Bluebird<span class="token punctuation">.</span><span class="token function">promisify</span><span class="token punctuation">(</span>fs<span class="token punctuation">.</span>readFile<span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token punctuation">(</span><span class="token keyword">async</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">let</span> content <span class="token operator">=</span> <span class="token keyword">await</span> <span class="token function">readFile</span><span class="token punctuation">(</span><span class="token string">'./1.txt'</span><span class="token punctuation">,</span> <span class="token string">'utf8'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>content<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><div class="language-ts extra-class"><pre class="language-ts"><code><span class="token keyword">function</span> <span class="token function">promisify</span><span class="token punctuation">(</span><span class="token parameter">readFile<span class="token operator">:</span> <span class="token builtin">any</span></span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">return</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">filename<span class="token operator">:</span> <span class="token builtin">any</span><span class="token punctuation">,</span> encoding<span class="token operator">:</span> <span class="token builtin">any</span></span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> <span class="token keyword">new</span> <span class="token class-name">Promise</span><span class="token punctuation">(</span><span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">resolve<span class="token punctuation">,</span> reject</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token function">readFile</span><span class="token punctuation">(</span>filename<span class="token punctuation">,</span> encoding<span class="token punctuation">,</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">err<span class="token operator">:</span> <span class="token builtin">any</span><span class="token punctuation">,</span> data<span class="token operator">:</span> <span class="token builtin">any</span></span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span>err<span class="token punctuation">)</span> <span class="token function">reject</span><span class="token punctuation">(</span>err<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">else</span> <span class="token function">resolve</span><span class="token punctuation">(</span>data<span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre></div><ol start="4"><li>Vue 的 <code>computed</code></li></ol> <div class="language-html extra-class"><pre class="language-html"><code><span class="token doctype">&lt;!DOCTYPE html&gt;</span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>html</span> <span class="token attr-name">lang</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>en<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>head</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>meta</span> <span class="token attr-name">charset</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>UTF-8<span class="token punctuation">&quot;</span></span> <span class="token punctuation">/&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>meta</span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>viewport<span class="token punctuation">&quot;</span></span> <span class="token attr-name">content</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>width=device-width, initial-scale=1.0<span class="token punctuation">&quot;</span></span> <span class="token punctuation">/&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>meta</span> <span class="token attr-name">http-equiv</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>X-UA-Compatible<span class="token punctuation">&quot;</span></span> <span class="token attr-name">content</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>ie=edge<span class="token punctuation">&quot;</span></span> <span class="token punctuation">/&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>script</span> <span class="token attr-name">src</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>https://cdn.bootcss.com/vue/2.5.17/vue.js<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span><span class="token script"></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>script</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>title</span><span class="token punctuation">&gt;</span></span>vue<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>title</span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>head</span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>body</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>root<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>p</span><span class="token punctuation">&gt;</span></span>{{name}}<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>p</span><span class="token punctuation">&gt;</span></span>
      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>p</span><span class="token punctuation">&gt;</span></span>{{upperName}}<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>p</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>script</span><span class="token punctuation">&gt;</span></span><span class="token script"><span class="token language-javascript">
      <span class="token keyword">let</span> vm <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Vue</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
        el<span class="token operator">:</span> <span class="token string">'#root'</span><span class="token punctuation">,</span>
        data<span class="token operator">:</span> <span class="token punctuation">{</span>
          name<span class="token operator">:</span> <span class="token string">'golderbrother'</span>
        <span class="token punctuation">}</span><span class="token punctuation">,</span>
        computed<span class="token operator">:</span> <span class="token punctuation">{</span>
          <span class="token function">upperName</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token keyword">return</span> <span class="token keyword">this</span><span class="token punctuation">.</span>name<span class="token punctuation">.</span><span class="token function">toUpperCase</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
          <span class="token punctuation">}</span>
        <span class="token punctuation">}</span>
      <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    </span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>script</span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>body</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>html</span><span class="token punctuation">&gt;</span></span>
</code></pre></div><ol start="5"><li>tree</li></ol> <p>树型结构数据在下拉框中显示</p> <div class="language-html extra-class"><pre class="language-html"><code><span class="token doctype">&lt;!DOCTYPE html&gt;</span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>html</span> <span class="token attr-name">lang</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>en<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>head</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>meta</span> <span class="token attr-name">charset</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>UTF-8<span class="token punctuation">&quot;</span></span> <span class="token punctuation">/&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>meta</span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>viewport<span class="token punctuation">&quot;</span></span> <span class="token attr-name">content</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>width=device-width, initial-scale=1.0<span class="token punctuation">&quot;</span></span> <span class="token punctuation">/&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>meta</span> <span class="token attr-name">http-equiv</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>X-UA-Compatible<span class="token punctuation">&quot;</span></span> <span class="token attr-name">content</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>ie=edge<span class="token punctuation">&quot;</span></span> <span class="token punctuation">/&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>title</span><span class="token punctuation">&gt;</span></span>Document<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>title</span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>head</span><span class="token punctuation">&gt;</span></span>

  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>body</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>select</span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>users<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>select</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>script</span><span class="token punctuation">&gt;</span></span><span class="token script"><span class="token language-javascript">
      <span class="token keyword">let</span> tree <span class="token operator">=</span> <span class="token punctuation">[</span>
        <span class="token punctuation">{</span>
          name<span class="token operator">:</span> <span class="token string">'父亲'</span><span class="token punctuation">,</span>
          key<span class="token operator">:</span> <span class="token string">'1'</span><span class="token punctuation">,</span>
          children<span class="token operator">:</span> <span class="token punctuation">[</span>
            <span class="token punctuation">{</span>
              name<span class="token operator">:</span> <span class="token string">'儿子'</span><span class="token punctuation">,</span>
              key<span class="token operator">:</span> <span class="token string">'1-1'</span><span class="token punctuation">,</span>
              children<span class="token operator">:</span> <span class="token punctuation">[</span>
                <span class="token punctuation">{</span>
                  name<span class="token operator">:</span> <span class="token string">'孙子'</span><span class="token punctuation">,</span>
                  key<span class="token operator">:</span> <span class="token string">'1-1-1'</span>
                <span class="token punctuation">}</span>
              <span class="token punctuation">]</span>
            <span class="token punctuation">}</span>
          <span class="token punctuation">]</span>
        <span class="token punctuation">}</span>
      <span class="token punctuation">]</span><span class="token punctuation">;</span>
      <span class="token keyword">function</span> <span class="token function">flattenAdapter</span><span class="token punctuation">(</span><span class="token parameter">tree<span class="token punctuation">,</span> flattenArray</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        tree<span class="token punctuation">.</span><span class="token function">forEach</span><span class="token punctuation">(</span><span class="token parameter">item</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
          <span class="token keyword">if</span> <span class="token punctuation">(</span>item<span class="token punctuation">.</span>children<span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token function">flattenAdapter</span><span class="token punctuation">(</span>item<span class="token punctuation">.</span>children<span class="token punctuation">,</span> flattenArray<span class="token punctuation">)</span><span class="token punctuation">;</span>
          <span class="token punctuation">}</span>
          flattenArray<span class="token punctuation">.</span><span class="token function">push</span><span class="token punctuation">(</span><span class="token punctuation">{</span> name<span class="token operator">:</span> item<span class="token punctuation">.</span>name<span class="token punctuation">,</span> key<span class="token operator">:</span> item<span class="token punctuation">.</span>key <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">return</span> flattenArray<span class="token punctuation">;</span>
      <span class="token punctuation">}</span>
      <span class="token keyword">let</span> array <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
      <span class="token function">flattenAdapter</span><span class="token punctuation">(</span>tree<span class="token punctuation">,</span> array<span class="token punctuation">)</span><span class="token punctuation">;</span>
      array<span class="token punctuation">.</span><span class="token function">reverse</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token keyword">let</span> users <span class="token operator">=</span> document<span class="token punctuation">.</span><span class="token function">getElementById</span><span class="token punctuation">(</span><span class="token string">'users'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token keyword">let</span> options <span class="token operator">=</span> array<span class="token punctuation">.</span><span class="token function">map</span><span class="token punctuation">(</span><span class="token parameter">item</span> <span class="token operator">=&gt;</span> <span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">&lt;option value=&quot;</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>item<span class="token punctuation">.</span>key<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">&quot;&gt;</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>item<span class="token punctuation">.</span>name<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">&lt;/option&gt;</span><span class="token template-punctuation string">`</span></span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">join</span><span class="token punctuation">(</span><span class="token string">''</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      users<span class="token punctuation">.</span>innerHTML <span class="token operator">=</span> options<span class="token punctuation">;</span>
    </span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>script</span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>body</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>html</span><span class="token punctuation">&gt;</span></span>
</code></pre></div><ol start="6"><li>Sequelize</li></ol> <p><a href="https://github.com/demopark/sequelize-docs-Zh-CN/tree/master" target="_blank" rel="noopener noreferrer"><code>sequelize</code><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token comment">//cnpm i sequelize sqlite3 -S</span>
<span class="token keyword">const</span> <span class="token punctuation">{</span> Sequelize<span class="token punctuation">,</span> Model<span class="token punctuation">,</span> DataTypes <span class="token punctuation">}</span> <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'sequelize'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> sequelize <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Sequelize</span><span class="token punctuation">(</span><span class="token string">'sqlite::memory:'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token keyword">class</span> <span class="token class-name">User</span> <span class="token keyword">extends</span> <span class="token class-name">Model</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>
User<span class="token punctuation">.</span><span class="token function">init</span><span class="token punctuation">(</span>
  <span class="token punctuation">{</span>
    username<span class="token operator">:</span> DataTypes<span class="token punctuation">.</span><span class="token constant">STRING</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token punctuation">{</span> sequelize<span class="token punctuation">,</span> modelName<span class="token operator">:</span> <span class="token string">'user'</span> <span class="token punctuation">}</span>
<span class="token punctuation">)</span><span class="token punctuation">;</span>

sequelize
  <span class="token punctuation">.</span><span class="token function">sync</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
  <span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span>
    User<span class="token punctuation">.</span><span class="token function">create</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
      username<span class="token operator">:</span> <span class="token string">'golderbrother'</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span>
  <span class="token punctuation">)</span>
  <span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span><span class="token parameter">result</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>result<span class="token punctuation">.</span><span class="token function">toJSON</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><h2 id="二-创建型模式（creational-patterns）"><a href="#二-创建型模式（creational-patterns）" class="header-anchor">#</a> 二. 创建型模式（Creational Patterns）</h2> <h3 id="_1-工厂模式（factory-pattern）"><a href="#_1-工厂模式（factory-pattern）" class="header-anchor">#</a> 1. 工厂模式（Factory Pattern）</h3> <p>现实生活中的工厂按照既定程序制造产品，随着生产原料和流程不同生产出来的产品也会有区别。应用到软件工程的领域，工厂可以看成是一个制造其他对象的对象，制造出的对象也会随着传入工厂对象参数的不同而有所区别。</p> <p>什么场景适合应用工厂模式而不是直接 new 一个对象呢？当构造函数过多不方便管理，且需要创建的对象之间存在某些关联（有同一个父类、实现同一个接口等）时，不妨使用工厂模式。工厂模式提供一种<strong>集中化、统一化</strong>的方式，避免了分散创建对象导致的代码重复、灵活性差的问题。</p> <h4 id="简单工厂模式"><a href="#简单工厂模式" class="header-anchor">#</a> 简单工厂模式</h4> <p>简单工厂模式是由一个工厂对象决定创建出哪一种产品类的实例</p> <p><img src="/blog/assets/img/factory-pattern.9707f3c3.png" alt="factory-pattern"></p> <p>以上图为例，我们构造一个简单的咖啡工厂来生产咖啡：</p> <div class="language-ts extra-class"><pre class="language-ts"><code><span class="token keyword">abstract</span> <span class="token keyword">class</span> <span class="token class-name">Coffee</span> <span class="token punctuation">{</span>
  <span class="token keyword">constructor</span><span class="token punctuation">(</span><span class="token parameter"><span class="token keyword">public</span> name<span class="token operator">:</span> <span class="token builtin">string</span></span><span class="token punctuation">)</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>
<span class="token punctuation">}</span>
<span class="token keyword">class</span> <span class="token class-name">AmericanoCoffee</span> <span class="token keyword">extends</span> <span class="token class-name">Coffee</span> <span class="token punctuation">{</span>
  <span class="token keyword">constructor</span><span class="token punctuation">(</span><span class="token parameter"><span class="token keyword">public</span> name<span class="token operator">:</span> <span class="token builtin">string</span></span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">super</span><span class="token punctuation">(</span>name<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
<span class="token keyword">class</span> <span class="token class-name">LatteCoffee</span> <span class="token keyword">extends</span> <span class="token class-name">Coffee</span> <span class="token punctuation">{</span>
  <span class="token keyword">constructor</span><span class="token punctuation">(</span><span class="token parameter"><span class="token keyword">public</span> name<span class="token operator">:</span> <span class="token builtin">string</span></span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">super</span><span class="token punctuation">(</span>name<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
<span class="token keyword">class</span> <span class="token class-name">CappuccinoCoffee</span> <span class="token keyword">extends</span> <span class="token class-name">Coffee</span> <span class="token punctuation">{</span>
  <span class="token keyword">constructor</span><span class="token punctuation">(</span><span class="token parameter"><span class="token keyword">public</span> name<span class="token operator">:</span> <span class="token builtin">string</span></span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">super</span><span class="token punctuation">(</span>name<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token keyword">class</span> <span class="token class-name">Cafe</span> <span class="token punctuation">{</span>
  <span class="token keyword">static</span> <span class="token function">order</span><span class="token punctuation">(</span><span class="token parameter">name<span class="token operator">:</span> <span class="token builtin">string</span></span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">switch</span> <span class="token punctuation">(</span>name<span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token keyword">case</span> <span class="token string">'Americano'</span><span class="token operator">:</span>
        <span class="token keyword">return</span> <span class="token keyword">new</span> <span class="token class-name">AmericanoCoffee</span><span class="token punctuation">(</span><span class="token string">'美式咖啡'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token keyword">case</span> <span class="token string">'Latte'</span><span class="token operator">:</span>
        <span class="token keyword">return</span> <span class="token keyword">new</span> <span class="token class-name">LatteCoffee</span><span class="token punctuation">(</span><span class="token string">'拿铁咖啡'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token keyword">case</span> <span class="token string">'Cappuccino'</span><span class="token operator">:</span>
        <span class="token keyword">return</span> <span class="token keyword">new</span> <span class="token class-name">LatteCoffee</span><span class="token punctuation">(</span><span class="token string">'卡布奇诺'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token keyword">default</span><span class="token operator">:</span>
        <span class="token keyword">return</span> <span class="token keyword">null</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
<span class="token builtin">console</span><span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>Cafe<span class="token punctuation">.</span><span class="token function">order</span><span class="token punctuation">(</span><span class="token string">'Americano'</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token builtin">console</span><span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>Cafe<span class="token punctuation">.</span><span class="token function">order</span><span class="token punctuation">(</span><span class="token string">'Latte'</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token builtin">console</span><span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>Cafe<span class="token punctuation">.</span><span class="token function">order</span><span class="token punctuation">(</span><span class="token string">'Cappuccino'</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><p>缺点</p> <ul><li>如果产品的种类非常多 switch case 的判断会变得非常多</li> <li>不符合开放—封闭原则,如果要增加或删除一个产品种类，就要修改 switch case 的判断代码</li></ul> <h4 id="工厂方法模式"><a href="#工厂方法模式" class="header-anchor">#</a> 工厂方法模式</h4> <ul><li>工厂方法模式<code>Factory Method</code>,又称多态性工厂模式。</li> <li>在工厂方法模式中,核心的工厂类不再负责所有的产品的创建，而是将具体创建的工作交给<strong>工厂子类</strong>去做。</li></ul> <p><img src="/blog/assets/img/factory-method.c20e9f44.png" alt="factory-method"></p> <h4 id="实现代码-4"><a href="#实现代码-4" class="header-anchor">#</a> 实现代码</h4> <div class="language-ts extra-class"><pre class="language-ts"><code><span class="token keyword">export</span> <span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">;</span>
<span class="token keyword">abstract</span> <span class="token keyword">class</span> <span class="token class-name">Coffee</span> <span class="token punctuation">{</span>
  <span class="token keyword">constructor</span><span class="token punctuation">(</span><span class="token parameter"><span class="token keyword">public</span> name<span class="token operator">:</span> <span class="token builtin">string</span></span><span class="token punctuation">)</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>
<span class="token punctuation">}</span>
<span class="token keyword">abstract</span> <span class="token keyword">class</span> <span class="token class-name">Factory</span> <span class="token punctuation">{</span>
  <span class="token keyword">abstract</span> <span class="token function">createCoffee</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">:</span> Coffee<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token keyword">class</span> <span class="token class-name">AmericanoCoffee</span> <span class="token keyword">extends</span> <span class="token class-name">Coffee</span> <span class="token punctuation">{</span>
  <span class="token keyword">constructor</span><span class="token punctuation">(</span><span class="token parameter"><span class="token keyword">public</span> name<span class="token operator">:</span> <span class="token builtin">string</span></span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">super</span><span class="token punctuation">(</span>name<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token keyword">class</span> <span class="token class-name">AmericanoCoffeeFactory</span> <span class="token keyword">extends</span> <span class="token class-name">Factory</span> <span class="token punctuation">{</span>
  <span class="token function">createCoffee</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> <span class="token keyword">new</span> <span class="token class-name">AmericanoCoffee</span><span class="token punctuation">(</span><span class="token string">'美式咖啡'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token keyword">class</span> <span class="token class-name">LatteCoffee</span> <span class="token keyword">extends</span> <span class="token class-name">Coffee</span> <span class="token punctuation">{</span>
  <span class="token keyword">constructor</span><span class="token punctuation">(</span><span class="token parameter"><span class="token keyword">public</span> name<span class="token operator">:</span> <span class="token builtin">string</span></span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">super</span><span class="token punctuation">(</span>name<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
<span class="token keyword">class</span> <span class="token class-name">LatteCoffeeFactory</span> <span class="token keyword">extends</span> <span class="token class-name">Factory</span> <span class="token punctuation">{</span>
  <span class="token function">createCoffee</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> <span class="token keyword">new</span> <span class="token class-name">LatteCoffee</span><span class="token punctuation">(</span><span class="token string">'拿铁咖啡'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
<span class="token keyword">class</span> <span class="token class-name">CappuccinoCoffee</span> <span class="token keyword">extends</span> <span class="token class-name">Coffee</span> <span class="token punctuation">{</span>
  <span class="token keyword">constructor</span><span class="token punctuation">(</span><span class="token parameter"><span class="token keyword">public</span> name<span class="token operator">:</span> <span class="token builtin">string</span></span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">super</span><span class="token punctuation">(</span>name<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
<span class="token keyword">class</span> <span class="token class-name">CappuccinoFactory</span> <span class="token keyword">extends</span> <span class="token class-name">Factory</span> <span class="token punctuation">{</span>
  <span class="token function">createCoffee</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> <span class="token keyword">new</span> <span class="token class-name">CappuccinoCoffee</span><span class="token punctuation">(</span><span class="token string">'卡布奇诺'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
<span class="token keyword">class</span> <span class="token class-name">Cafe</span> <span class="token punctuation">{</span>
  <span class="token keyword">static</span> <span class="token function">order</span><span class="token punctuation">(</span><span class="token parameter">name<span class="token operator">:</span> <span class="token builtin">string</span></span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">switch</span> <span class="token punctuation">(</span>name<span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token keyword">case</span> <span class="token string">'Americano'</span><span class="token operator">:</span>
        <span class="token keyword">return</span> <span class="token keyword">new</span> <span class="token class-name">AmericanoCoffeeFactory</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">createCoffee</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token keyword">case</span> <span class="token string">'Latte'</span><span class="token operator">:</span>
        <span class="token keyword">return</span> <span class="token keyword">new</span> <span class="token class-name">LatteCoffeeFactory</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">createCoffee</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token keyword">case</span> <span class="token string">'Cappuccino'</span><span class="token operator">:</span>
        <span class="token keyword">return</span> <span class="token keyword">new</span> <span class="token class-name">CappuccinoFactory</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">createCoffee</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token keyword">default</span><span class="token operator">:</span>
        <span class="token keyword">return</span> <span class="token keyword">null</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
<span class="token builtin">console</span><span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>Cafe<span class="token punctuation">.</span><span class="token function">order</span><span class="token punctuation">(</span><span class="token string">'Americano'</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token builtin">console</span><span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>Cafe<span class="token punctuation">.</span><span class="token function">order</span><span class="token punctuation">(</span><span class="token string">'Latte'</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token builtin">console</span><span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>Cafe<span class="token punctuation">.</span><span class="token function">order</span><span class="token punctuation">(</span><span class="token string">'Cappuccino'</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><h4 id="抽象工厂模式-终极解决方案"><a href="#抽象工厂模式-终极解决方案" class="header-anchor">#</a> 抽象工厂模式(终极解决方案)</h4> <ul><li>抽象工厂模式可以向客户端提供一个接口，使客户端在不必指定产品的具体的情况下，创建多个产品族中的产品对象</li> <li>工厂方法模式针对的是同一类或同等级产品,而抽象工厂模式针对的是多种类的产品设计</li> <li>系统中有多个产品族，每个具体工厂负责创建同一族但属于不同产品等级(产品种类)的产品</li> <li>产品族是一组相关或相互依赖的对象</li> <li>系统一次只能消费某一族产品，即相同产品族的产品是一起被使用的</li> <li>当系统需要新增一个产品族时，只需要增加新的工厂类即可，无需修改源代码；但是如果需要产品族中增加一个新种类的产品时，则所有的工厂类都需要修改</li></ul> <p>组成角色</p> <ul><li>抽象工厂: 提供了创建产品的接口,包含多个创建产品的方法,即包含多个类似创建产品的方法</li> <li>具体工厂: 实现抽象工厂定义的接口,完成某个具体产品的创建</li> <li>抽象产品: 抽象产品定义,一般有多少抽象产品,抽象工厂中就包含多少个创建产品的方法</li> <li>具体产品: 抽象产品的实现类</li></ul> <p><img src="/blog/assets/img/abstract-factory3.09c97194.png" alt="abstract-factory3"></p> <p><img src="/blog/assets/img/abstract-factory2.eafa85dc.png" alt="abstract-factory2"></p> <h4 id="实现代码-5"><a href="#实现代码-5" class="header-anchor">#</a> 实现代码</h4> <div class="language-ts extra-class"><pre class="language-ts"><code><span class="token keyword">export</span> <span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">;</span>
<span class="token keyword">abstract</span> <span class="token keyword">class</span> <span class="token class-name">AmericanoCoffee</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>
<span class="token keyword">abstract</span> <span class="token keyword">class</span> <span class="token class-name">LatteCoffee</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>
<span class="token keyword">abstract</span> <span class="token keyword">class</span> <span class="token class-name">CappuccinoCoffee</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>

<span class="token keyword">class</span> <span class="token class-name">StarbucksAmericanoCoffee</span> <span class="token keyword">extends</span> <span class="token class-name">AmericanoCoffee</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>
<span class="token keyword">class</span> <span class="token class-name">StarbucksLatteCoffee</span> <span class="token keyword">extends</span> <span class="token class-name">LatteCoffee</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>
<span class="token keyword">class</span> <span class="token class-name">StarbucksCappuccinoCoffee</span> <span class="token keyword">extends</span> <span class="token class-name">CappuccinoCoffee</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>

<span class="token keyword">class</span> <span class="token class-name">LuckinAmericanoCoffee</span> <span class="token keyword">extends</span> <span class="token class-name">AmericanoCoffee</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>
<span class="token keyword">class</span> <span class="token class-name">LuckinLatteCoffee</span> <span class="token keyword">extends</span> <span class="token class-name">LatteCoffee</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>
<span class="token keyword">class</span> <span class="token class-name">LuckinCappuccinoCoffee</span> <span class="token keyword">extends</span> <span class="token class-name">CappuccinoCoffee</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>

<span class="token keyword">abstract</span> <span class="token keyword">class</span> <span class="token class-name">CafeFactory</span> <span class="token punctuation">{</span>
  <span class="token keyword">abstract</span> <span class="token function">createAmericanoCoffee</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">:</span> AmericanoCoffee<span class="token punctuation">;</span>
  <span class="token keyword">abstract</span> <span class="token function">createLatteCoffee</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">:</span> LatteCoffee<span class="token punctuation">;</span>
  <span class="token keyword">abstract</span> <span class="token function">createCappuccinoCoffee</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">:</span> CappuccinoCoffee<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token keyword">class</span> <span class="token class-name">StarbucksCafeFactory</span> <span class="token keyword">extends</span> <span class="token class-name">CafeFactory</span> <span class="token punctuation">{</span>
  <span class="token function">createAmericanoCoffee</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> <span class="token keyword">new</span> <span class="token class-name">StarbucksAmericanoCoffee</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
  <span class="token function">createLatteCoffee</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> <span class="token keyword">new</span> <span class="token class-name">StarbucksLatteCoffee</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
  <span class="token function">createCappuccinoCoffee</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> <span class="token keyword">new</span> <span class="token class-name">StarbucksCappuccinoCoffee</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
<span class="token keyword">class</span> <span class="token class-name">LuckinCafeFactory</span> <span class="token keyword">extends</span> <span class="token class-name">CafeFactory</span> <span class="token punctuation">{</span>
  <span class="token function">createAmericanoCoffee</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> <span class="token keyword">new</span> <span class="token class-name">LuckinAmericanoCoffee</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
  <span class="token function">createLatteCoffee</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> <span class="token keyword">new</span> <span class="token class-name">LuckinLatteCoffee</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
  <span class="token function">createCappuccinoCoffee</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> <span class="token keyword">new</span> <span class="token class-name">LuckinCappuccinoCoffee</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token keyword">let</span> starbucksCafeFactory <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">StarbucksCafeFactory</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token builtin">console</span><span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>starbucksCafeFactory<span class="token punctuation">.</span><span class="token function">createAmericanoCoffee</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token builtin">console</span><span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>starbucksCafeFactory<span class="token punctuation">.</span><span class="token function">createCappuccinoCoffee</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token builtin">console</span><span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>starbucksCafeFactory<span class="token punctuation">.</span><span class="token function">createLatteCoffee</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token keyword">let</span> luckinCafeFactory <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">LuckinCafeFactory</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token builtin">console</span><span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>luckinCafeFactory<span class="token punctuation">.</span><span class="token function">createAmericanoCoffee</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token builtin">console</span><span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>luckinCafeFactory<span class="token punctuation">.</span><span class="token function">createCappuccinoCoffee</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token builtin">console</span><span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>luckinCafeFactory<span class="token punctuation">.</span><span class="token function">createLatteCoffee</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><h3 id="_2-单例模式（singleton-pattern）"><a href="#_2-单例模式（singleton-pattern）" class="header-anchor">#</a> 2. 单例模式（Singleton Pattern）</h3> <p><img src="/blog/assets/img/singleton-pattern.74b5002b.png" alt="singleton-pattern"> <img src="data:image/png;base64,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" alt="singleton-pattern"></p> <p>顾名思义，单例模式中 Class 的实例个数最多为 1。当需要一个对象去贯穿整个系统执行某些任务时，单例模式就派上了用场。而除此之外的场景尽量避免单例模式的使用，因为单例模式会引入全局状态，而一个健康的系统应该避免引入过多的全局状态。</p> <p>实现单例模式需要解决以下几个问题：</p> <ol><li><p>如何确定 Class 只有一个实例？</p></li> <li><p>如何简便的访问 Class 的唯一实例？</p></li> <li><p>Class 如何控制实例化的过程？</p></li> <li><p>如何将 Class 的实例个数限制为 1？</p></li></ol> <p>我们一般通过实现以下两点来解决上述问题：</p> <ol><li><p>隐藏 Class 的构造函数，避免多次实例化</p></li> <li><p>通过暴露一个 getInstance() 方法来创建/获取唯一实例</p></li></ol> <p>Javascript 中单例模式可以通过以下方式实现：</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token comment">// 单例构造器</span>
<span class="token keyword">const</span> FooServiceSingleton <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token comment">// 隐藏的Class的构造函数</span>
  <span class="token keyword">function</span> <span class="token function">FooService</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>

  <span class="token comment">// 未初始化的单例对象</span>
  <span class="token keyword">let</span> fooService<span class="token punctuation">;</span>

  <span class="token keyword">return</span> <span class="token punctuation">{</span>
    <span class="token comment">// 创建/获取单例对象的函数</span>
    <span class="token function-variable function">getInstance</span><span class="token operator">:</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span>fooService<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        fooService <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">FooService</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token punctuation">}</span>
      <span class="token keyword">return</span> fooService<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><p>实现的关键点有：</p> <ol><li>使用 IIFE 创建局部作用域并即时执行；</li> <li>getInstance() 为一个闭包，使用闭包保存局部作用域中的单例对象并返回。</li></ol> <p>我们可以验证下单例对象是否创建成功：</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">const</span> fooService1 <span class="token operator">=</span> FooServiceSingleton<span class="token punctuation">.</span><span class="token function">getInstance</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> fooService2 <span class="token operator">=</span> FooServiceSingleton<span class="token punctuation">.</span><span class="token function">getInstance</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>fooService1 <span class="token operator">===</span> fooService2<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// true</span>
</code></pre></div><h2 id="三-行为型模式（behavioral-patterns）"><a href="#三-行为型模式（behavioral-patterns）" class="header-anchor">#</a> 三. 行为型模式（Behavioral Patterns）</h2> <h3 id="_1-策略模式（strategy-pattern）"><a href="#_1-策略模式（strategy-pattern）" class="header-anchor">#</a> 1. 策略模式（Strategy Pattern）</h3> <p>策略模式简单描述就是：对象有某个行为，但是在不同的场景中，该行为有不同的实现算法。比如每个人都要“交个人所得税”，但是“在美国交个人所得税”和“在中国交个人所得税”就有不同的算税方法。最常见的使用策略模式的场景如登录鉴权，鉴权算法取决于用户的登录方式是手机、邮箱或者第三方的微信登录等等，而且登录方式也只有在运行时才能获取，获取到登录方式后再动态的配置鉴权策略。所有这些策略应该实现统一的接口，或者说有统一的行为模式。Node 生态里著名的鉴权库 Passport.js API 的设计就应用了策略模式。</p> <p>还是以登录鉴权的例子我们仿照 <code>passport.js</code> 的思路通过代码来理解策略模式：</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token comment">/**
 * 登录控制器
 */</span>
<span class="token keyword">function</span> <span class="token function">LoginController</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">this</span><span class="token punctuation">.</span>strategy <span class="token operator">=</span> <span class="token keyword">undefined</span><span class="token punctuation">;</span>
  <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function-variable function">setStrategy</span> <span class="token operator">=</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">strategy</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span>strategy <span class="token operator">=</span> strategy<span class="token punctuation">;</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span>login <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span>strategy<span class="token punctuation">.</span>login<span class="token punctuation">;</span>
  <span class="token punctuation">}</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token comment">/**
 * 用户名、密码登录策略
 */</span>
<span class="token keyword">function</span> <span class="token function">LocalStragegy</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function-variable function">login</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token parameter"><span class="token punctuation">{</span> username<span class="token punctuation">,</span> password <span class="token punctuation">}</span></span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>username<span class="token punctuation">,</span> password<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token comment">// authenticating with username and password...</span>
  <span class="token punctuation">}</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token comment">/**
 * 手机号、验证码登录策略
 */</span>
<span class="token keyword">function</span> <span class="token function">PhoneStragety</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function-variable function">login</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token parameter"><span class="token punctuation">{</span> phone<span class="token punctuation">,</span> verifyCode <span class="token punctuation">}</span></span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>phone<span class="token punctuation">,</span> verifyCode<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token comment">// authenticating with phone and verifyCode...</span>
  <span class="token punctuation">}</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token comment">/**
 * 第三方社交登录策略
 */</span>
<span class="token keyword">function</span> <span class="token function">SocialStragety</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function-variable function">login</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token parameter"><span class="token punctuation">{</span> id<span class="token punctuation">,</span> secret <span class="token punctuation">}</span></span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>id<span class="token punctuation">,</span> secret<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token comment">// authenticating with id and secret...</span>
  <span class="token punctuation">}</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token keyword">const</span> loginController <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">LoginController</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">// 调用用户名、密码登录接口，使用LocalStrategy</span>
app<span class="token punctuation">.</span><span class="token function">use</span><span class="token punctuation">(</span><span class="token string">'/login/local'</span><span class="token punctuation">,</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">req<span class="token punctuation">,</span> res</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  loginController<span class="token punctuation">.</span><span class="token function">setStrategy</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">LocalStragegy</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  loginController<span class="token punctuation">.</span><span class="token function">login</span><span class="token punctuation">(</span>req<span class="token punctuation">.</span>body<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">// 调用手机、验证码登录接口，使用PhoneStrategy</span>
app<span class="token punctuation">.</span><span class="token function">use</span><span class="token punctuation">(</span><span class="token string">'/login/phone'</span><span class="token punctuation">,</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">req<span class="token punctuation">,</span> res</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  loginController<span class="token punctuation">.</span><span class="token function">setStrategy</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">PhoneStragety</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  loginController<span class="token punctuation">.</span><span class="token function">login</span><span class="token punctuation">(</span>req<span class="token punctuation">.</span>body<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">// 调用社交登录接口，使用SocialStrategy</span>
app<span class="token punctuation">.</span><span class="token function">use</span><span class="token punctuation">(</span><span class="token string">'/login/social'</span><span class="token punctuation">,</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">req<span class="token punctuation">,</span> res</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  loginController<span class="token punctuation">.</span><span class="token function">setStrategy</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">SocialStragety</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  loginController<span class="token punctuation">.</span><span class="token function">login</span><span class="token punctuation">(</span>req<span class="token punctuation">.</span>body<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><p>从以上示例可以得出使用策略模式有以下优势：</p> <ol><li>方便在运行时切换算法和策略</li> <li>代码更简洁，避免使用大量的条件判断</li> <li>关注分离，每个 strategy 类控制自己的算法逻辑，strategy 和其使用者之间也相互独立</li></ol> <h3 id="_2-迭代器模式（iterator-pattern）"><a href="#_2-迭代器模式（iterator-pattern）" class="header-anchor">#</a> 2. 迭代器模式（Iterator Pattern）</h3> <p>迭代器模式(Iterator Pattern)用于顺序地访问聚合对象内部的元素，又无需知道对象内部结构。使用了迭代器之后，使用者不需要关心对象的内部构造，就可以按序访问其中的每个元素。</p> <p><img src="data:image/jpeg;base64,iVBORw0KGgoAAAANSUhEUgAAAqsAAACsCAYAAABcgeVgAAAACXBIWXMAAAsTAAALEwEAmpwYAAAcdUlEQVR4nO3de1DVdf7H8RcnxVJkWFOwslRqcPPWIBWiZoHSekVEnCVSxIrZrPWyua54Sd1fsqIC7oalpTms4zVNEkIHE7YVXFZnpAvVJoatKCEVoqwXVoHz+6M5ZznKgYOi5ws8HzPOcL63z/t7Lh9f5/P9fs/XxWw2mwUAAAAYkMnZBQAAAAD2EFYBAABgWIRVAAAAGBZhFQAAAIZFWAUAAIBhEVYBAABgWIRVAAAAGBZhFQAAAIZFWAUAAIBhEVYBAABgWIRVAAAAGBZhFQAAAIZFWAUAAIBhEVYBAABgWIRVAAAAGBZhFQAAAIZFWAUAAIBhEVYBAABgWIRVAAAAGBZhFQAAAIZFWAUAAIBhEVYBAABgWIRVAAAAGBZhFQAAAIZFWAUAAIBhEVYBAABgWIRVAAAAGBZhFQAAAIZFWAUAAIBhEVYBAABgWIRVAAAAGBZhFQAAAIZFWAUAAIBhEVYBAABgWIRVAAAAGBZhFQAAAIZFWAUAAIBhEVYBAABgWIRVAAAAGBZhFQAAAIZFWAUAAIBhEVYBAABgWIRVAAAAGBZhFQAAAIZFWAUAAIBhEVYBAABgWO2cXcCtqq2tVVpamjIyMnTy5EmdP3/e2SUBbYKHh4e8vb01duxYhYSEyGTiuy8AoPm5mM1ms7OLuFm1tbV67bXXlJOT4+xSgDZt+PDhSkxMJLACAJpdix5ZTUtLU05Ojh555BHFxsbKx8dHnTp1cnZZQJtw6dIlFRYWKj4+XocOHVJaWppCQ0OdXRZaEY6cAc5htCNnLXpkNSYmRvn5+dq4caN8fX2dXQ7QJuXn5ysmJkZ+fn569913nV0OWgmOnAHGYIQjZy16ZPXkyZOSJB8fHydXArRdls9fUVGRkytBa8KRM8B5jHbkrEWfYGY5JEQHBjiPm5ubJHGIFs0qIyNDkhQbGytfX1/6eeAO6tSpk3x9fTV//nxJ0r59+5xaT4sOqwCA1okjZ4DzGeXIGWEVAGA4HDkDnM8oR84IqwAAADAswioAAAAMi7AKAAAAw2rRP12F28PPz8/6t4uLi9zc3NSrVy+NGDFCv/71r+Xq6npT2zWbzXJxcXF4+draWm3dulUZGRk6deqUJKlLly6aOnWqIiIi7kgNAADAuQirsCsiIkLt2rXTmTNndPjwYRUUFGj//v3auHGjOnbs6PB2lixZon/+8596//335eHh4fB6K1eu1O7du/XAAw8oNDRUJpNJJ06c0HfffdfkfbnZGgCgNak7GCFJx44du2EZZ32pZzAB9hBWYVdMTIw12J06dUozZszQ8ePHtWnTJv32t791eDuW30tsKst6a9eu1UMPPWSdfuXKlZveFgC0ZREREdqxY4ckKTo62maes77UM5iAxnDOKhzSs2dPzZo1S5KUnZ1tnf7TTz9p3rx5GjFihPz9/RUVFaXjx49b59f9Fj9ixAibx42ta/nJjMTEROtpAJJ0zz332NR28OBBRUREaPDgwQoODlZiYqKuXr3qUA0A0JbExMRY/545c6bNvIyMDJWXlzdLO025k7uz2kXLQViFw3x9fSVJpaWl1mlnzpxRcXGxRo0aJT8/P3311Vd6/fXXrfPrfnOPiIiwedzYunPmzJHJZFJubq4mTZqkWbNm6csvv7SpKTMzU/Pnz9e1a9c0efJk9ejRQ9u2bdOf//xnh2oAADT+pd6RQQE/Pz9t27ZNQUFBevfddyXd2oCG2WzW9u3bFRoaKn9/f40ePVrr1q1TTU1No+2idSGswmHV1dWSpPbt21un9e3bV1u2bNHEiRMVEhIi6ec7XVy+fFmS7Tf3mJgYm8eNrTtq1Cht3rxZgYGBMplMOnz4sKZPn6709HTrNjZu3ChJevzxx+Xq6mq920ZmZqZ1mYZqAAA0/KXekUEBiy1btmj06NF65JFHJN3agMbWrVuVkJCgqqoqhYeH6+6779bGjRv15ptvNtouWhfOWYXDjh49Kkn65S9/aZ2WnZ2tFStWyGw220y/evVqoxdhObLuo48+qoSEBJWVlSkhIUHZ2dlKTk7W+PHjJUnFxcWSpN27d9ts29l32wCAlmTmzJlKSUmRZHu9glT/oMAXX3yhzMxM/eEPf7DZzoIFC/TUU09ZH1sGJU6dOqVvv/1WR44csQ5KdOzYscF233//fUnSsmXLNHjwYJ08eVKTJ0/Wnj17NHv2bJlMJrvtonUhrMIhRUVFeuuttyRJkZGR1umrVq3SxYsXtXv3bnl4eGjkyJF2t1H3kJEj637xxRcaOHCgJMnLy0uvvvqqsrOzrSOvknTvvfeqrKxM27ZtU58+fRrdj+trAAA0rCmDAn379rV5fCsDGmfPnpUkeXt7S/r52glJunz5sq5cuWJzK97r20XrQliFXRs2bFD79u11+vRp5ebmqrq6Wi+++KKeeeYZ6zK1tbWSfr5iv6Kiot7teHl5qaysTIsXL1bPnj21aNEih9adPn26Bg4cqL59+6q2tla5ubmSpF/96lfWZcLCwrRu3TrNnDlTQUFBcnV1VVFRkSZOnGgTfu3VAACwdf2X+qYMCtx11102j29lQMPT01OlpaUqLi6Wp6en9UJbd3f3G4Lu9e2ideGcVdi1Y8cObd26VZ9//rmGDBmit99+W6+88orNMnPnzpW7u7s+++wz63mn11u4cKEeeOABffrpp9bA6ci6I0eOVGlpqXbt2qXU1FTdfffdmjFjhmJjY63LvPDCC5o9e7Y6duyoPXv2KDU1VVVVVerVq5dDNQBAW7Jhwwbr38nJyTbzvLy8JEmLFy9WXFycdXpYWJikn08ViI+PV1JSkl599VUdPHiw0fbqDkrMnTu33mXstRseHi5Jev3117V69Wr9/ve/l/Tz0T1+j7VtcTG34N95sFw1WN+PGgO4c/gsornxnro9GropQG5urlatWqXS0lJ17dpV+/fvl/Rz4NyyZYv27Nmj77//Xh06dJCPj48WLFhgvaDJst2srCyb807T09OVlJQkk8mkmTNn6o033rhhOXvtms1m/fWvf9UHH3ygsrIyeXp6atKkSZo2bZr1fFV77aL5GOGzSFgFcMv4LKK58Z4CjMEIn0VOAwAAAIBhEVYBAABgWIRVAAAAGBZhFQAAAIZFWAUAAIBhEVYBAABgWIRVAAAAGFaruN3q9T9yDAAAgNaBkVUAAAAYVqsYWeUOJ4BzcXQDtwvvLQCMrAIAAMCwWsXIKgCgdeLIGeBcRji6wcgqAAAADIuwCgAAAMMirAIAAMCwCKsAAAAwLMIqAAAADIuwCgAAAMMirAIwhNLSUmeXAAAwIMKqAwoKCuTn56erV6/esTZzcnLk5+enbdu23bE262PZ9+nTp9tdJjIy8rY9P2VlZXr99dc1cuRIPfHEE3r66ae1fv36Zm9HksrLy7VixQqNGTNG/v7+GjNmjBITE3Xx4kXrMpbn4/Llyw3WPGHCBNXW1t6WOluT06dPKyUlRVFRURo3bpyzywEAGBBhtZkVFxdr4sSJtxzc0tPT1aNHD6WnpzdTZbfmxIkT+te//nXD9GPHjun06dO3pc3q6mrFxMSoS5cu2rlzp/Ly8pSSkqIBAwY4vA1HX48ff/xRU6dOVWVlpdatW6fc3FytXbtWJSUliomJ0ZUrVxxu08vLS3v37pXJdOsfr+Z6PxnJyZMntWHDBkVERCg0NFTJycn66quvnF0WAMCgCKvN7MKFCyouLr6lbVRWVurQoUOKjY3Vt99+q+PHjzdTdTfPz89PO3bsuGH69u3b5evre1vaLCoqUklJiaZNm6Z7771X7dq1U+/evTV06FCHt+Ho65GUlKTevXvrT3/6k3r27Kn27dvL29tbCQkJcnFx0aZNm25lV25ac7yfnM1sNuubb77RW2+9pUmTJmny5Mlav369Tpw44ezSAAAtAGG1HpWVlZo3b56GDBmicePG6ciRIzbzjx49qsjISPn7+2v8+PHKy8uzzouOjpYkBQQE2NyizN46ZWVlmjhxos0h4/3796t3794KCAjQE088YTO6ajkMnZaWpqCgICUkJNQ7zV6b586d0+DBg3X48GHrNquqqjR8+HCb/bje5MmTdeDAAVVUVFinff/99zp8+LBCQkIcen4sdR4+fFjh4eEKCAjQrFmzdP78+XrbvO+++3T33XfrzTfftHvY/erVq1q1apUCAwM1bNgwLVy40Oawvb3Xo66qqiplZ2crKipKLi4uNvNMJpMmTpyoAwcO2Ez/9NNP7e7D9acKNFZjbW2tUlJSFBISYj39wDKK7Uj9RlRbW6uCggKtWbNGEyZM0PPPP69Nmzbp3//+t7NLAwC0MO2cXYARLV26VJcuXVJaWpokaf78+TbzL126pMWLF+uRRx5RcnKyVqxYYV02JSVF0dHRysvLk6ura6PreHl5KTU11Wb76enpGjt2rCRp7NixWrNmjebMmaN27f73ch05ckTp6ekym8367rvvbpjWUJuBgYHat2+fdYQyKytLHh4eGjx4sN3nZNCgQerVq5dSU1P1wgsvSJJ27typp59+Wl5eXg4/P5KUlpamd999V9XV1ZozZ45Wr16tuLi4G9p0d3fXypUrtWTJEuXm5ioyMlIRERHq2LGjdZnly5frzJkz2rFjhzp06KAFCxYoMTFRS5cubfD1qKukpETV1dXy8fGpd37v3r31/fff23yhcHQfHKlxzZo1+vvf/6433nhD/fr1U3Fxse655x6H6zeS/Px8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" alt="iterator-pattern"></p> <p>使用场景</p> <ol><li><code>Iterator</code></li></ol> <p>ES6 中的迭代器 <code>Iterator</code> 相信大家都不陌生，迭代器用于遍历容器（集合）并访问容器中的元素，而且无论容器的数据结构是什么（Array、Set、Map 等），迭代器的接口都应该是一样的，都需要遵循 迭代器协议。</p> <p>迭代器模式解决了以下问题：</p> <ol><li><p>提供一致的遍历各种数据结构的方式，而不用了解数据的内部结构</p></li> <li><p>提供遍历容器（集合）的能力而无需改变容器的接口</p></li></ol> <p>一个迭代器通常需要实现以下接口：</p> <ul><li><p><code>hasNext()</code>：判断迭代是否结束，返回 <code>Boolean</code></p></li> <li><p><code>next()</code>：查找并返回下一个元素</p></li></ul> <p>为 Javascript 的数组实现一个迭代器可以这么写：</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">const</span> item <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token string">'red'</span><span class="token punctuation">,</span> <span class="token boolean">false</span><span class="token punctuation">,</span> <span class="token number">3.14</span><span class="token punctuation">]</span><span class="token punctuation">;</span>

<span class="token keyword">function</span> <span class="token function">Iterator</span><span class="token punctuation">(</span><span class="token parameter">items</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">this</span><span class="token punctuation">.</span>items <span class="token operator">=</span> items<span class="token punctuation">;</span>
  <span class="token keyword">this</span><span class="token punctuation">.</span>index <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token class-name">Iterator</span><span class="token punctuation">.</span>prototype <span class="token operator">=</span> <span class="token punctuation">{</span>
  <span class="token function-variable function">hasNext</span><span class="token operator">:</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> <span class="token keyword">this</span><span class="token punctuation">.</span>index <span class="token operator">&lt;</span> <span class="token keyword">this</span><span class="token punctuation">.</span>items<span class="token punctuation">.</span>length<span class="token punctuation">;</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token function-variable function">next</span><span class="token operator">:</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> <span class="token keyword">this</span><span class="token punctuation">.</span>items<span class="token punctuation">[</span><span class="token keyword">this</span><span class="token punctuation">.</span>index<span class="token operator">++</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
</code></pre></div><p>验证一下迭代器是否工作：</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">const</span> iterator <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Iterator</span><span class="token punctuation">(</span>item<span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token keyword">while</span> <span class="token punctuation">(</span>iterator<span class="token punctuation">.</span><span class="token function">hasNext</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>iterator<span class="token punctuation">.</span><span class="token function">next</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre></div><p>输出：</p> <div class="language- extra-class"><pre class="language-text"><code>1, red, false, 3.14
</code></pre></div><p>ES6 提供了更简单的迭代循环语法 for...of，使用该语法的前提是操作对象需要实现 可迭代协议（The iterable protocol），简单说就是该对象有个 Key 为 Symbol.iterator 的方法，该方法返回一个 iterator 对象。</p> <p>比如我们实现一个 <code>Range</code> 类用于在某个数字区间进行迭代：</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">function</span> <span class="token function">Range</span><span class="token punctuation">(</span><span class="token parameter">start<span class="token punctuation">,</span> end</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">return</span> <span class="token punctuation">{</span>
    <span class="token comment">// 部署迭代器方法</span>
    <span class="token punctuation">[</span>Symbol<span class="token punctuation">.</span>iterator<span class="token punctuation">]</span><span class="token operator">:</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token keyword">return</span> <span class="token punctuation">{</span>
        <span class="token function">next</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
          <span class="token keyword">if</span> <span class="token punctuation">(</span>start <span class="token operator">&lt;</span> end<span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token keyword">return</span> <span class="token punctuation">{</span> value<span class="token operator">:</span> start<span class="token operator">++</span><span class="token punctuation">,</span> done<span class="token operator">:</span> <span class="token boolean">false</span> <span class="token punctuation">}</span><span class="token punctuation">;</span>
          <span class="token punctuation">}</span>
          <span class="token keyword">return</span> <span class="token punctuation">{</span> done<span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span> value<span class="token operator">:</span> end <span class="token punctuation">}</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
      <span class="token punctuation">}</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre></div><p>验证一下：</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">for</span> <span class="token punctuation">(</span>num <span class="token keyword">of</span> <span class="token function">Range</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">5</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>num<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre></div><p>输出：</p> <div class="language- extra-class"><pre class="language-text"><code>1, 2, 3, 4
</code></pre></div><ol start="2"><li><code>forEach</code></li></ol> <p>可以使用 <code>for</code> 循环自己实现一个 <code>forEach</code></p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token class-name">Array</span><span class="token punctuation">.</span>prototype<span class="token punctuation">.</span><span class="token function-variable function">forEach</span> <span class="token operator">=</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">cb</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">var</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> <span class="token keyword">this</span><span class="token punctuation">.</span>length<span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token function">cb</span><span class="token punctuation">.</span><span class="token function">call</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">,</span> <span class="token keyword">this</span><span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">,</span> i<span class="token punctuation">,</span> arr<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
<span class="token keyword">let</span> arr <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
arr<span class="token punctuation">.</span><span class="token function">forEach</span><span class="token punctuation">(</span><span class="token parameter">item</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>item<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><p><code>each</code></p> <ul><li><a href="https://github.com/jquery/jquery/blob/3.4.1/src/core.js#L246-L265" target="_blank" rel="noopener noreferrer">jquery<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li> <li><a href="https://github.com/jashkenas/underscore/blob/1.9.1/underscore.js#L181-L195" target="_blank" rel="noopener noreferrer">underscore<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li></ul> <div class="language-html extra-class"><pre class="language-html"><code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>script</span> <span class="token attr-name">src</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>http://libs.baidu.com/jquery/2.0.0/jquery.min.js<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span><span class="token script"></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>script</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>script</span><span class="token punctuation">&gt;</span></span><span class="token script"><span class="token language-javascript">
  $<span class="token punctuation">.</span><span class="token function">each</span><span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token string">'1'</span><span class="token punctuation">,</span> <span class="token string">'2'</span><span class="token punctuation">,</span> <span class="token string">'3'</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">index<span class="token punctuation">,</span> item</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>index<span class="token punctuation">,</span> item<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span>
  $<span class="token punctuation">.</span><span class="token function">each</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
    name<span class="token operator">:</span> <span class="token string">'golderbrother'</span><span class="token punctuation">,</span>
    age<span class="token operator">:</span> <span class="token number">10</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">index<span class="token punctuation">,</span> item</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>index<span class="token punctuation">,</span> item<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span>

  <span class="token keyword">function</span> <span class="token function">each</span><span class="token punctuation">(</span><span class="token parameter">obj<span class="token punctuation">,</span> callback</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>Array<span class="token punctuation">.</span><span class="token function">isArray</span><span class="token punctuation">(</span>obj<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token keyword">let</span> length <span class="token operator">=</span> obj<span class="token punctuation">.</span>length<span class="token punctuation">;</span>
      <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">let</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> length<span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token function">callback</span><span class="token punctuation">.</span><span class="token function">call</span><span class="token punctuation">(</span>obj<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">,</span> i<span class="token punctuation">,</span> obj<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token operator">===</span> <span class="token boolean">false</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
          <span class="token keyword">break</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
      <span class="token punctuation">}</span>
    <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>
      <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">let</span> i <span class="token keyword">in</span> obj<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token function">callback</span><span class="token punctuation">.</span><span class="token function">call</span><span class="token punctuation">(</span>obj<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">,</span> i<span class="token punctuation">,</span> obj<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token operator">===</span> <span class="token boolean">false</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
          <span class="token keyword">break</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
      <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">return</span> obj<span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>script</span><span class="token punctuation">&gt;</span></span>

<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>body</span><span class="token punctuation">&gt;</span></span>
</code></pre></div><ol start="3"><li><code>yield*</code></li></ol> <p><code>yield*</code>后面跟的是一个可遍历的结构，它会调用该结构的遍历器接口</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">let</span> <span class="token function-variable function">generator</span> <span class="token operator">=</span> <span class="token keyword">function</span><span class="token operator">*</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">yield</span> <span class="token number">1</span><span class="token punctuation">;</span>
  <span class="token keyword">yield</span><span class="token operator">*</span> <span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
  <span class="token keyword">yield</span> <span class="token number">4</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>

<span class="token keyword">var</span> iterator <span class="token operator">=</span> <span class="token function">generator</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>iterator<span class="token punctuation">.</span><span class="token function">next</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// { value: 1, done: false }</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>iterator<span class="token punctuation">.</span><span class="token function">next</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// { value: 2, done: false }</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>iterator<span class="token punctuation">.</span><span class="token function">next</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// { value: 3, done: false }</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>iterator<span class="token punctuation">.</span><span class="token function">next</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// { value: 4, done: false }</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>iterator<span class="token punctuation">.</span><span class="token function">next</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// { value: undefined, done: true }</span>
</code></pre></div><ol start="4"><li>二叉树遍历</li></ol> <ul><li>二叉树是每个结点最多有两个子树的树结构。通常子树被称作左子树和右子树</li> <li>根据根据根节点的顺序可以把遍历分为三种前序、中序、后序
<ul><li>先序遍历：根节点-&gt;左子树-&gt;右子树</li> <li>中序遍历：左子树-&gt;根节点-&gt;右子树</li> <li>后序遍历：左子树-&gt;右子树-&gt;根节点</li></ul></li></ul> <p><img src="https://golderbrother.github.io/blog/assets/img/traversal.ab103822.jpg" alt="traversal"></p> <div class="language-ts extra-class"><pre class="language-ts"><code><span class="token keyword">class</span> <span class="token class-name">Tree</span> <span class="token punctuation">{</span>
  <span class="token keyword">constructor</span><span class="token punctuation">(</span><span class="token parameter"><span class="token keyword">public</span> left<span class="token punctuation">,</span> <span class="token keyword">public</span> value<span class="token punctuation">,</span> <span class="token keyword">public</span> right</span><span class="token punctuation">)</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>
<span class="token punctuation">}</span>
<span class="token comment">//['A', 'B', 'D','E', 'C', 'F','G']</span>
<span class="token keyword">function</span><span class="token operator">*</span> <span class="token function">leftOrder</span><span class="token punctuation">(</span><span class="token parameter">tree</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">if</span> <span class="token punctuation">(</span>tree<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">yield</span> tree<span class="token punctuation">.</span>value<span class="token punctuation">;</span>
    <span class="token keyword">yield</span><span class="token operator">*</span> <span class="token function">leftOrder</span><span class="token punctuation">(</span>tree<span class="token punctuation">.</span>left<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">yield</span><span class="token operator">*</span> <span class="token function">leftOrder</span><span class="token punctuation">(</span>tree<span class="token punctuation">.</span>right<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token comment">//['D', 'B', 'E','A', 'F', 'C','G']</span>
<span class="token keyword">function</span><span class="token operator">*</span> <span class="token function">inOrder</span><span class="token punctuation">(</span><span class="token parameter">tree</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">if</span> <span class="token punctuation">(</span>tree<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">yield</span><span class="token operator">*</span> <span class="token function">inOrder</span><span class="token punctuation">(</span>tree<span class="token punctuation">.</span>left<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">yield</span> tree<span class="token punctuation">.</span>value<span class="token punctuation">;</span>
    <span class="token keyword">yield</span><span class="token operator">*</span> <span class="token function">inOrder</span><span class="token punctuation">(</span>tree<span class="token punctuation">.</span>right<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
<span class="token comment">//['D', 'E', 'B','F', 'G', 'C','A']</span>
<span class="token keyword">function</span><span class="token operator">*</span> <span class="token function">rightOrder</span><span class="token punctuation">(</span><span class="token parameter">tree</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">if</span> <span class="token punctuation">(</span>tree<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">yield</span><span class="token operator">*</span> <span class="token function">rightOrder</span><span class="token punctuation">(</span>tree<span class="token punctuation">.</span>left<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">yield</span><span class="token operator">*</span> <span class="token function">rightOrder</span><span class="token punctuation">(</span>tree<span class="token punctuation">.</span>right<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">yield</span> tree<span class="token punctuation">.</span>value<span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token keyword">function</span> <span class="token function">make</span><span class="token punctuation">(</span><span class="token parameter">array</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">if</span> <span class="token punctuation">(</span>array<span class="token punctuation">.</span>length <span class="token operator">===</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token keyword">return</span> <span class="token keyword">new</span> <span class="token class-name">Tree</span><span class="token punctuation">(</span><span class="token keyword">null</span><span class="token punctuation">,</span> array<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token keyword">null</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token keyword">return</span> <span class="token keyword">new</span> <span class="token class-name">Tree</span><span class="token punctuation">(</span><span class="token function">make</span><span class="token punctuation">(</span>array<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">,</span> array<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token function">make</span><span class="token punctuation">(</span>array<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token keyword">let</span> tree <span class="token operator">=</span> <span class="token function">make</span><span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token punctuation">[</span><span class="token punctuation">[</span><span class="token string">'D'</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token string">'B'</span><span class="token punctuation">,</span> <span class="token punctuation">[</span><span class="token string">'E'</span><span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token string">'A'</span><span class="token punctuation">,</span> <span class="token punctuation">[</span><span class="token punctuation">[</span><span class="token string">'F'</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token string">'C'</span><span class="token punctuation">,</span> <span class="token punctuation">[</span><span class="token string">'G'</span><span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">var</span> result<span class="token operator">:</span> <span class="token builtin">any</span><span class="token punctuation">[</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
<span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">let</span> node <span class="token keyword">of</span> <span class="token function">rightOrder</span><span class="token punctuation">(</span>tree<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  result<span class="token punctuation">.</span><span class="token function">push</span><span class="token punctuation">(</span>node<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token builtin">console</span><span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>result<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><h3 id="_3-观察者模式（observer-pattern）"><a href="#_3-观察者模式（observer-pattern）" class="header-anchor">#</a> 3. 观察者模式（Observer Pattern）</h3> <p><img src="/blog/assets/img/observer-pattern2.c7489d6c.png" alt="observer-pattern"></p> <p>观察者模式又称发布订阅模式（<code>Publish/Subscribe Pattern</code>），是我们经常接触到的设计模式，日常生活中的应用也比比皆是，比如你订阅了某个博主的频道，当有内容更新时会收到推送；又比如 JavaScript 中的事件订阅响应机制。观察者模式的思想用一句话描述就是：<strong>被观察对象（subject）内部维护一组观察者（observer），当被观察对象状态改变时，通过调用观察者的某个方法将这些变化通知到观察者</strong>。</p> <p>那他跟<code>发布订阅模式</code>的区别在哪呢？</p> <ul><li>观察者模式：被观察者(<code>Subject</code>)中存放了观察者<code>Observer</code>，两者有关系</li> <li>发布订阅模式：发布者(<code>publish</code>)和订阅者(<code>subscribe</code>)是通过中间方<code>调度中心</code>来通信的，两者没有关系</li></ul> <p>比如给 DOM 元素绑定事件的 <code>addEventListener()</code> 方法：</p> <div class="language-js extra-class"><pre class="language-js"><code>target<span class="token punctuation">.</span><span class="token function">addEventListener</span><span class="token punctuation">(</span>type<span class="token punctuation">,</span> listener <span class="token punctuation">[</span><span class="token punctuation">,</span> options<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><p>用 <code>Typescript</code> 手动实现观察者模式：</p> <div class="language-ts extra-class"><pre class="language-ts"><code><span class="token keyword">abstract</span> <span class="token keyword">class</span> <span class="token class-name">Student</span> <span class="token punctuation">{</span>
  <span class="token keyword">constructor</span><span class="token punctuation">(</span><span class="token parameter"><span class="token keyword">public</span> teacher<span class="token operator">:</span> Teacher</span><span class="token punctuation">)</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>
  <span class="token keyword">public</span> <span class="token keyword">abstract</span> <span class="token function">update</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token keyword">class</span> <span class="token class-name">Xueba</span> <span class="token keyword">extends</span> <span class="token class-name">Student</span> <span class="token punctuation">{</span>
  <span class="token keyword">public</span> <span class="token function">update</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token builtin">console</span><span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>teacher<span class="token punctuation">.</span><span class="token function">getState</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token string">',学霸抬头举手'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
<span class="token keyword">class</span> <span class="token class-name">Xuezha</span> <span class="token keyword">extends</span> <span class="token class-name">Student</span> <span class="token punctuation">{</span>
  <span class="token keyword">public</span> <span class="token function">update</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token builtin">console</span><span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>teacher<span class="token punctuation">.</span><span class="token function">getState</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token string">',学渣低头祈祷'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token keyword">class</span> <span class="token class-name">Teacher</span> <span class="token punctuation">{</span>
  <span class="token keyword">private</span> students<span class="token operator">:</span> Student<span class="token punctuation">[</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Array</span><span class="token operator">&lt;</span>Student<span class="token operator">&gt;</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token keyword">public</span> state<span class="token operator">:</span> <span class="token builtin">string</span> <span class="token operator">=</span> <span class="token string">'老师讲课'</span><span class="token punctuation">;</span>
  <span class="token function">getState</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> <span class="token keyword">this</span><span class="token punctuation">.</span>state<span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
  <span class="token keyword">public</span> <span class="token function">askQuestion</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span>state <span class="token operator">=</span> <span class="token string">'老师提问'</span><span class="token punctuation">;</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">notifyAllStudents</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
  <span class="token function">attach</span><span class="token punctuation">(</span><span class="token parameter">student<span class="token operator">:</span> Student</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span>students<span class="token punctuation">.</span><span class="token function">push</span><span class="token punctuation">(</span>student<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
  <span class="token function">notifyAllStudents</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span>students<span class="token punctuation">.</span><span class="token function">forEach</span><span class="token punctuation">(</span><span class="token parameter">student</span> <span class="token operator">=&gt;</span> student<span class="token punctuation">.</span><span class="token function">update</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
<span class="token keyword">abstract</span> <span class="token keyword">class</span> <span class="token class-name">GlobalObserver</span> <span class="token punctuation">{</span>
  <span class="token keyword">constructor</span><span class="token punctuation">(</span><span class="token parameter"><span class="token keyword">public</span> subject<span class="token operator">:</span> Subject</span><span class="token punctuation">)</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>
  <span class="token keyword">public</span> <span class="token keyword">abstract</span> <span class="token function">update</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token keyword">class</span> <span class="token class-name">ObserverA</span> <span class="token keyword">extends</span> <span class="token class-name">GlobalObserver</span> <span class="token punctuation">{</span>
  <span class="token keyword">public</span> <span class="token function">update</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token builtin">console</span><span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>subject<span class="token punctuation">.</span><span class="token function">getState</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token string">' 喝不起'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
<span class="token keyword">class</span> <span class="token class-name">ObserverB</span> <span class="token keyword">extends</span> <span class="token class-name">GlobalObserver</span> <span class="token punctuation">{</span>
  <span class="token keyword">public</span> <span class="token function">update</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token builtin">console</span><span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>subject<span class="token punctuation">.</span><span class="token function">getState</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token string">' 走 来一杯'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
<span class="token keyword">class</span> <span class="token class-name">Subject</span> <span class="token punctuation">{</span>
  <span class="token keyword">private</span> observers<span class="token operator">:</span> GlobalObserver<span class="token punctuation">[</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Array</span><span class="token operator">&lt;</span>GlobalObserver<span class="token operator">&gt;</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token keyword">public</span> state<span class="token operator">:</span> <span class="token builtin">string</span> <span class="token operator">=</span> <span class="token string">'叮~ 明天小鹿茶上新品哦!'</span><span class="token punctuation">;</span>
  <span class="token comment">// 获取最新状态消息</span>
  <span class="token function">getState</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> <span class="token keyword">this</span><span class="token punctuation">.</span>state<span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
  <span class="token comment">// 订阅</span>
  <span class="token function">subscribe</span><span class="token punctuation">(</span>observer<span class="token operator">:</span> GlobalObserver<span class="token punctuation">)</span><span class="token operator">:</span> <span class="token keyword">void</span> <span class="token punctuation">{</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span>observers<span class="token punctuation">.</span><span class="token function">push</span><span class="token punctuation">(</span>observer<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
  <span class="token comment">// 取消订阅</span>
  <span class="token function">unsubscribe</span><span class="token punctuation">(</span>observerToRemove<span class="token operator">:</span> GlobalObserver<span class="token punctuation">)</span><span class="token operator">:</span> <span class="token keyword">void</span> <span class="token punctuation">{</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span>observers <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span>observers<span class="token punctuation">.</span><span class="token function">filter</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">observer<span class="token operator">:</span> GlobalObserver</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
      <span class="token keyword">return</span> observer <span class="token operator">!==</span> observerToRemove<span class="token punctuation">;</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
  <span class="token comment">// 事件触发</span>
  <span class="token function">notify</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">:</span> <span class="token keyword">void</span> <span class="token punctuation">{</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span>observers<span class="token punctuation">.</span><span class="token function">forEach</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">observer<span class="token operator">:</span> GlobalObserver</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
      observer<span class="token punctuation">.</span>update <span class="token operator">&amp;&amp;</span> observer<span class="token punctuation">.</span><span class="token function">update</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><p>验证一下订阅是否成功</p> <div class="language-ts extra-class"><pre class="language-ts"><code><span class="token keyword">const</span> subject <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Subject</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">// 叮~ 明天小鹿茶上新品哦!, 喝不起</span>
<span class="token comment">// 叮~ 明天小鹿茶上新品哦!, 走 来一杯</span>
subject<span class="token punctuation">.</span><span class="token function">subscribe</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">ObserverA</span><span class="token punctuation">(</span>subject<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
subject<span class="token punctuation">.</span><span class="token function">subscribe</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">ObserverB</span><span class="token punctuation">(</span>subject<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
subject<span class="token punctuation">.</span><span class="token function">notify</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><h4 id="使用场景-4"><a href="#使用场景-4" class="header-anchor">#</a> 使用场景</h4> <ol><li>DOM 事件绑定</li></ol> <div class="language-html extra-class"><pre class="language-html"><code><span class="token doctype">&lt;!DOCTYPE html&gt;</span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>html</span> <span class="token attr-name">lang</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>en<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>head</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>meta</span> <span class="token attr-name">charset</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>UTF-8<span class="token punctuation">&quot;</span></span> <span class="token punctuation">/&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>meta</span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>viewport<span class="token punctuation">&quot;</span></span> <span class="token attr-name">content</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>width=device-width, initial-scale=1.0<span class="token punctuation">&quot;</span></span> <span class="token punctuation">/&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>meta</span> <span class="token attr-name">http-equiv</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>X-UA-Compatible<span class="token punctuation">&quot;</span></span> <span class="token attr-name">content</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>ie=edge<span class="token punctuation">&quot;</span></span> <span class="token punctuation">/&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>title</span><span class="token punctuation">&gt;</span></span>观察者模式<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>title</span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>head</span><span class="token punctuation">&gt;</span></span>

  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>body</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>button</span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>btn<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>click<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>button</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>script</span><span class="token punctuation">&gt;</span></span><span class="token script"><span class="token language-javascript">
      <span class="token keyword">let</span> btn <span class="token operator">=</span> document<span class="token punctuation">.</span><span class="token function">getElementById</span><span class="token punctuation">(</span><span class="token string">'btn'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token keyword">const</span> <span class="token function-variable function">handler1</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
        console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token punctuation">}</span><span class="token punctuation">;</span>
      <span class="token keyword">const</span> <span class="token function-variable function">handler2</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
        console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token punctuation">}</span><span class="token punctuation">;</span>
      <span class="token keyword">const</span> <span class="token function-variable function">handler3</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
        console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token number">3</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token punctuation">}</span><span class="token punctuation">;</span>
      btn<span class="token punctuation">.</span><span class="token function">addEventListener</span><span class="token punctuation">(</span><span class="token string">'click'</span><span class="token punctuation">,</span> handler1<span class="token punctuation">)</span><span class="token punctuation">;</span>
      btn<span class="token punctuation">.</span><span class="token function">addEventListener</span><span class="token punctuation">(</span><span class="token string">'click'</span><span class="token punctuation">,</span> handler2<span class="token punctuation">)</span><span class="token punctuation">;</span>
      btn<span class="token punctuation">.</span><span class="token function">addEventListener</span><span class="token punctuation">(</span><span class="token string">'click'</span><span class="token punctuation">,</span> handler3<span class="token punctuation">)</span><span class="token punctuation">;</span>
    </span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>script</span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>body</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>html</span><span class="token punctuation">&gt;</span></span>
</code></pre></div><ol start="2"><li><code>Promise</code></li></ol> <div class="language-ts extra-class"><pre class="language-ts"><code><span class="token keyword">class</span> <span class="token class-name">Promise</span> <span class="token punctuation">{</span>
  <span class="token keyword">private</span> callbacks<span class="token operator">:</span> <span class="token builtin">Array</span><span class="token operator">&lt;</span><span class="token builtin">Function</span><span class="token operator">&gt;</span> <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
  <span class="token keyword">constructor</span><span class="token punctuation">(</span><span class="token parameter">fn</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">let</span> <span class="token function-variable function">resolve</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
      <span class="token keyword">this</span><span class="token punctuation">.</span>callbacks<span class="token punctuation">.</span><span class="token function">forEach</span><span class="token punctuation">(</span><span class="token parameter">callback</span> <span class="token operator">=&gt;</span> <span class="token function">callback</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span><span class="token punctuation">;</span>
    <span class="token function">fn</span><span class="token punctuation">(</span>resolve<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
  <span class="token function">then</span><span class="token punctuation">(</span><span class="token parameter">callback</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span>callbacks<span class="token punctuation">.</span><span class="token function">push</span><span class="token punctuation">(</span>callback<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
<span class="token keyword">let</span> promise <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Promise</span><span class="token punctuation">(</span><span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">resolve</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token function">setTimeout</span><span class="token punctuation">(</span><span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token function">resolve</span><span class="token punctuation">(</span><span class="token number">100</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token number">1000</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
promise<span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token builtin">console</span><span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
promise<span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token builtin">console</span><span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><ol start="3"><li><code>callbacks</code></li></ol> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">function</span> <span class="token function">Callbacks</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">let</span> observers <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
  <span class="token keyword">function</span> <span class="token function">add</span><span class="token punctuation">(</span><span class="token parameter">observer</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    observers<span class="token punctuation">.</span><span class="token function">push</span><span class="token punctuation">(</span>observer<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
  <span class="token keyword">function</span> <span class="token function">remove</span><span class="token punctuation">(</span><span class="token parameter">observer</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">let</span> index <span class="token operator">=</span> observers<span class="token punctuation">.</span><span class="token function">indexOf</span><span class="token punctuation">(</span>observer<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>index <span class="token operator">!=</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span> observers<span class="token punctuation">.</span><span class="token function">splice</span><span class="token punctuation">(</span>index<span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
  <span class="token keyword">function</span> <span class="token function">fire</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    observers<span class="token punctuation">.</span><span class="token function">forEach</span><span class="token punctuation">(</span><span class="token parameter">observer</span> <span class="token operator">=&gt;</span> <span class="token function">observer</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
  <span class="token keyword">return</span> <span class="token punctuation">{</span>
    add<span class="token punctuation">,</span>
    remove<span class="token punctuation">,</span>
    fire
  <span class="token punctuation">}</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre></div><ol start="4"><li><code>EventEmitter</code></li></ol> <p>自定义事件</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">const</span> EventEmitter <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'events'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">let</span> subject <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">EventEmitter</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
subject<span class="token punctuation">.</span><span class="token function">on</span><span class="token punctuation">(</span><span class="token string">'click'</span><span class="token punctuation">,</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">name</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span> name<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
subject<span class="token punctuation">.</span><span class="token function">on</span><span class="token punctuation">(</span><span class="token string">'click'</span><span class="token punctuation">,</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">name</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">,</span> name<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
subject<span class="token punctuation">.</span><span class="token function">emit</span><span class="token punctuation">(</span><span class="token string">'click'</span><span class="token punctuation">,</span> <span class="token string">'golderbrother'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><p>events.js</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">class</span> <span class="token class-name">EventEmitter</span> <span class="token punctuation">{</span>
  <span class="token function">constructor</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span>_events <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
  <span class="token function">on</span><span class="token punctuation">(</span><span class="token parameter">type<span class="token punctuation">,</span> listener</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">let</span> listeners <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span>_events<span class="token punctuation">[</span>type<span class="token punctuation">]</span><span class="token punctuation">;</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>listeners<span class="token punctuation">)</span> <span class="token punctuation">{</span>
      listeners<span class="token punctuation">.</span><span class="token function">push</span><span class="token punctuation">(</span>listener<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>
      <span class="token keyword">this</span><span class="token punctuation">.</span>_events<span class="token punctuation">[</span>type<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token punctuation">[</span>listener<span class="token punctuation">]</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span>
  <span class="token function">emit</span><span class="token punctuation">(</span><span class="token parameter">type</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">let</span> listeners <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span>_events<span class="token punctuation">[</span>type<span class="token punctuation">]</span><span class="token punctuation">;</span>
    <span class="token keyword">let</span> args <span class="token operator">=</span> Array<span class="token punctuation">.</span><span class="token function">from</span><span class="token punctuation">(</span>arguments<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">slice</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    listeners<span class="token punctuation">.</span><span class="token function">forEach</span><span class="token punctuation">(</span><span class="token parameter">listener</span> <span class="token operator">=&gt;</span> <span class="token function">listener</span><span class="token punctuation">(</span><span class="token operator">...</span>args<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
module<span class="token punctuation">.</span>exports <span class="token operator">=</span> EventEmitter<span class="token punctuation">;</span>
</code></pre></div><ol start="5"><li>流</li></ol> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">let</span> fs <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'fs'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">let</span> rs <span class="token operator">=</span> fs<span class="token punctuation">.</span><span class="token function">createReadStream</span><span class="token punctuation">(</span><span class="token string">'./1.txt'</span><span class="token punctuation">,</span> <span class="token punctuation">{</span> highWaterMark<span class="token operator">:</span> <span class="token number">3</span> <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
rs<span class="token punctuation">.</span><span class="token function">on</span><span class="token punctuation">(</span><span class="token string">'data'</span><span class="token punctuation">,</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">data</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>data<span class="token punctuation">.</span><span class="token function">toString</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
rs<span class="token punctuation">.</span><span class="token function">on</span><span class="token punctuation">(</span><span class="token string">'end'</span><span class="token punctuation">,</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'end'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><ol start="6"><li><code>http</code> 服务器</li></ol> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">let</span> http <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'http'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">let</span> server <span class="token operator">=</span> http<span class="token punctuation">.</span><span class="token function">createServer</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
server<span class="token punctuation">.</span><span class="token function">on</span><span class="token punctuation">(</span><span class="token string">'request'</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token parameter">req<span class="token punctuation">,</span> res</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  res<span class="token punctuation">.</span><span class="token function">end</span><span class="token punctuation">(</span><span class="token string">'golderbrother'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
server<span class="token punctuation">.</span><span class="token function">listen</span><span class="token punctuation">(</span><span class="token number">3000</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><ol start="7"><li>生命周期函数</li></ol> <p>react</p> <p><img src="/blog/assets/img/react-lifecycles.18787b40.jpg" alt="react-lifecycles"></p> <p>vue</p> <p><img src="/blog/assets/img/vue-lifecycles.0d4358e4.jpg" alt="vue-lifecycles"></p> <ol start="8"><li>EventBus</li></ol> <ul><li>如果你觉得使用$on、$emit 不方便,而你又不愿意引入 vuex,可以使用 EventBus</li> <li>在要相互通信的兄弟组件之中，都引入一个新的 vue 实例，然后通过分别调用这个实例的事件触发和监听来实现通信和参数传递</li></ul> <p>EventBus.js</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">import</span> Vue <span class="token keyword">from</span> <span class="token string">'vue'</span><span class="token punctuation">;</span>
<span class="token keyword">export</span> <span class="token keyword">default</span> <span class="token keyword">new</span> <span class="token class-name">Vue</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><p>组件 A</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">import</span> EventBus <span class="token keyword">from</span> <span class="token string">'./EventBus'</span><span class="token punctuation">;</span>
EventBus<span class="token punctuation">.</span><span class="token function">$on</span><span class="token punctuation">(</span><span class="token string">'customEvent'</span><span class="token punctuation">,</span> <span class="token parameter">name</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>name<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><p>组件 B</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">import</span> EventBus <span class="token keyword">from</span> <span class="token string">'./EventBus'</span><span class="token punctuation">;</span>
EventBus<span class="token punctuation">.</span><span class="token function">$emit</span><span class="token punctuation">(</span><span class="token string">'customEvent'</span><span class="token punctuation">,</span> <span class="token string">'golderbrother'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><div class="language-html extra-class"><pre class="language-html"><code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>body</span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>script</span> <span class="token attr-name">src</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>https://cdn.bootcss.com/vue/2.5.17/vue.js<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span><span class="token script"></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>script</span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>script</span><span class="token punctuation">&gt;</span></span><span class="token script"><span class="token language-javascript">
    <span class="token keyword">let</span> EventBus <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Vue</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    EventBus<span class="token punctuation">.</span><span class="token function">$on</span><span class="token punctuation">(</span><span class="token string">'customEvent'</span><span class="token punctuation">,</span> <span class="token parameter">name</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
      console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>name<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    EventBus<span class="token punctuation">.</span><span class="token function">$emit</span><span class="token punctuation">(</span><span class="token string">'customEvent'</span><span class="token punctuation">,</span> <span class="token string">'golderbrother'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  </span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>script</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>body</span><span class="token punctuation">&gt;</span></span>
</code></pre></div><ol start="9"><li>Vue 响应式原理</li></ol> <p>在 Vue 中，每个组件实例都有相应的 watcher 实例对象，它会在组件渲染的过程中把属性记录为依赖，之后当依赖项的 setter 被调用时，会通知 watcher 重新计算，从而致使它关联的组件得以更新</p> <p><img src="/blog/assets/img/vue-reactive.dcc05b56.jpg" alt="vue-reactive"></p> <div class="language-html extra-class"><pre class="language-html"><code><span class="token doctype">&lt;!DOCTYPE html&gt;</span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>html</span> <span class="token attr-name">lang</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>en<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>head</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>meta</span> <span class="token attr-name">charset</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>UTF-8<span class="token punctuation">&quot;</span></span> <span class="token punctuation">/&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>meta</span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>viewport<span class="token punctuation">&quot;</span></span> <span class="token attr-name">content</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>width=device-width, initial-scale=1.0<span class="token punctuation">&quot;</span></span> <span class="token punctuation">/&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>meta</span> <span class="token attr-name">http-equiv</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>X-UA-Compatible<span class="token punctuation">&quot;</span></span> <span class="token attr-name">content</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>ie=edge<span class="token punctuation">&quot;</span></span> <span class="token punctuation">/&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>title</span><span class="token punctuation">&gt;</span></span>vue<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>title</span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>head</span><span class="token punctuation">&gt;</span></span>

  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>body</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>name<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>age<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>script</span><span class="token punctuation">&gt;</span></span><span class="token script"><span class="token language-javascript">
      <span class="token keyword">let</span> name <span class="token operator">=</span> document<span class="token punctuation">.</span><span class="token function">getElementById</span><span class="token punctuation">(</span><span class="token string">'name'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token keyword">let</span> age <span class="token operator">=</span> document<span class="token punctuation">.</span><span class="token function">getElementById</span><span class="token punctuation">(</span><span class="token string">'age'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token keyword">class</span> <span class="token class-name">Dep</span> <span class="token punctuation">{</span>
        subs <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
        <span class="token function">addSub</span><span class="token punctuation">(</span><span class="token parameter">sub</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
          <span class="token keyword">this</span><span class="token punctuation">.</span>subs<span class="token punctuation">.</span><span class="token function">push</span><span class="token punctuation">(</span>sub<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
        <span class="token function">notify</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
          <span class="token keyword">this</span><span class="token punctuation">.</span>subs<span class="token punctuation">.</span><span class="token function">forEach</span><span class="token punctuation">(</span><span class="token parameter">sub</span> <span class="token operator">=&gt;</span> <span class="token function">sub</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
      <span class="token punctuation">}</span>
      <span class="token keyword">function</span> <span class="token function">observe</span><span class="token punctuation">(</span><span class="token parameter">target</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        Object<span class="token punctuation">.</span><span class="token function">keys</span><span class="token punctuation">(</span>target<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">forEach</span><span class="token punctuation">(</span><span class="token parameter">key</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
          <span class="token keyword">let</span> val <span class="token operator">=</span> target<span class="token punctuation">[</span>key<span class="token punctuation">]</span><span class="token punctuation">;</span>
          <span class="token keyword">const</span> dep <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Dep</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
          <span class="token keyword">if</span> <span class="token punctuation">(</span>key <span class="token operator">==</span> <span class="token string">'name'</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            name<span class="token punctuation">.</span>innerHTML <span class="token operator">=</span> val<span class="token punctuation">;</span>
            dep<span class="token punctuation">.</span><span class="token function">addSub</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
              name<span class="token punctuation">.</span>innerHTML <span class="token operator">=</span> val<span class="token punctuation">;</span>
            <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
          <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token keyword">if</span> <span class="token punctuation">(</span>key <span class="token operator">==</span> <span class="token string">'age'</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            age<span class="token punctuation">.</span>innerHTML <span class="token operator">=</span> val<span class="token punctuation">;</span>
            dep<span class="token punctuation">.</span><span class="token function">addSub</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
              age<span class="token punctuation">.</span>innerHTML <span class="token operator">=</span> val<span class="token punctuation">;</span>
            <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
          <span class="token punctuation">}</span>
          Object<span class="token punctuation">.</span><span class="token function">defineProperty</span><span class="token punctuation">(</span>target<span class="token punctuation">,</span> key<span class="token punctuation">,</span> <span class="token punctuation">{</span>
            <span class="token function-variable function">get</span><span class="token operator">:</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
              <span class="token keyword">return</span> val<span class="token punctuation">;</span>
            <span class="token punctuation">}</span><span class="token punctuation">,</span>
            <span class="token function-variable function">set</span><span class="token operator">:</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">value</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
              val <span class="token operator">=</span> value<span class="token punctuation">;</span>
              dep<span class="token punctuation">.</span><span class="token function">notify</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span>
          <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token punctuation">}</span>

      <span class="token keyword">let</span> obj <span class="token operator">=</span> <span class="token punctuation">{</span> name<span class="token operator">:</span> <span class="token string">'名称'</span><span class="token punctuation">,</span> age<span class="token operator">:</span> <span class="token string">'年龄'</span> <span class="token punctuation">}</span><span class="token punctuation">;</span>
      <span class="token function">observe</span><span class="token punctuation">(</span>obj<span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token function">setTimeout</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
        obj<span class="token punctuation">.</span>name <span class="token operator">=</span> <span class="token string">'新名称'</span><span class="token punctuation">;</span>
      <span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token number">3000</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token function">setTimeout</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
        obj<span class="token punctuation">.</span>age <span class="token operator">=</span> <span class="token string">'新年龄'</span><span class="token punctuation">;</span>
      <span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token number">6000</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    </span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>script</span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>body</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>html</span><span class="token punctuation">&gt;</span></span>
</code></pre></div><ol start="10"><li>redux</li></ol> <ul><li><a href="https://github.com/reduxjs/redux/blob/master/src/createStore.js" target="_blank" rel="noopener noreferrer">createStore<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li></ul> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">export</span> <span class="token keyword">default</span> <span class="token keyword">function</span> <span class="token function">createStore</span><span class="token punctuation">(</span><span class="token parameter">reducer<span class="token punctuation">,</span> preloadedState<span class="token punctuation">,</span> enhancer</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">if</span> <span class="token punctuation">(</span>enhancer<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> <span class="token function">enhancer</span><span class="token punctuation">(</span>createStore<span class="token punctuation">)</span><span class="token punctuation">(</span>reducer<span class="token punctuation">,</span> preloadedState<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
  <span class="token keyword">let</span> state <span class="token operator">=</span> preloadedState<span class="token punctuation">;</span>
  <span class="token keyword">let</span> listeners <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
  <span class="token keyword">function</span> <span class="token function">getState</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> state<span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
  <span class="token keyword">function</span> <span class="token function">subscribe</span><span class="token punctuation">(</span><span class="token parameter">listener</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    listeners<span class="token punctuation">.</span><span class="token function">push</span><span class="token punctuation">(</span>listener<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">return</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token keyword">const</span> index <span class="token operator">=</span> listeners<span class="token punctuation">.</span><span class="token function">indexOf</span><span class="token punctuation">(</span>listener<span class="token punctuation">)</span><span class="token punctuation">;</span>
      listeners<span class="token punctuation">.</span><span class="token function">splice</span><span class="token punctuation">(</span>index<span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
  <span class="token keyword">function</span> <span class="token function">dispatch</span><span class="token punctuation">(</span><span class="token parameter">action</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    state <span class="token operator">=</span> <span class="token function">reducer</span><span class="token punctuation">(</span>state<span class="token punctuation">,</span> action<span class="token punctuation">)</span><span class="token punctuation">;</span>
    listeners<span class="token punctuation">.</span><span class="token function">forEach</span><span class="token punctuation">(</span><span class="token parameter">listener</span> <span class="token operator">=&gt;</span> <span class="token function">listener</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
  <span class="token function">dispatch</span><span class="token punctuation">(</span><span class="token punctuation">{</span> type<span class="token operator">:</span> <span class="token string">'@@redux/INIT'</span> <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token keyword">return</span> <span class="token punctuation">{</span>
    dispatch<span class="token punctuation">,</span>
    subscribe<span class="token punctuation">,</span>
    getState
  <span class="token punctuation">}</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre></div><h3 id="_4-发布订阅模式（publish-subscribe-pattern）"><a href="#_4-发布订阅模式（publish-subscribe-pattern）" class="header-anchor">#</a> 4. 发布订阅模式（Publish/Subscribe Pattern）</h3> <h4 id="区别"><a href="#区别" class="header-anchor">#</a> 区别</h4> <ul><li>订阅者把自己想订阅的事件注册到<strong>调度中心</strong></li> <li>当该事件触发时候，发布者发布该事件到<strong>调度中心</strong>,由<strong>调度中心</strong>统一调度订阅者注册到<strong>调度中心</strong>的处理代码。</li> <li>虽然两种模式都存在订阅者和发布者（<code>观察者可认为是订阅者、被观察者可认为是发布者</code>）</li> <li>但是观察者模式是由被观察者调度的，而发布/订阅模式是统一由<strong>调度中心</strong>管理的</li> <li>所以观察者模式的订阅者与发布者之间是<strong>存在依赖的</strong>，而发布/订阅模式则不会。</li></ul> <p><img src="/blog/assets/img/subscribe-pattern.66c8c327.jpg" alt="subscribe-pattern"></p> <h4 id="类图-2"><a href="#类图-2" class="header-anchor">#</a> 类图</h4> <p><img src="data:image/png;base64,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" alt="publish-subscribe"></p> <h4 id="实现代码-6"><a href="#实现代码-6" class="header-anchor">#</a> 实现代码</h4> <div class="language-ts extra-class"><pre class="language-ts"><code><span class="token keyword">class</span> <span class="token class-name">Agency</span> <span class="token punctuation">{</span>
  _topics <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">;</span>
  <span class="token function">subscribe</span><span class="token punctuation">(</span><span class="token parameter">topic<span class="token punctuation">,</span> listener</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">let</span> listeners <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span>_topics<span class="token punctuation">[</span>topic<span class="token punctuation">]</span><span class="token punctuation">;</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>listeners<span class="token punctuation">)</span> <span class="token punctuation">{</span>
      listeners<span class="token punctuation">.</span><span class="token function">push</span><span class="token punctuation">(</span>listener<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>
      <span class="token keyword">this</span><span class="token punctuation">.</span>_topics<span class="token punctuation">[</span>topic<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token punctuation">[</span>listener<span class="token punctuation">]</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span>
  <span class="token function">publish</span><span class="token punctuation">(</span><span class="token parameter">topic<span class="token punctuation">,</span> <span class="token operator">...</span>args</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">let</span> listeners <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span>_topics<span class="token punctuation">[</span>topic<span class="token punctuation">]</span> <span class="token operator">||</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
    listeners<span class="token punctuation">.</span><span class="token function">forEach</span><span class="token punctuation">(</span><span class="token parameter">listener</span> <span class="token operator">=&gt;</span> <span class="token function">listener</span><span class="token punctuation">(</span><span class="token operator">...</span>args<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
<span class="token keyword">class</span> <span class="token class-name">Landlord</span> <span class="token punctuation">{</span>
  <span class="token keyword">constructor</span><span class="token punctuation">(</span><span class="token parameter"><span class="token keyword">public</span> agent<span class="token operator">:</span> Agency</span><span class="token punctuation">)</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>
  <span class="token function">lend</span><span class="token punctuation">(</span><span class="token parameter">topic<span class="token punctuation">,</span> area<span class="token punctuation">,</span> money</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span>agent<span class="token punctuation">.</span><span class="token function">publish</span><span class="token punctuation">(</span>topic<span class="token punctuation">,</span> area<span class="token punctuation">,</span> money<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token keyword">class</span> <span class="token class-name">Tenant</span> <span class="token punctuation">{</span>
  <span class="token keyword">constructor</span><span class="token punctuation">(</span><span class="token parameter"><span class="token keyword">public</span> agent<span class="token operator">:</span> Agency<span class="token punctuation">,</span> <span class="token keyword">public</span> name<span class="token operator">:</span> <span class="token builtin">string</span></span><span class="token punctuation">)</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>
  <span class="token function">order</span><span class="token punctuation">(</span><span class="token parameter">topic</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span>agent<span class="token punctuation">.</span><span class="token function">subscribe</span><span class="token punctuation">(</span>topic<span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token parameter">area<span class="token punctuation">,</span> money</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
      <span class="token builtin">console</span><span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>name<span class="token punctuation">,</span> <span class="token template-string"><span class="token template-punctuation string">`</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>area<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">平米, </span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>money<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">元</span><span class="token template-punctuation string">`</span></span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
<span class="token keyword">let</span> agent <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Agency</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">let</span> rich <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Tenant</span><span class="token punctuation">(</span>agent<span class="token punctuation">,</span> <span class="token string">'大款'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">let</span> poor <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Tenant</span><span class="token punctuation">(</span>agent<span class="token punctuation">,</span> <span class="token string">'北漂'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">let</span> landlord <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Landlord</span><span class="token punctuation">(</span>agent<span class="token punctuation">)</span><span class="token punctuation">;</span>
rich<span class="token punctuation">.</span><span class="token function">order</span><span class="token punctuation">(</span><span class="token string">'豪宅'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
poor<span class="token punctuation">.</span><span class="token function">order</span><span class="token punctuation">(</span><span class="token string">'单间'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">// 1环豪宅 每平方100万</span>
landlord<span class="token punctuation">.</span><span class="token function">lend</span><span class="token punctuation">(</span><span class="token string">'豪宅'</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">1000000</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">// 5环单间 每个月1000</span>
landlord<span class="token punctuation">.</span><span class="token function">lend</span><span class="token punctuation">(</span><span class="token string">'单间'</span><span class="token punctuation">,</span> <span class="token number">5</span><span class="token punctuation">,</span> <span class="token number">1000</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><h4 id="使用场景-5"><a href="#使用场景-5" class="header-anchor">#</a> 使用场景</h4> <ol><li><code>Redis</code> 发布订阅</li></ol> <p><code>Redis</code> 发布订阅是一种消息通信模式：发送者发送消息，订阅者接收消息，客户端可以订阅任意数量的频道。</p> <p><img src="/blog/assets/img/redis-subscribe.a2633ea6.jpg" alt="redis-subscribe"></p> <div class="language-bash extra-class"><pre class="language-bash"><code>SUBSCRIBE channel_a
PUBLISH channel_a golderbrother
</code></pre></div><h5 id="实现代码-7"><a href="#实现代码-7" class="header-anchor">#</a> 实现代码</h5> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">let</span> redis <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'redis'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">let</span> client1 <span class="token operator">=</span> redis<span class="token punctuation">.</span><span class="token function">createClient</span><span class="token punctuation">(</span><span class="token number">6379</span><span class="token punctuation">,</span> <span class="token string">'127.0.0.1'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">let</span> client2 <span class="token operator">=</span> redis<span class="token punctuation">.</span><span class="token function">createClient</span><span class="token punctuation">(</span><span class="token number">6379</span><span class="token punctuation">,</span> <span class="token string">'127.0.0.1'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

client1<span class="token punctuation">.</span><span class="token function">subscribe</span><span class="token punctuation">(</span><span class="token string">'channel_a'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
client1<span class="token punctuation">.</span><span class="token function">subscribe</span><span class="token punctuation">(</span><span class="token string">'channel_b'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
client1<span class="token punctuation">.</span><span class="token function">on</span><span class="token punctuation">(</span><span class="token string">'message'</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token parameter">channel<span class="token punctuation">,</span> message</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'client1'</span><span class="token punctuation">,</span> channel<span class="token punctuation">,</span> message<span class="token punctuation">)</span><span class="token punctuation">;</span>
  client1<span class="token punctuation">.</span><span class="token function">unsubscribe</span><span class="token punctuation">(</span><span class="token string">'channel_a'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
client2<span class="token punctuation">.</span><span class="token function">publish</span><span class="token punctuation">(</span><span class="token string">'channel_a'</span><span class="token punctuation">,</span> <span class="token string">'a_hello'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
client2<span class="token punctuation">.</span><span class="token function">publish</span><span class="token punctuation">(</span><span class="token string">'channel_b'</span><span class="token punctuation">,</span> <span class="token string">'b_hello'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token function">setTimeout</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  client2<span class="token punctuation">.</span><span class="token function">publish</span><span class="token punctuation">(</span><span class="token string">'channel_a'</span><span class="token punctuation">,</span> <span class="token string">'a_world'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  client2<span class="token punctuation">.</span><span class="token function">publish</span><span class="token punctuation">(</span><span class="token string">'channel_b'</span><span class="token punctuation">,</span> <span class="token string">'b_world'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token number">3000</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><h3 id="_5-中介者模式（mediator-pattern）"><a href="#_5-中介者模式（mediator-pattern）" class="header-anchor">#</a> 5. 中介者模式（Mediator Pattern）</h3> <p><img src="/blog/assets/img/mediator-pattern.c4beae48.jpg" alt="mediator-pattern"></p> <p>在中介者模式中，中介者（Mediator）包装了一系列对象相互作用的方式，使得这些对象不必直接相互作用，而是由中介者协调它们之间的交互，从而使它们可以松散偶合。当某些对象之间的作用发生改变时，不会立即影响其他的一些对象之间的作用，保证这些作用可以彼此独立的变化。</p> <p>中介者模式和观察者模式有一定的相似性，都是一对多的关系，也都是集中式通信，不同的是中介者模式是处理同级对象之间的交互，而观察者模式是处理 Observer 和 Subject 之间(<strong>不同级</strong>)的交互。中介者模式有些像婚恋中介，相亲对象刚开始并不能直接交流，而是要通过中介去筛选匹配再决定谁和谁见面。中介者模式比较常见的应用比如聊天室，聊天室里面的人之间并不能直接对话，而是通过聊天室这一媒介进行转发。一个简易的聊天室模型可以实现如下：</p> <p>聊天室成员类：</p> <div class="language-ts extra-class"><pre class="language-ts"><code>
<span class="token keyword">class</span> <span class="token class-name">Member</span> <span class="token punctuation">{</span>
  name<span class="token operator">:</span> <span class="token builtin">string</span><span class="token punctuation">;</span>
  chatroom<span class="token operator">:</span> Chatroom<span class="token punctuation">;</span>
  <span class="token keyword">constructor</span><span class="token punctuation">(</span><span class="token parameter">name<span class="token operator">:</span> <span class="token builtin">string</span></span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span>name <span class="token operator">=</span> name<span class="token punctuation">;</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span>chatroom <span class="token operator">=</span> <span class="token keyword">null</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
  <span class="token comment">// 发送消息</span>
  <span class="token function">send</span><span class="token punctuation">(</span><span class="token parameter">message<span class="token operator">:</span> <span class="token builtin">string</span><span class="token punctuation">,</span> toMember<span class="token operator">:</span> Member</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span>chatroom<span class="token punctuation">.</span><span class="token function">send</span><span class="token punctuation">(</span>message<span class="token punctuation">,</span> <span class="token keyword">this</span><span class="token punctuation">,</span> toMember<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
  <span class="token comment">// 接收消息</span>
  <span class="token function">receive</span><span class="token punctuation">(</span><span class="token parameter">message<span class="token operator">:</span> <span class="token builtin">string</span><span class="token punctuation">,</span> fromMember<span class="token operator">:</span> Member</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token builtin">console</span><span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token template-string"><span class="token template-punctuation string">`</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>fromMember<span class="token punctuation">.</span>name<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string"> to </span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span><span class="token keyword">this</span><span class="token punctuation">.</span>name<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">: </span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>message<span class="token interpolation-punctuation punctuation">}</span></span><span class="token template-punctuation string">`</span></span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><p>聊天室类：</p> <div class="language-ts extra-class"><pre class="language-ts"><code>
<span class="token keyword">class</span> <span class="token class-name">Chatroom</span> <span class="token punctuation">{</span>
  <span class="token keyword">public</span> members<span class="token operator">:</span> <span class="token builtin">any</span><span class="token punctuation">;</span>
  <span class="token keyword">constructor</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span>members <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
  <span class="token comment">// 增加成员</span>
  <span class="token function">addMember</span><span class="token punctuation">(</span>member<span class="token operator">:</span> Member<span class="token punctuation">)</span><span class="token operator">:</span> <span class="token keyword">void</span> <span class="token punctuation">{</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span>members<span class="token punctuation">[</span>member<span class="token punctuation">.</span>name<span class="token punctuation">]</span> <span class="token operator">=</span> member<span class="token punctuation">;</span>
    member<span class="token punctuation">.</span>chatroom <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
  <span class="token comment">// 发送消息</span>
  <span class="token function">send</span><span class="token punctuation">(</span>message<span class="token operator">:</span> <span class="token builtin">string</span><span class="token punctuation">,</span> fromMember<span class="token operator">:</span> Member<span class="token punctuation">,</span> toMember<span class="token operator">:</span> Member<span class="token punctuation">)</span><span class="token operator">:</span> <span class="token keyword">void</span> <span class="token punctuation">{</span>
    toMember<span class="token punctuation">.</span><span class="token function">receive</span><span class="token punctuation">(</span>message<span class="token punctuation">,</span> fromMember<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><p>测试一下：</p> <div class="language-ts extra-class"><pre class="language-ts"><code><span class="token keyword">const</span> chatroom<span class="token operator">:</span> Chatroom <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Chatroom</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> bruce<span class="token operator">:</span> Member <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Member</span><span class="token punctuation">(</span><span class="token string">'bruce'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> frank<span class="token operator">:</span> Member <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Member</span><span class="token punctuation">(</span><span class="token string">'frank'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

chatroom<span class="token punctuation">.</span><span class="token function">addMember</span><span class="token punctuation">(</span>bruce<span class="token punctuation">)</span><span class="token punctuation">;</span>
chatroom<span class="token punctuation">.</span><span class="token function">addMember</span><span class="token punctuation">(</span>frank<span class="token punctuation">)</span><span class="token punctuation">;</span>

bruce<span class="token punctuation">.</span><span class="token function">send</span><span class="token punctuation">(</span><span class="token string">'Hey frank'</span><span class="token punctuation">,</span> frank<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><p>输出：</p> <div class="language- extra-class"><pre class="language-text"><code>bruce to frank: Hey frank
</code></pre></div><p>这只是一个最简单的聊天室模型，真正的聊天室还可以加入更多的功能，比如敏感信息拦截、一对多聊天、广播等。得益于中介者模式，Member 不需要处理和聊天相关的复杂逻辑，而是全部交给 Chatroom，有效的实现了关注分离。</p> <h2 id="最后"><a href="#最后" class="header-anchor">#</a> 最后</h2> <p>文中若有不准确或错误的地方，欢迎指出，有兴趣可以的关注下<a href="https://github.com/GolderBrother" target="_blank" rel="noopener noreferrer">Github<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a>~</p> <div class="gitalk-container"><div id="gitalk-container"></div></div></div> <footer class="page-edit"><!----> <div class="last-updated"><span class="prefix">Last Updated:</span> <span class="time">2020/9/7 下午8:45:37</span></div></footer> <div class="page-nav"><p class="inner"><span class="prev">
      ←
      <a href="/blog/views/node/node1.html" class="prev">/views/node/node1.html</a></span> <span class="next"><a href="/blog/views/data-structure/data-structure.html">前端数据结构之美</a>
      →
    </span></p></div> </main></div><div class="global-ui"><!----></div></div>
    <script src="/blog/assets/js/app.74817549.js" defer></script><script src="/blog/assets/js/2.f761193d.js" defer></script><script src="/blog/assets/js/4.bb581d32.js" defer></script><script src="/blog/assets/js/23.dbb39e0a.js" defer></script>
  </body>
</html>
