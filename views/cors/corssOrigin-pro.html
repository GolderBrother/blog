<!DOCTYPE html>
<html lang="zh-CN">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width,initial-scale=1" />
    <!-- 为了可以访问第三方图床的图片，才添加了这句代码，如果你的图片是存在本地的，去掉这句代码即可 -->
    <meta id="referrer" name="referrer" content="never" />
    <!-- <meta id="referrer" name="referrer" content="always" /> -->
    <title>10 种跨域解决方案（附终极方案） | 全栈修炼</title>
    <meta name="description" content="GolderBrother的博客" />
    <link rel="icon" href="/blog/assets/favicon.ico">  <link rel="preload" href="/blog/assets/css/0.styles.2dde6c16.css" as="style"><link rel="preload" href="/blog/assets/js/app.74817549.js" as="script"><link rel="preload" href="/blog/assets/js/2.f761193d.js" as="script"><link rel="preload" href="/blog/assets/js/6.4efa9fa4.js" as="script"><link rel="preload" href="/blog/assets/js/23.dbb39e0a.js" as="script"><link rel="prefetch" href="/blog/assets/js/10.ea66aff3.js"><link rel="prefetch" href="/blog/assets/js/100.1650309e.js"><link rel="prefetch" href="/blog/assets/js/101.dd5cdc51.js"><link rel="prefetch" href="/blog/assets/js/102.81a755d8.js"><link rel="prefetch" href="/blog/assets/js/103.84d1e041.js"><link rel="prefetch" href="/blog/assets/js/104.6bb79eda.js"><link rel="prefetch" href="/blog/assets/js/105.ac0fa491.js"><link rel="prefetch" href="/blog/assets/js/106.e7f21162.js"><link rel="prefetch" href="/blog/assets/js/107.a932b9dd.js"><link rel="prefetch" href="/blog/assets/js/108.08337848.js"><link rel="prefetch" href="/blog/assets/js/109.0a8ac1ac.js"><link rel="prefetch" href="/blog/assets/js/11.2b17f742.js"><link rel="prefetch" href="/blog/assets/js/110.63f713ce.js"><link rel="prefetch" href="/blog/assets/js/111.3ded28af.js"><link rel="prefetch" href="/blog/assets/js/112.feb77183.js"><link rel="prefetch" href="/blog/assets/js/113.ca7a3dfe.js"><link rel="prefetch" href="/blog/assets/js/114.278aaabb.js"><link rel="prefetch" href="/blog/assets/js/115.3f930fa5.js"><link rel="prefetch" href="/blog/assets/js/116.0686a02f.js"><link rel="prefetch" href="/blog/assets/js/117.22090497.js"><link rel="prefetch" href="/blog/assets/js/118.d7f089fa.js"><link rel="prefetch" href="/blog/assets/js/119.3c8db627.js"><link rel="prefetch" href="/blog/assets/js/12.d4feb8d0.js"><link rel="prefetch" href="/blog/assets/js/120.e516c49a.js"><link rel="prefetch" href="/blog/assets/js/121.d702cc4d.js"><link rel="prefetch" href="/blog/assets/js/122.13d4f773.js"><link rel="prefetch" href="/blog/assets/js/123.6905c46b.js"><link rel="prefetch" href="/blog/assets/js/124.ccac9465.js"><link rel="prefetch" href="/blog/assets/js/125.3fad187d.js"><link rel="prefetch" href="/blog/assets/js/126.065c2aad.js"><link rel="prefetch" href="/blog/assets/js/127.d4aef2ae.js"><link rel="prefetch" href="/blog/assets/js/128.00766f11.js"><link rel="prefetch" href="/blog/assets/js/129.51d245ca.js"><link rel="prefetch" href="/blog/assets/js/13.21c8139a.js"><link rel="prefetch" href="/blog/assets/js/130.82b8009d.js"><link rel="prefetch" href="/blog/assets/js/131.fb8da159.js"><link rel="prefetch" href="/blog/assets/js/132.2484fde1.js"><link rel="prefetch" href="/blog/assets/js/133.177fe1b1.js"><link rel="prefetch" href="/blog/assets/js/134.5611fa2b.js"><link rel="prefetch" href="/blog/assets/js/135.4d1053c3.js"><link rel="prefetch" href="/blog/assets/js/136.2973975f.js"><link rel="prefetch" href="/blog/assets/js/137.7c44ba09.js"><link rel="prefetch" href="/blog/assets/js/138.16973a68.js"><link rel="prefetch" href="/blog/assets/js/139.2f797054.js"><link rel="prefetch" href="/blog/assets/js/14.8cf70ab3.js"><link rel="prefetch" href="/blog/assets/js/140.f94ba770.js"><link rel="prefetch" href="/blog/assets/js/141.69f9800f.js"><link rel="prefetch" href="/blog/assets/js/142.b567c447.js"><link rel="prefetch" href="/blog/assets/js/143.f1ee0ada.js"><link rel="prefetch" href="/blog/assets/js/144.138163b4.js"><link rel="prefetch" href="/blog/assets/js/145.e3bee357.js"><link rel="prefetch" href="/blog/assets/js/146.3a9fd8c7.js"><link rel="prefetch" href="/blog/assets/js/147.0b8e88a6.js"><link rel="prefetch" href="/blog/assets/js/148.81da2cf3.js"><link rel="prefetch" href="/blog/assets/js/149.d44d0121.js"><link rel="prefetch" href="/blog/assets/js/15.ea38d450.js"><link rel="prefetch" href="/blog/assets/js/150.7665d423.js"><link rel="prefetch" href="/blog/assets/js/151.1ab5f781.js"><link rel="prefetch" href="/blog/assets/js/152.620db4ac.js"><link rel="prefetch" href="/blog/assets/js/153.695d756f.js"><link rel="prefetch" href="/blog/assets/js/154.ee82e0a2.js"><link rel="prefetch" href="/blog/assets/js/155.d7bc8987.js"><link rel="prefetch" href="/blog/assets/js/156.95cf0d01.js"><link rel="prefetch" href="/blog/assets/js/157.76159f7e.js"><link rel="prefetch" href="/blog/assets/js/158.e27d7f12.js"><link rel="prefetch" href="/blog/assets/js/159.84d58dcb.js"><link rel="prefetch" href="/blog/assets/js/16.7794197c.js"><link rel="prefetch" href="/blog/assets/js/160.44f17ac0.js"><link rel="prefetch" href="/blog/assets/js/161.a9fc1420.js"><link rel="prefetch" href="/blog/assets/js/162.953ffb8f.js"><link rel="prefetch" href="/blog/assets/js/163.d4b64d04.js"><link rel="prefetch" href="/blog/assets/js/164.d718bdc2.js"><link rel="prefetch" href="/blog/assets/js/165.464562ce.js"><link rel="prefetch" href="/blog/assets/js/166.3486924a.js"><link rel="prefetch" href="/blog/assets/js/167.044ce06a.js"><link rel="prefetch" href="/blog/assets/js/168.81e22c48.js"><link rel="prefetch" href="/blog/assets/js/169.4c4a576c.js"><link rel="prefetch" href="/blog/assets/js/17.7083b50c.js"><link rel="prefetch" href="/blog/assets/js/170.4b71dfab.js"><link rel="prefetch" href="/blog/assets/js/171.d2051e87.js"><link rel="prefetch" href="/blog/assets/js/172.eeb81923.js"><link rel="prefetch" href="/blog/assets/js/173.aafb24fa.js"><link rel="prefetch" href="/blog/assets/js/174.2e261a79.js"><link rel="prefetch" href="/blog/assets/js/175.aafd75a2.js"><link rel="prefetch" href="/blog/assets/js/176.b7681070.js"><link rel="prefetch" href="/blog/assets/js/177.e9bdb5f5.js"><link rel="prefetch" href="/blog/assets/js/178.4a3ca305.js"><link rel="prefetch" href="/blog/assets/js/179.40201a86.js"><link rel="prefetch" href="/blog/assets/js/18.3dbb7741.js"><link rel="prefetch" href="/blog/assets/js/180.68c6346e.js"><link rel="prefetch" href="/blog/assets/js/181.326c1f42.js"><link rel="prefetch" href="/blog/assets/js/182.92780c32.js"><link rel="prefetch" href="/blog/assets/js/183.65f40b5a.js"><link rel="prefetch" href="/blog/assets/js/19.78fd69da.js"><link rel="prefetch" href="/blog/assets/js/20.be39648e.js"><link rel="prefetch" href="/blog/assets/js/21.80a318b4.js"><link rel="prefetch" href="/blog/assets/js/22.4040efb3.js"><link rel="prefetch" href="/blog/assets/js/24.f27f8467.js"><link rel="prefetch" href="/blog/assets/js/25.448302be.js"><link rel="prefetch" href="/blog/assets/js/26.78106ffa.js"><link rel="prefetch" href="/blog/assets/js/27.2a65554d.js"><link rel="prefetch" href="/blog/assets/js/28.55501022.js"><link rel="prefetch" href="/blog/assets/js/29.af733838.js"><link rel="prefetch" href="/blog/assets/js/3.df759ff3.js"><link rel="prefetch" href="/blog/assets/js/30.8ce1d72b.js"><link rel="prefetch" href="/blog/assets/js/31.7925ec43.js"><link rel="prefetch" href="/blog/assets/js/32.f9892d98.js"><link rel="prefetch" href="/blog/assets/js/33.afd7fd02.js"><link rel="prefetch" href="/blog/assets/js/34.ee49fe13.js"><link rel="prefetch" href="/blog/assets/js/35.0e4f5335.js"><link rel="prefetch" href="/blog/assets/js/36.96311e99.js"><link rel="prefetch" href="/blog/assets/js/37.fb3163b1.js"><link rel="prefetch" href="/blog/assets/js/38.778ed95b.js"><link rel="prefetch" href="/blog/assets/js/39.0531a2e1.js"><link rel="prefetch" href="/blog/assets/js/4.bb581d32.js"><link rel="prefetch" href="/blog/assets/js/40.ec9153c6.js"><link rel="prefetch" href="/blog/assets/js/41.2e9e71db.js"><link rel="prefetch" href="/blog/assets/js/42.af718b8a.js"><link rel="prefetch" href="/blog/assets/js/43.7a4efaa6.js"><link rel="prefetch" href="/blog/assets/js/44.21916db9.js"><link rel="prefetch" href="/blog/assets/js/45.c02e6427.js"><link rel="prefetch" href="/blog/assets/js/46.c95ab531.js"><link rel="prefetch" href="/blog/assets/js/47.d505fc9f.js"><link rel="prefetch" href="/blog/assets/js/48.9291572a.js"><link rel="prefetch" href="/blog/assets/js/49.79fd5fda.js"><link rel="prefetch" href="/blog/assets/js/5.cc289552.js"><link rel="prefetch" href="/blog/assets/js/50.40ff6888.js"><link rel="prefetch" href="/blog/assets/js/51.d16aa2b4.js"><link rel="prefetch" href="/blog/assets/js/52.4528f49d.js"><link rel="prefetch" href="/blog/assets/js/53.b16b42d4.js"><link rel="prefetch" href="/blog/assets/js/54.4fff7e01.js"><link rel="prefetch" href="/blog/assets/js/55.6832b1c5.js"><link rel="prefetch" href="/blog/assets/js/56.d16f1707.js"><link rel="prefetch" href="/blog/assets/js/57.de08e9ba.js"><link rel="prefetch" href="/blog/assets/js/58.6ca6f21b.js"><link rel="prefetch" href="/blog/assets/js/59.e518317a.js"><link rel="prefetch" href="/blog/assets/js/60.935521f1.js"><link rel="prefetch" href="/blog/assets/js/61.ce9eda13.js"><link rel="prefetch" href="/blog/assets/js/62.e6c745bf.js"><link rel="prefetch" href="/blog/assets/js/63.647fd8d7.js"><link rel="prefetch" href="/blog/assets/js/64.4c9b4781.js"><link rel="prefetch" href="/blog/assets/js/65.80857907.js"><link rel="prefetch" href="/blog/assets/js/66.b89b796a.js"><link rel="prefetch" href="/blog/assets/js/67.b9798c32.js"><link rel="prefetch" href="/blog/assets/js/68.49b67f24.js"><link rel="prefetch" href="/blog/assets/js/69.665837ff.js"><link rel="prefetch" href="/blog/assets/js/7.b94332e9.js"><link rel="prefetch" href="/blog/assets/js/70.ce57ed8e.js"><link rel="prefetch" href="/blog/assets/js/71.71ae5067.js"><link rel="prefetch" href="/blog/assets/js/72.69c7c32d.js"><link rel="prefetch" href="/blog/assets/js/73.6b47b8f7.js"><link rel="prefetch" href="/blog/assets/js/74.bd6cd299.js"><link rel="prefetch" href="/blog/assets/js/75.297a83bc.js"><link rel="prefetch" href="/blog/assets/js/76.e49268ee.js"><link rel="prefetch" href="/blog/assets/js/77.6efa828f.js"><link rel="prefetch" href="/blog/assets/js/78.c38cb032.js"><link rel="prefetch" href="/blog/assets/js/79.478e1642.js"><link rel="prefetch" href="/blog/assets/js/8.80c6038b.js"><link rel="prefetch" href="/blog/assets/js/80.ff9e57e9.js"><link rel="prefetch" href="/blog/assets/js/81.e3dbf4d0.js"><link rel="prefetch" href="/blog/assets/js/82.270df640.js"><link rel="prefetch" href="/blog/assets/js/83.3bc7036f.js"><link rel="prefetch" href="/blog/assets/js/84.a3ccc99e.js"><link rel="prefetch" href="/blog/assets/js/85.7cdab723.js"><link rel="prefetch" href="/blog/assets/js/86.9f0c2ccd.js"><link rel="prefetch" href="/blog/assets/js/87.b7e93260.js"><link rel="prefetch" href="/blog/assets/js/88.557a99bb.js"><link rel="prefetch" href="/blog/assets/js/89.16a0d8d1.js"><link rel="prefetch" href="/blog/assets/js/9.4fbaf7a8.js"><link rel="prefetch" href="/blog/assets/js/90.52190781.js"><link rel="prefetch" href="/blog/assets/js/91.b9507740.js"><link rel="prefetch" href="/blog/assets/js/92.c0eb92c0.js"><link rel="prefetch" href="/blog/assets/js/93.ca3ba1d1.js"><link rel="prefetch" href="/blog/assets/js/94.a8ffcee7.js"><link rel="prefetch" href="/blog/assets/js/95.23fe688e.js"><link rel="prefetch" href="/blog/assets/js/96.b5d64bc6.js"><link rel="prefetch" href="/blog/assets/js/97.c41d4d64.js"><link rel="prefetch" href="/blog/assets/js/98.c415501d.js"><link rel="prefetch" href="/blog/assets/js/99.ab069b22.js"> <link rel="stylesheet" href="/blog/assets/css/0.styles.2dde6c16.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/blog/" class="home-link router-link-active"><img src="/blog/assets/logo.jpg" alt="全栈修炼" class="logo"> <span class="site-name can-hide">全栈修炼</span></a> <div class="links"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><a href="/blog/" class="nav-link">首页</a></div><div class="nav-item"><a href="/blog/guide/" class="nav-link">主页</a></div><div class="nav-item"><a href="/blog/views/" class="nav-link router-link-active">大前端</a></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="Select language" class="dropdown-title"><span class="title">Languages</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/blog/views/cors/corssOrigin-pro.html" class="nav-link router-link-exact-active router-link-active">zh-CN</a></li><li class="dropdown-item"><!----> <a href="/blog/en/" class="nav-link">en-US</a></li></ul></div></div> <a href="https://github.com/GolderBrother/blog" target="_blank" rel="noopener noreferrer" class="repo-link">
    GitHub
    <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></nav></div></header> <div class="sidebar-mask"></div> <aside class="sidebar"><nav class="nav-links"><div class="nav-item"><a href="/blog/" class="nav-link">首页</a></div><div class="nav-item"><a href="/blog/guide/" class="nav-link">主页</a></div><div class="nav-item"><a href="/blog/views/" class="nav-link router-link-active">大前端</a></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="Select language" class="dropdown-title"><span class="title">Languages</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/blog/views/cors/corssOrigin-pro.html" class="nav-link router-link-exact-active router-link-active">zh-CN</a></li><li class="dropdown-item"><!----> <a href="/blog/en/" class="nav-link">en-US</a></li></ul></div></div> <a href="https://github.com/GolderBrother/blog" target="_blank" rel="noopener noreferrer" class="repo-link">
    GitHub
    <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></nav>  <ul class="sidebar-links"><li><a href="/blog/views/" class="sidebar-link">大前端知识大集合</a></li><li><section class="sidebar-group depth-0"><p class="sidebar-heading"><span>GitHub 软技能</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/blog/views/github/follow.html" class="sidebar-link">GitHub 挖宝技巧</a></li><li><a href="/blog/views/github/star.html" class="sidebar-link">GitHub 吸星大法</a></li></ul></section></li><li><section class="sidebar-group depth-0"><p class="sidebar-heading"><span>浏览器工作原理</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/blog/views/browser/input-url-course.html" class="sidebar-link">导航流程：从输入 URL 到页面展示，这中间发生了什么</a></li><li><a href="/blog/views/browser/dom-bind-event.html" class="sidebar-link">一个DOM元素绑定多个事件时，先执行冒泡还是捕获</a></li></ul></section></li><li><section class="sidebar-group depth-0"><p class="sidebar-heading"><span>css</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/blog/views/css/css-skills1.html" class="sidebar-link">10 个让你受益匪浅的 css 使用技巧</a></li><li><a href="/blog/views/css/css-knowledge.html" class="sidebar-link">你未必知道的 49 个 CSS 知识点</a></li><li><a href="/blog/views/css/css-knowledge2.html" class="sidebar-link">你未必知道的 49 个 CSS 知识点二~</a></li><li><a href="/blog/views/css/css-center.html" class="sidebar-link">一起搞懂 CSS 水平居中与垂直居中的 16 个方法</a></li><li><a href="/blog/views/css/css-flex.html" class="sidebar-link">弹性盒子中 flex: 0 1 auto 表示什么意思</a></li><li><a href="/blog/views/css/css-BFC.html" class="sidebar-link">CSS 中的 BFC 详解</a></li></ul></section></li><li><section class="sidebar-group depth-0"><p class="sidebar-heading"><span>移动端h5</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/blog/views/h5/h5-demo1.html" class="sidebar-link">移动端 H5 和 Hybrid 相关基础技术概览</a></li><li><a href="/blog/views/mobile/mobile-skill.html" class="sidebar-link">总结移动端 H5 开发常用技巧</a></li><li><a href="/blog/views/mobile/mobile-optmization.html" class="sidebar-link">关于移动端体验优化经验总结</a></li></ul></section></li><li><section class="sidebar-group depth-0"><p class="sidebar-heading"><span>Javascript</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/blog/views/javascript/js-skills.html" class="sidebar-link">你可能不知道的 JS 开发技巧</a></li><li><a href="/blog/views/javascript/js-skills2.html" class="sidebar-link">一个合格的中级前端er需要掌握的 28 个 JavaScript 技巧</a></li><li><a href="/blog/views/javascript/js-utils.html" class="sidebar-link">书到用时方恨少，一大波 JS 开发工具函数来了</a></li><li><a href="/blog/views/javascript/js-utils2.html" class="sidebar-link">前端常用的 60 余种工具方法</a></li></ul></section></li><li><section class="sidebar-group depth-0"><p class="sidebar-heading"><span>Typescript</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/blog/views/typescript/ts-demo.html" class="sidebar-link">TypeScript 高级用法详解</a></li><li><a href="/blog/views/typescript/ts-difficult.html" class="sidebar-link">TypeScript 重难点梳理</a></li><li><a href="/blog/views/typescript/ts-problem.html" class="sidebar-link">TS 常见问题整理（60 多个）</a></li></ul></section></li><li><section class="sidebar-group depth-0"><p class="sidebar-heading"><span>Vue.js</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/blog/views/vue/vue-ts.html" class="sidebar-link">Vue + TS + El 搭建博客及踩坑记</a></li><li><a href="/blog/views/vue/vue-lazyload.html" class="sidebar-link">vue 路由懒加载及组件懒加载</a></li><li><a href="/blog/views/vue/vue-skills-36.html" class="sidebar-link">Vue 开发必须知道的 36 个技巧</a></li><li><a href="/blog/views/vue/vue-interview.html" class="sidebar-link">30 道 Vue 面试题，内含详细讲解（涵盖入门到精通，自测 Vue 掌握程度）</a></li><li><a href="/blog/views/vue/vue-interview/part-one/note.html" class="sidebar-link">Vue 面试题汇总</a></li></ul></section></li><li><section class="sidebar-group depth-0"><p class="sidebar-heading"><span>React.js</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/blog/views/react/react-hooks.html" class="sidebar-link">React Hooks 相关 API 总结</a></li><li><a href="/blog/views/react/react-lifecycle.html" class="sidebar-link">React v16.0 前的生命周期</a></li><li><a href="/blog/views/react/react-skill.html" class="sidebar-link">5 个技巧助你编写更好的 React 代码</a></li><li><a href="/blog/views/react/react-nice-library.html" class="sidebar-link">5 个很棒的 React.js 库，值得你亲手试试！</a></li><li><a href="/blog/views/react/react-interview.html" class="sidebar-link">35 道咱们必须要清楚的 React 面试题</a></li></ul></section></li><li><section class="sidebar-group depth-0"><p class="sidebar-heading"><span>React-Native</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/blog/views/react-native/RN&amp;Native-message.html" class="sidebar-link">React Native 跟原生之间的通信</a></li><li><a href="/blog/views/react-native/ReactNative&amp;Flutter&amp;uni-app.html" class="sidebar-link">一、技术学习成本和难度</a></li><li><a href="/blog/views/react-native/ReactNative&amp;Flutter&amp;uni-app.html" class="sidebar-link">一、技术学习成本和难度</a></li><li><a href="/blog/views/react-native/codepush-config.html" class="sidebar-link">RN 配置热更新+使用文档</a></li><li><a href="/blog/views/react-native/codepush-deploy.html" class="sidebar-link">React Native + 热更新(Code Push) 部署文档</a></li></ul></section></li><li><section class="sidebar-group depth-0"><p class="sidebar-heading"><span>webpack</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/blog/views/webpack/webpack1.html" class="sidebar-link">一大波 Webpack 面试题来啦~</a></li><li><a href="/blog/views/webpack/webpack-optimize.html" class="sidebar-link">webpack 优化篇</a></li></ul></section></li><li><section class="sidebar-group depth-0"><p class="sidebar-heading open"><span>前端跨域相关</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/blog/views/cors/corssOrigin-pro.html" class="active sidebar-link">10 种跨域解决方案（附终极方案）</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/blog/views/cors/corssOrigin-pro.html#一、跨域是什么？" class="sidebar-link">一、跨域是什么？</a></li><li class="sidebar-sub-header"><a href="/blog/views/cors/corssOrigin-pro.html#二、如何解决跨域？" class="sidebar-link">二、如何解决跨域？</a></li><li class="sidebar-sub-header"><a href="/blog/views/cors/corssOrigin-pro.html#三、为什么需要跨域？" class="sidebar-link">三、为什么需要跨域？</a></li><li class="sidebar-sub-header"><a href="/blog/views/cors/corssOrigin-pro.html#写在最后" class="sidebar-link">写在最后</a></li><li class="sidebar-sub-header"><a href="/blog/views/cors/corssOrigin-pro.html#参考资料" class="sidebar-link">参考资料</a></li><li class="sidebar-sub-header"><a href="/blog/views/cors/corssOrigin-pro.html#最后" class="sidebar-link">最后</a></li></ul></li></ul></section></li><li><section class="sidebar-group depth-0"><p class="sidebar-heading"><span>vite</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/blog/views/vite/vite-study.html" class="sidebar-link">vite原理剖析</a></li></ul></section></li><li><section class="sidebar-group depth-0"><p class="sidebar-heading"><span>cli</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/blog/views/cli/james-cli.html" class="sidebar-link">手撸一个自己的前端脚手架</a></li></ul></section></li><li><section class="sidebar-group depth-0"><p class="sidebar-heading"><span>Node.js</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/blog/views/node/node1.html" class="sidebar-link">/views/node/node1.html</a></li></ul></section></li><li><section class="sidebar-group depth-0"><p class="sidebar-heading"><span>前端设计模式之美</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/blog/views/fe-design/fe-design-9.html" class="sidebar-link">前端应知应会的 9 种设计模式(详细篇)</a></li></ul></section></li><li><section class="sidebar-group depth-0"><p class="sidebar-heading"><span>前端数据结构之美</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/blog/views/data-structure/data-structure.html" class="sidebar-link">前端数据结构之美</a></li></ul></section></li><li><section class="sidebar-group depth-0"><p class="sidebar-heading"><span>前端算法学习指南</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/blog/views/algorithms/sort.html" class="sidebar-link">十大经典算法</a></li><li><a href="/blog/views/algorithms/interview.html" class="sidebar-link">面试必刷-《剑指 offer》刷题小结</a></li><li><a href="/blog/views/algorithms/string.html" class="sidebar-link">字符串相关算法</a></li><li><a href="/blog/views/algorithms/array.html" class="sidebar-link">数组串相关算法</a></li><li><a href="/blog/views/algorithms/linklist.html" class="sidebar-link">链表相关算法题</a></li><li><a href="/blog/views/algorithms/tree.html" class="sidebar-link">二叉树相关算法</a></li><li><a href="/blog/views/algorithms/tencent/array&amp;string.html" class="sidebar-link">腾讯算法题-数组与字符串</a></li><li><a href="/blog/views/algorithms/tencent/number.html" class="sidebar-link">腾讯算法题-数学与数字</a></li></ul></section></li><li><section class="sidebar-group depth-0"><p class="sidebar-heading"><span>前端面试集锦</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/blog/views/fe-interview/alibaba.html" class="sidebar-link">阿里面试题</a></li><li><a href="/blog/views/fe-interview/bytedance.html" class="sidebar-link">字节跳动面试题</a></li><li><a href="/blog/views/fe-interview/bytedance-algorithms.html" class="sidebar-link">字节跳动算法题</a></li><li><a href="/blog/views/fe-interview/tencent.html" class="sidebar-link">微信面试题</a></li><li><a href="/blog/views/fe-interview/classic-layout.html" class="sidebar-link">掌握两大经典布局方案</a></li><li><a href="/blog/views/fe-interview/web-safe.html" class="sidebar-link">谈谈 web 安全问题及解决方案</a></li><li><a href="/blog/views/fe-interview/http&amp;https.html" class="sidebar-link">http2/http3 协议有什么优劣</a></li><li><a href="/blog/views/fe-interview/webpack-performance-optimization.html" class="sidebar-link">Webpack 性能优化你知道哪些</a></li><li><a href="/blog/views/fe-interview/webpack-principle.html" class="sidebar-link">说说 webpack 打包的原理</a></li><li><a href="/blog/views/fe-interview/webpack-HMR.html" class="sidebar-link">HMR 的原理是什么</a></li><li><a href="/blog/views/fe-interview/chrome-start-process.html" class="sidebar-link">Chrome 打开一个页面需要启动多少进程？分别有哪些进程</a></li><li><a href="/blog/views/fe-interview/dns-prefetch.html" class="sidebar-link">谈谈你对 dns-prefetch 的理解</a></li><li><a href="/blog/views/fe-interview/browser-cache.html" class="sidebar-link">浏览器缓存一探究竟~</a></li><li><a href="/blog/views/fe-interview/send-content-to-browser.html" class="sidebar-link">如何保证页面文件能被完整送达浏览器</a></li><li><a href="/blog/views/fe-interview/browser-render.html" class="sidebar-link">浏览器渲染过程是怎样的</a></li><li><a href="/blog/views/fe-interview/browser-reflow&amp;repain.html" class="sidebar-link">如何理解回流和重绘</a></li><li><a href="/blog/views/fe-interview/renderEngine-createNewLayer.html" class="sidebar-link">渲染引擎什么情况下才会为特定的节点创建新的图层</a></li><li><a href="/blog/views/fe-interview/UDP&amp;TCP-different.html" class="sidebar-link">UDP 和 TCP 有什么区别</a></li><li><a href="/blog/views/fe-interview/js-modules.html" class="sidebar-link">说说 js 的模块化</a></li><li><a href="/blog/views/fe-interview/lazyMan.html" class="sidebar-link">实现一个 LazyMan，可以按照以下方式调用</a></li><li><a href="/blog/views/fe-interview/handwriting-promise.html" class="sidebar-link">少年，来，手写一个 Promise 吧</a></li><li><a href="/blog/views/fe-interview/fetch&amp;ajax-diference.html" class="sidebar-link">请说下 fetch 和 ajax 的区别吧</a></li><li><a href="/blog/views/fe-interview/browser-input-url.html" class="sidebar-link">细说浏览器输入 URL 后发生了什么</a></li><li><a href="/blog/views/fe-interview/picture-optimization.html" class="sidebar-link">前端的图片优化方案你知道多少</a></li><li><a href="/blog/views/fe-interview/node-eventLoop.html" class="sidebar-link">来，说说 node 的事件循环机制吧</a></li><li><a href="/blog/views/fe-interview/browser-eventLoop.html" class="sidebar-link">小伙子，谈谈浏览器端的事件循环吧</a></li><li><a href="/blog/views/fe-interview/setTimeout&amp;setImmediate.html" class="sidebar-link">node中的setTimeout 和 setImmediate有什么区别</a></li><li><a href="/blog/views/fe-interview/js-interview.html" class="sidebar-link">收集一些 javascript 相关的面试题</a></li><li><a href="/blog/views/fe-interview/fuck-interview.html" class="sidebar-link">那些恶心的面试题</a></li></ul></section></li><li><section class="sidebar-group depth-0"><p class="sidebar-heading"><span>前端必知必会的网络基础</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/blog/views/network/http-interview.html" class="sidebar-link">HTTP 灵魂之问，巩固你的 HTTP 知识体系</a></li><li><a href="/blog/views/network/tcp-interview.html" class="sidebar-link">TCP 协议灵魂之问，巩固你的网络底层基础</a></li></ul></section></li><li><section class="sidebar-group depth-0"><p class="sidebar-heading"><span>前端应知应会的Nginx知识</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/blog/views/nginx/nginx-details.html" class="sidebar-link">Nginx 从入门到实践，万字详解！</a></li></ul></section></li><li><section class="sidebar-group depth-0"><p class="sidebar-heading"><span>前端必不可少的git知识</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/blog/views/git/git-command-animation.html" class="sidebar-link">相见恨晚的 Git 命令动画演示，一看就懂！</a></li></ul></section></li><li><section class="sidebar-group depth-0"><p class="sidebar-heading"><span>前端性能优化专题，让你的网站飞起来吧</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/blog/views/performance/code-split.html" class="sidebar-link">项目不知道如何做性能优化？不妨试试代码分割吧</a></li></ul></section></li><li><section class="sidebar-group depth-0"><p class="sidebar-heading"><span>前端高手进阶专题，告别小菜鸟</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/blog/views/fe-advanced/ad1.html" class="sidebar-link">你真的熟悉 HTML 标签吗？</a></li><li><a href="/blog/views/fe-advanced/ad2.html" class="sidebar-link">如何高效操作 DOM 元素？</a></li><li><a href="/blog/views/fe-advanced/ad3.html" class="sidebar-link">3 个使用场景助你用好 DOM 事件</a></li><li><a href="/blog/views/fe-advanced/ad6.html" class="sidebar-link">浏览器如何渲染页面？</a></li><li><a href="/blog/views/fe-advanced/ad7.html" class="sidebar-link">关于 JavaScript 的数据类型，你知多少</a></li></ul></section></li></ul> </aside> <main class="page"> <div class="theme-default-content content__default"><h1 id="_10-种跨域解决方案（附终极方案）"><a href="#_10-种跨域解决方案（附终极方案）" class="header-anchor">#</a> 10 种跨域解决方案（附终极方案）</h1> <p>嗯。又来了，又说到跨域了，这是一个老生常谈的话题，</p> <p>其实现在的环境对于刚入门的前端来说，非常的不友好，一方面吧，很多刚新人没有经历过工具的变更时代，另一方面框架的迭代更新速度很快。在以前你可能掌握几种常见的手法就好了。但是现在 webpack-dev-server、vue-cli、parcel，这些脚手架都进行了一层封装，对于熟悉的人可能很简单，但是对于还未入门的人来说，简直就是一个黑盒，虽然用起来很方便，但是某一天遇到了问题，你对它不熟悉，你就会不知道所错。（但是别慌，主流 cli 的跨域方式我都会讲到）</p> <p>重要的说明: 在文中，web 端地址为 localhost:8000 服务端地址为 localhost:8080,这一点希望你能记住，会贯穿全文，你也可以把此处的两端的地址代入你自己的地址</p> <p><img src="/blog/assets/img/cors1.38527c29.png" alt="cors1.png"></p> <h2 id="一、跨域是什么？"><a href="#一、跨域是什么？" class="header-anchor">#</a> 一、跨域是什么？</h2> <h3 id="_1-同源策略"><a href="#_1-同源策略" class="header-anchor">#</a> 1.同源策略</h3> <p>跨域问题其实就是浏览器的同源策略所导致的。</p> <blockquote><p><a href="https://developer.mozilla.org/zh-CN/docs/Web/Security/Same-origin_policy" target="_blank" rel="noopener noreferrer">「同源策略」<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a> 是一个重要的安全策略，它用于限制一个 origin 的文档或者它加载的脚本如何能与另一个源的资源进行交互。它能帮助阻隔恶意文档，减少可能被攻击的媒介。--来源 MDN</p></blockquote> <p>当跨域时会收到以下错误</p> <p><img src="/blog/assets/img/cors2.d6fe033d.png" alt="cors2.png"></p> <h3 id="_2-同源示例"><a href="#_2-同源示例" class="header-anchor">#</a> 2.同源示例</h3> <p>那么如何才算是同源呢？先来看看 url 的组成部分</p> <p><code>http://www.example.com:80/path/to/myfile.html?key1=value1&amp;key2=value2#SomewhereInTheDocument</code></p> <p>只有当 <code>protocol</code>（协议）、<code>domain</code>（域名）、<code>port</code>（端口）<strong>三者一致</strong> 才是同源。</p> <p>以下协议、域名、端口一致。</p> <div class="language- extra-class"><pre class="language-text"><code>http://www.example.com:80/a.js

http://www.example.com:80/b.js
</code></pre></div><p>以下这种看上去再相似也没有用，都不是同源。</p> <div class="language- extra-class"><pre class="language-text"><code>http://www.example.com:8080

http://www2.example.com:80
</code></pre></div><p>在这里注意一下啊，这里是为了突出端口的区别才写上端口。在默认情况下 <code>http</code> 可以省略端口 <code>80</code>， <code>https</code> 省略 <code>443</code>。这别到时候闹笑话了，你和我说 <code>http://www.example.com:80</code> 和 <code>http://www.example.com</code> 不是同源，他俩是一个东西。</p> <div class="language- extra-class"><pre class="language-text"><code>http://www.example.com:80 === http://www.example.com

https://www.example.com:443 === https://www.example.com
</code></pre></div><h2 id="二、如何解决跨域？"><a href="#二、如何解决跨域？" class="header-anchor">#</a> 二、如何解决跨域？</h2> <h3 id="_1-cors"><a href="#_1-cors" class="header-anchor">#</a> 1.<code>CORS</code></h3> <p>跨域资源共享(<code>CORS</code>) 是一种机制，它使用额外的 <code>HTTP</code> 头来告诉浏览器 让运行在一个 <code>origin</code> (<code>domain</code>) 上的 <code>Web</code> 应用被准许访问来自不同源服务器上的指定的资源。当一个资源从与该资源本身所在的服务器「不同的域、协议或端口」请求一个资源时，资源会发起一个「跨域 HTTP 请求」。</p> <p>而在 <code>cors</code> 中会有 简单请求 和 复杂请求的概念。</p> <p>「浏览器支持情况」</p> <p>当你使用 <code>IE&lt;=9, Opera&lt;12, or Firefox&lt;3.5</code> 或者更加老的浏览器，这个时候请使用 <code>JSONP</code></p> <h4 id="a-简单请求"><a href="#a-简单请求" class="header-anchor">#</a> a.简单请求</h4> <p>不会触发 CORS 预检请求。这样的请求为<strong>简单请求</strong>，请注意，该术语并不属于 <code>Fetch</code> （其中定义了 <code>CORS</code>）规范。那什么是<strong>简单请求</strong>呢</p> <p>若请求满足所有下述条件，则该请求可视为<strong>简单请求</strong>：</p> <blockquote><p>意思就是以下<strong>请求之外</strong>的都是非简单请求</p></blockquote> <p>情况一: 使用以下方法</p> <ul><li><code>GET</code></li> <li><code>HEAD</code></li> <li><code>POST</code></li></ul> <p>情况二: 人为设置以下集合外的请求头</p> <ul><li><code>Accept</code></li> <li><code>Accept-Language</code></li> <li><code>Content-Language</code></li> <li><code>Content-Type</code> （需要注意额外的限制）</li> <li><code>DPR</code></li> <li><code>Downlink</code></li> <li><code>Save-Data</code></li> <li><code>Viewport-Width</code></li> <li><code>Width</code></li></ul> <p>情况三：Content-Type 的值仅限于下列三者之一：(例如 application/json 为非简单请求)</p> <ul><li><code>text/plain</code></li> <li><code>multipart/form-data</code></li> <li><code>application/x-www-form-urlencoded</code></li></ul> <p>情况四:</p> <p>请求中的任意 <code>XMLHttpRequestUpload</code> 对象均没有注册任何事件监听器；<code>XMLHttpRequestUpload</code> 对象可以使用 <code>XMLHttpRequest.upload</code> 属性访问。</p> <p>情况五:</p> <p>请求中没有使用 <code>ReadableStream</code> 对象。</p> <h4 id="b-非简单请求"><a href="#b-非简单请求" class="header-anchor">#</a> b.非简单请求</h4> <p>除以上情况外的。</p> <h4 id="c-node-中的解决方案"><a href="#c-node-中的解决方案" class="header-anchor">#</a> c.Node 中的解决方案</h4> <h5 id="原生方式"><a href="#原生方式" class="header-anchor">#</a> 原生方式</h5> <p>我们来看下后端部分的解决方案。Node 中 CORS 的解决代码如下：</p> <div class="language-js extra-class"><pre class="language-js"><code>app<span class="token punctuation">.</span><span class="token function">use</span><span class="token punctuation">(</span><span class="token keyword">async</span> <span class="token punctuation">(</span><span class="token parameter">ctx<span class="token punctuation">,</span> next</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  ctx<span class="token punctuation">.</span><span class="token function">set</span><span class="token punctuation">(</span><span class="token string">'Access-Control-Allow-Origin'</span><span class="token punctuation">,</span> ctx<span class="token punctuation">.</span>headers<span class="token punctuation">.</span>origin<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// 配置允许请求的源</span>
  ctx<span class="token punctuation">.</span><span class="token function">set</span><span class="token punctuation">(</span><span class="token string">'Access-Control-Allow-Credentials'</span><span class="token punctuation">,</span> <span class="token boolean">true</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// 配置允许请求头携带cookie</span>
  ctx<span class="token punctuation">.</span><span class="token function">set</span><span class="token punctuation">(</span><span class="token string">'Access-Control-Request-Method'</span><span class="token punctuation">,</span> <span class="token string">'PUT,POST,GET,DELETE,OPTIONS'</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// 配置允许请求的方法</span>
  ctx<span class="token punctuation">.</span><span class="token function">set</span><span class="token punctuation">(</span><span class="token string">'Access-Control-Allow-Headers'</span><span class="token punctuation">,</span> <span class="token string">'Origin, X-Requested-With, Content-Type, Accept, cc'</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// 配置允许的请求头参数</span>
  <span class="token keyword">if</span> <span class="token punctuation">(</span>ctx<span class="token punctuation">.</span>method <span class="token operator">===</span> <span class="token string">'OPTIONS'</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    ctx<span class="token punctuation">.</span>status <span class="token operator">=</span> <span class="token number">204</span><span class="token punctuation">;</span>
    <span class="token keyword">return</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
  <span class="token keyword">await</span> <span class="token function">next</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><h5 id="第三方中间件"><a href="#第三方中间件" class="header-anchor">#</a> 第三方中间件</h5> <p>为了方便也可以直接使用中间件</p> <p>express</p> <p>安装</p> <div class="language-bash extra-class"><pre class="language-bash"><code><span class="token function">npm</span> <span class="token function">install</span> cors
</code></pre></div><p>使用</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token comment">// 在app.js里面</span>
<span class="token keyword">const</span> cors <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'cors'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
app<span class="token punctuation">.</span><span class="token function">use</span><span class="token punctuation">(</span><span class="token function">cors</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><p><a href="https://github.com/expressjs/cors" target="_blank" rel="noopener noreferrer">文档地址<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a>，这个用的不多</p> <p>koa2</p> <p>安装</p> <div class="language-bash extra-class"><pre class="language-bash"><code><span class="token function">npm</span> <span class="token function">install</span> @koa/cors --save
</code></pre></div><p>使用</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">const</span> cors <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'@koa/cors'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

app<span class="token punctuation">.</span><span class="token function">use</span><span class="token punctuation">(</span><span class="token function">cors</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><p><a href="https://www.npmjs.com/package/@koa/cors" target="_blank" rel="noopener noreferrer">文档地址<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a>，这个用的多点</p> <h3 id="关于-cors-的-cookie-问题"><a href="#关于-cors-的-cookie-问题" class="header-anchor">#</a> 关于 cors 的 cookie 问题</h3> <p>想要传递 <code>cookie</code> 需要满足 <code>3</code> 个条件</p> <p>1.<code>web</code> 请求设置 <code>withCredentials=true</code></p> <p>这里默认情况下在跨域请求，浏览器是不带 <code>cookie</code> 的。但是我们可以通过设置 <code>withCredentials</code> 来进行传递 <code>cookie</code>.</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token comment">// 原生 xml 的设置方式</span>
<span class="token keyword">var</span> xhr <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">XMLHttpRequest</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
xhr<span class="token punctuation">.</span>withCredentials <span class="token operator">=</span> <span class="token boolean">true</span><span class="token punctuation">;</span>
<span class="token comment">// axios 设置方式</span>
axios<span class="token punctuation">.</span>defaults<span class="token punctuation">.</span>withCredentials <span class="token operator">=</span> <span class="token boolean">true</span><span class="token punctuation">;</span>
</code></pre></div><p>2.<code>Access-Control-Allow-Credentials</code> 为 <code>true</code></p> <p>3.<code>Access-Control-Allow-Origin</code>为<code>非 *</code></p> <p>这里请求的方式，在 <code>chrome</code> 中是能看到返回值的，但是只要不满足以上其一，浏览器会报错，获取不到返回值。</p> <p><img src="/blog/assets/img/cors4.0dca99c7.png" alt="cors4.png"></p> <div class="language- extra-class"><pre class="language-text"><code>Access to XMLHttpRequest at 'http://127.0.0.1:8080/api/corslist' from origin 'http://127.0.0.1:8000' has been blocked by CORS policy: The value of the 'Access-Control-Allow-Credentials' header in the response is '' which must be 'true' when the request's credentials mode is 'include'. The credentials mode of requests initiated by the XMLHttpRequest is controlled by the withCredentials attribute.
</code></pre></div><p><img src="/blog/assets/img/cors5.d35abac6.png" alt="cors5.png"></p> <div class="language- extra-class"><pre class="language-text"><code>Access to XMLHttpRequest at 'http://127.0.0.1:8080/api/corslist' from origin 'http://127.0.0.1:8000' has been blocked by CORS policy: The value of the 'Access-Control-Allow-Origin' header in the response must not be the wildcard '*' when the request's credentials mode is 'include'. The credentials mode of requests initiated by the XMLHttpRequest is controlled by the withCredentials attribute.
</code></pre></div><p><img src="/blog/assets/img/cors6.c917a970.png" alt="cors6.png"></p> <h4 id="d-前端示例"><a href="#d-前端示例" class="header-anchor">#</a> d.前端示例</h4> <p>分别演示一下前端部分 <code>简单请求</code> 和 <code>非简单请求</code></p> <h5 id="简单请求"><a href="#简单请求" class="header-anchor">#</a> 简单请求</h5> <div class="language-html extra-class"><pre class="language-html"><code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>script</span> <span class="token attr-name">src</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>https://cdn.bootcss.com/axios/0.19.2/axios.min.js<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span><span class="token script"></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>script</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>script</span><span class="token punctuation">&gt;</span></span><span class="token script"><span class="token language-javascript">
  axios<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token string">'http://127.0.0.1:8080/api/corslist'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>script</span><span class="token punctuation">&gt;</span></span>
</code></pre></div><h5 id="非简单请求"><a href="#非简单请求" class="header-anchor">#</a> 非简单请求</h5> <p>这里我们加入了一个非集合内的 <code>header</code> 头 <code>cc</code> 来达到<strong>非简单请求</strong>的目的。</p> <div class="language-html extra-class"><pre class="language-html"><code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>script</span> <span class="token attr-name">src</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>https://cdn.bootcss.com/axios/0.19.2/axios.min.js<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span><span class="token script"></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>script</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>script</span><span class="token punctuation">&gt;</span></span><span class="token script"><span class="token language-javascript">
  axios<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token string">'http://127.0.0.1:8080/api/corslist'</span><span class="token punctuation">,</span> <span class="token punctuation">{</span> header<span class="token operator">:</span> <span class="token punctuation">{</span> cc<span class="token operator">:</span> <span class="token string">'xxx'</span> <span class="token punctuation">}</span> <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>script</span><span class="token punctuation">&gt;</span></span>
</code></pre></div><h4 id="小结"><a href="#小结" class="header-anchor">#</a> 小结</h4> <p>1、 在新版的 <code>chrome</code> 中，如果你发送了复杂请求，你却看不到 <code>options</code> 请求。可以在这里设置 <code>chrome://flags/#out-of-blink-cors</code> 设置成 <code>disbale</code> ，<strong>重启浏览器</strong>。对于非简单请求就能看到 <code>options</code> 请求了。</p> <p>2、 一般情况下后端接口是不会开启这个跨域头的，除非是一些与用户无关的不太重要的接口。</p> <h3 id="_2-node-正向代理"><a href="#_2-node-正向代理" class="header-anchor">#</a> 2.Node 正向代理</h3> <p>代理的思路为，利用<strong>服务端请求不会跨域</strong>的特性，让<strong>接口和当前站点同域</strong>。</p> <p>「代理前是这样的」</p> <p><img src="/blog/assets/img/cors9.909a5991.png" alt="cors9.png"></p> <p>「代理后变成这样的」</p> <p><img src="/blog/assets/img/cors10.beed7814.png" alt="cors10.png"></p> <p>这样，所有的<strong>资源以及请求</strong>都在<strong>一个域名下</strong>(<code>localhost:8000</code>)了。</p> <h4 id="a-cli-工具中的代理"><a href="#a-cli-工具中的代理" class="header-anchor">#</a> a.cli 工具中的代理</h4> <h5 id="_1-webpack-4-x"><a href="#_1-webpack-4-x" class="header-anchor">#</a> (1) Webpack (4.x)</h5> <p>在<code>webpack</code>中可以配置<code>proxy</code>来快速获得接口代理的能力。</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">const</span> path <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'path'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> HtmlWebpackPlugin <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'html-webpack-plugin'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

module<span class="token punctuation">.</span>exports <span class="token operator">=</span> <span class="token punctuation">{</span>
  entry<span class="token operator">:</span> <span class="token punctuation">{</span>
    index<span class="token operator">:</span> <span class="token string">'./index.js'</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  output<span class="token operator">:</span> <span class="token punctuation">{</span>
    filename<span class="token operator">:</span> <span class="token string">'bundle.js'</span><span class="token punctuation">,</span>
    path<span class="token operator">:</span> path<span class="token punctuation">.</span><span class="token function">resolve</span><span class="token punctuation">(</span>__dirname<span class="token punctuation">,</span> <span class="token string">'dist'</span><span class="token punctuation">)</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token comment">// 代理服务器配置</span>
  devServer<span class="token operator">:</span> <span class="token punctuation">{</span>
    port<span class="token operator">:</span> <span class="token number">8000</span><span class="token punctuation">,</span> <span class="token comment">// 端口</span>
    proxy<span class="token operator">:</span> <span class="token punctuation">{</span>
      <span class="token string">'/api'</span><span class="token operator">:</span> <span class="token punctuation">{</span>
        target<span class="token operator">:</span> <span class="token string">'http://localhost:8080'</span> <span class="token comment">// 调用 /api -&gt; 调用 http://localhost:8080/api</span>
      <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  plugins<span class="token operator">:</span> <span class="token punctuation">[</span>
    <span class="token keyword">new</span> <span class="token class-name">HtmlWebpackPlugin</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
      filename<span class="token operator">:</span> <span class="token string">'index.html'</span><span class="token punctuation">,</span>
      template<span class="token operator">:</span> <span class="token string">'webpack.html'</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span>
  <span class="token punctuation">]</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
</code></pre></div><p>修改前端接口请求方式，改为不带域名。（因为现在是<strong>同域请求</strong>了）</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token operator">&lt;</span>button id<span class="token operator">=</span><span class="token string">&quot;getlist&quot;</span><span class="token operator">&gt;</span>获取列表<span class="token operator">&lt;</span><span class="token operator">/</span>button<span class="token operator">&gt;</span>
<span class="token operator">&lt;</span>button id<span class="token operator">=</span><span class="token string">&quot;login&quot;</span><span class="token operator">&gt;</span>登录<span class="token operator">&lt;</span><span class="token operator">/</span>button<span class="token operator">&gt;</span>
<span class="token operator">&lt;</span>script src<span class="token operator">=</span><span class="token string">&quot;https://cdn.bootcss.com/axios/0.19.2/axios.min.js&quot;</span><span class="token operator">&gt;</span><span class="token operator">&lt;</span><span class="token operator">/</span>script<span class="token operator">&gt;</span>
<span class="token operator">&lt;</span>script<span class="token operator">&gt;</span>
  axios<span class="token punctuation">.</span>defaults<span class="token punctuation">.</span>withCredentials <span class="token operator">=</span> <span class="token boolean">true</span><span class="token punctuation">;</span>
  getlist<span class="token punctuation">.</span><span class="token function-variable function">onclick</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    axios<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token string">&quot;/api/corslist&quot;</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span><span class="token parameter">res</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
      console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>res<span class="token punctuation">.</span>data<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span><span class="token punctuation">;</span>
  login<span class="token punctuation">.</span><span class="token function-variable function">onclick</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    axios<span class="token punctuation">.</span><span class="token function">post</span><span class="token punctuation">(</span><span class="token string">&quot;/api/login&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span><span class="token punctuation">;</span>
<span class="token operator">&lt;</span><span class="token operator">/</span>script<span class="token operator">&gt;</span>
</code></pre></div><h5 id="_2-vue-cli-2-x"><a href="#_2-vue-cli-2-x" class="header-anchor">#</a> (2) Vue-cli 2.x</h5> <div class="language-js extra-class"><pre class="language-js"><code><span class="token comment">// config/index.js</span>

<span class="token comment">// ...</span>
proxyTable<span class="token operator">:</span> <span class="token punctuation">{</span>
  <span class="token string">'/api'</span><span class="token operator">:</span> <span class="token punctuation">{</span>
    target<span class="token operator">:</span> <span class="token string">'http://localhost:8080'</span><span class="token punctuation">,</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">,</span>
<span class="token comment">// ...</span>
</code></pre></div><h5 id="_3-vue-cli-3-x"><a href="#_3-vue-cli-3-x" class="header-anchor">#</a> (3) Vue-cli 3.x</h5> <blockquote><p><code>vue.config.js</code> 如果没有就新建</p></blockquote> <div class="language-js extra-class"><pre class="language-js"><code>module<span class="token punctuation">.</span>exports <span class="token operator">=</span> <span class="token punctuation">{</span>
  devServer<span class="token operator">:</span> <span class="token punctuation">{</span>
    port<span class="token operator">:</span> <span class="token number">8000</span><span class="token punctuation">,</span>
    proxy<span class="token operator">:</span> <span class="token punctuation">{</span>
      <span class="token string">'/api'</span><span class="token operator">:</span> <span class="token punctuation">{</span>
        target<span class="token operator">:</span> <span class="token string">'http://localhost:8080'</span>
      <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
</code></pre></div><h5 id="_4-parcel-2-x"><a href="#_4-parcel-2-x" class="header-anchor">#</a> (4) Parcel (2.x)</h5> <div class="language-js extra-class"><pre class="language-js"><code><span class="token comment">// .proxyrc</span>
<span class="token punctuation">{</span>
  <span class="token string">&quot;/api&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
    <span class="token string">&quot;target&quot;</span><span class="token operator">:</span> <span class="token string">&quot;http://localhost:8080&quot;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><p>看到这里，可能有些人心里一句 <code>xxx</code> 就会脱口而出，一会写<strong>配置文件</strong>，一会 <code>proxyTable</code> ，一会 <code>proxy</code>，怎么这么多的形式？学不动了学不动了。。。不过也不用慌，还是有方法的。以上所有配置都是有着共同的<strong>底层包</strong> <code>http-proxy-middleware</code> .里面需要用到的各种 <code>websocket</code> ，<code>rewrite</code> 等功能，直接看这个库的配置就可以了。关于 <code>http-proxy-middleware</code> 这个库的原理可以看 <a href="https://github.com/hua1995116/proxy" target="_blank" rel="noopener noreferrer">这篇文章<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a>
当然了。。。对于配置的位置入口还是非统一的。教一个<strong>搜索的技巧</strong>吧，上面配置写哪里都不用记的，想要哪个框架的 直接 <code>google</code> 搜索 <code>xxx proxy</code> 就行了。</p> <p>例如 <code>vue-cli 2 proxy</code> 、 <code>webpack proxy</code>、<code>react proxy</code> 等等.... 基本会搜到有官网的配置答案，通用且 <code>nice</code>。</p> <h4 id="b-本地-nodejs-端代理"><a href="#b-本地-nodejs-端代理" class="header-anchor">#</a> b.本地 nodeJS 端代理</h4> <p>相当于是前端 -&gt; 请求 node 端接口地址 -&gt; 请求真正的目标接口地址</p> <p>在 koa2 中使用</p> <p>安装</p> <div class="language-bash extra-class"><pre class="language-bash"><code><span class="token function">npm</span> i request-promise -S
<span class="token comment"># yarn i request-promise</span>
</code></pre></div><p>代码</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">const</span> request <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'request-promise'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token keyword">const</span> res <span class="token operator">=</span> <span class="token keyword">await</span> <span class="token function">request</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
  uri<span class="token operator">:</span> <span class="token template-string"><span class="token template-punctuation string">`</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>url<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">/test</span><span class="token template-punctuation string">`</span></span><span class="token punctuation">,</span>
  method<span class="token operator">:</span> <span class="token string">'POST'</span><span class="token punctuation">,</span>
  json<span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>
  headers<span class="token operator">:</span> <span class="token punctuation">{</span>
    <span class="token string">'content-type'</span><span class="token operator">:</span> <span class="token string">'application/json'</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  body<span class="token operator">:</span> data
<span class="token punctuation">}</span><span class="token punctuation">)</span>
  <span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span><span class="token parameter">res</span> <span class="token operator">=&gt;</span> Promise<span class="token punctuation">.</span><span class="token function">resolve</span><span class="token punctuation">(</span>res<span class="token punctuation">)</span><span class="token punctuation">)</span>
  <span class="token punctuation">.</span><span class="token function">catch</span><span class="token punctuation">(</span><span class="token parameter">err</span> <span class="token operator">=&gt;</span> Promise<span class="token punctuation">.</span><span class="token function">reject</span><span class="token punctuation">(</span>err<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
ctx<span class="token punctuation">.</span>status <span class="token operator">=</span> <span class="token number">200</span><span class="token punctuation">;</span>
ctx<span class="token punctuation">.</span>body <span class="token operator">=</span> res<span class="token punctuation">;</span>
</code></pre></div><h4 id="c-使用自己的代理工具"><a href="#c-使用自己的代理工具" class="header-anchor">#</a> c.使用自己的代理工具</h4> <p>cors-anywhere</p> <p>「服务端」</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token comment">// Listen on a specific host via the HOST environment variable</span>
<span class="token keyword">const</span> host <span class="token operator">=</span> process<span class="token punctuation">.</span>env<span class="token punctuation">.</span><span class="token constant">HOST</span> <span class="token operator">||</span> <span class="token string">'0.0.0.0'</span><span class="token punctuation">;</span>
<span class="token comment">// Listen on a specific port via the PORT environment variable</span>
<span class="token keyword">const</span> port <span class="token operator">=</span> process<span class="token punctuation">.</span>env<span class="token punctuation">.</span><span class="token constant">PORT</span> <span class="token operator">||</span> <span class="token number">7777</span><span class="token punctuation">;</span>

<span class="token keyword">const</span> cors_proxy <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'cors-anywhere'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
cors_proxy
  <span class="token punctuation">.</span><span class="token function">createServer</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
    originWhitelist<span class="token operator">:</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token comment">// Allow all origins</span>
    requireHeader<span class="token operator">:</span> <span class="token punctuation">[</span><span class="token string">'origin'</span><span class="token punctuation">,</span> <span class="token string">'x-requested-with'</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
    removeHeaders<span class="token operator">:</span> <span class="token punctuation">[</span><span class="token string">'cookie'</span><span class="token punctuation">,</span> <span class="token string">'cookie2'</span><span class="token punctuation">]</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span>
  <span class="token punctuation">.</span><span class="token function">listen</span><span class="token punctuation">(</span>port<span class="token punctuation">,</span> host<span class="token punctuation">,</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'Running CORS Anywhere on '</span> <span class="token operator">+</span> host <span class="token operator">+</span> <span class="token string">':'</span> <span class="token operator">+</span> port<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><p>「前端代码」</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token operator">&lt;</span>script src<span class="token operator">=</span><span class="token string">&quot;https://cdn.bootcss.com/axios/0.19.2/axios.min.js&quot;</span><span class="token operator">&gt;</span><span class="token operator">&lt;</span><span class="token operator">/</span>script<span class="token operator">&gt;</span>
<span class="token operator">&lt;</span>script<span class="token operator">&gt;</span>
  axios<span class="token punctuation">.</span>defaults<span class="token punctuation">.</span>withCredentials <span class="token operator">=</span> <span class="token boolean">true</span><span class="token punctuation">;</span>
  getlist<span class="token punctuation">.</span><span class="token function-variable function">onclick</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    axios
      <span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token string">&quot;http://127.0.0.1:7777/http://127.0.0.1:8080/api/corslist&quot;</span><span class="token punctuation">)</span>
      <span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span><span class="token parameter">res</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
        console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>res<span class="token punctuation">.</span>data<span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span><span class="token punctuation">;</span>
  login<span class="token punctuation">.</span><span class="token function-variable function">onclick</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    axios<span class="token punctuation">.</span><span class="token function">post</span><span class="token punctuation">(</span><span class="token string">&quot;http://127.0.0.1:7777/http://127.0.0.1:8080/api/login&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span><span class="token punctuation">;</span>
<span class="token operator">&lt;</span><span class="token operator">/</span>script<span class="token operator">&gt;</span>
</code></pre></div><p>「效果展示」</p> <p><img src="/blog/assets/img/cors11.38eafd46.png" alt="cors11.png"></p> <p>「缺点」</p> <p>无法传递 <code>cookie</code>，原因是因为这个是一个<strong>代理库</strong>，作者觉得中间传递 <code>cookie</code> <a href="https://github.com/Rob--W/cors-anywhere/issues/208#issuecomment-575254153" target="_blank" rel="noopener noreferrer">太不安全<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a>了。</p> <h4 id="d-charles"><a href="#d-charles" class="header-anchor">#</a> d.charles</h4> <p>介绍</p> <p>这是一个测试、开发的神器。介绍与使用</p> <p>利用 <code>charles</code> 进行跨域，本质就是请求的拦截与代理。</p> <p>在 <code>tools/map remote</code> 中设置代理</p> <p><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAA5AAAAA0CAYAAAD8KddBAAAABGdBTUEAALGPC/xhBQAAACBjSFJNAAB6JgAAgIQAAPoAAACA6AAAdTAAAOpgAAA6mAAAF3CculE8AAAABmJLR0QA/wD/AP+gvaeTAAAACXBIWXMAABYlAAAWJQFJUiTwAAAbFklEQVR42u3deXhU5b3A8e85M3NmT2ays2g0INtVQY2iqIBI3UDZrLai4nVFrVurrcvjUm+v1VqXLl6ttVWxeq1VBLVutUWloiJugOJFQEAMgSRknUwy27l/nMkkIZNkZjIwM+T3eR6eR3nnnXPeOb/3/Hjf855zlNraWp0kbNiwAYCJEycmUy0hDQ0NbNq0CU3T8Hq9uN1uNE0b0HcGAgGam5upr68nEAhQUVGBx+NJ+77ngldeeYXrr78egGXLljFkyJABf+fcuXP58ssvuffeezn99NOTLhciFyUS1/X19cyePZsdO3Zgt9uZNWsWI0eOJBKJ8PHHH7Ny5Urq6+uxWq3cf//9nHjiiZlulhBiN5I3hUiNxPG+zZzpHejK4/Ewbtw4qqur2b59O+vXrycQCAzoOzVNw+12U1RURFlZGTabLdPN3GcEAgHGjBnDmDFjOPbYY5MuFyIXJRrXXq+X22+/nVtvvZW6ujqeffbZHp9xuVxceeWVMngUYpCQvCkGA4njfZ+STVcgxZ5VVVXFF198gaIoTJ48ecBXd4UQ/du6dStLlixh3bp11NTUoCgKRUVFlJeXM3v2bMaMGZPpXRRC9ELyphBC9CQDSCGEEEIIIYQQCVEzvQNCCCGEEEIIIXKDDCCFEEIIIYQQQiREBpBCCCGEEEIIIRIiA0ghhBBCCCGEEAlJ+TUeyiUbM73vQgghhBBCCCH2IrkCKYQQQgghhBAiITKAFEIIIYQQQgiREBlACiGEEEIIIYRISMr3QO4xihksbmyag0KbFZtJQUnxq3SgLaxT19ZOW6AVgs2ghzLdQiGEEEIIIYTISdk1gDRZ0eyFjMizY7OAqhh/BiKiK5Q4bbQFbWxsshPw10G4PdMtFUIIIYQQQoickz1LWBUzmr2QMR47TiuY1YEPHsH4DrMKTiuM8djR7IXGVU4hhBBCCCGEEEnJngGkxc2IPDuahZSXrPZFATQLjMizg8Wd6dYKIYQQQgghRM7JmgGkTXNgS8PgUdd7/umgADaLsS0hhBBCCCGEEMnJmgFkoc064CWrug6RiE4oFCYUChMOR2J/H2uwYmxLCCFy1YKxNs4aIecxIYQQYiAkn6Yma24GtJmUAQ0gO642WpQQN82EE8aZ+OM7QZ75SEPt8sWqYmwrk248xskd55UAcPdfa7jjnZaM7k+6XTnBwX2XlhIK6biu3txvea7/Hrm+/8kod6jcOcNDeYmZgjwzLf4IO+tDvPBhC0991ZbQd9w5xUXlQTaGFWnsqA/y2aY2HnrPx5bWSE7U7y++97QnzvQyf7oXXYdjltZy3etNe30fhNjb9vXzrOTNlj7/fl+U6Xya6e2TQ/k00/uZjbJmADmQIV3H4DEUCvH9I0PMOsIOwEWTLTz1QRhV7d7MzA4fwWZWsFrU2H8n47wxNg4r1/AHdG5Z1px0+d5wyuFOrBaVmvpgQuUD+T2yQS7sfzri4ren5XPONA+F+T1PG6cc5Wb+Zz5O+ePOXutPKjbzxBVlHDS860yfne9V5vHDE4L86NFqlm4OZG39WFv7ie897dAKG+boJNhhI2yADCDFvk/y5uDIm7nQrn0hn2Z6+7Ft5Ug+zfR+ZqOsWcKaqo7lqZFIhPKCEJdP6wzmVz9tIxJJbBYkV5w/xc11ZxZz7dyilMr3hrH7G8dg/ba2lMpF+g00Lm6Y6OSSGQWxZNMWiLBhWzv1zcZ7Va2ayslHuVl8fvzvryww8b/XDIklG58/zKaqdhp9YQCGF1t49IohzK2wZmX9rjIdv6+vaqGmIUj1rhAvf+TLyD4IkUskb4p0yvV8muntd5XpuE40n2Z6P7NR1lyBHAhdBz0S5uppCnl2Y0y8eWeQB15rAdWT6d0bVCoLTAwvsQCwfG1r0uUiO10w3YNNU9F1eHF5I7e/VM/aRiNZ3DXNzY9mFeJ2mDj5SDcsqu1R/8bTPOxfqgHw1ZY2xv7iu1jZh9eVcdQ4JyVeM1eclM/iR3ZmXf0O2RC/N/+rmZv/lZmrJEKI9JO8ObhkOp9mevsdsiGuE8mn2bCf2Sinr0B2Xbo685AQJx7cOdvxixd2UddqQVVzp4lzK6xcOWHvPyF2boWV+aPScwPxxce7sVpUmnxh7ljeknR5f84bY+Py8fak6y0Ya0v6t50+1MKNxziZWa6l9FukcjxTad/cCis/PdrJpOI9Nx9UWmB896aqduY9VRtLNkRPwMs+NY6lw6byk6OcPeofe7Dxd/XNIc77n+puZRMfqGZbjbEspHJ0/LZnun6HROI3HXGTrv4oxL5O8mb/cilv9kbyaaeB5rNMb79DruTTgfa/fVXOX4GMRCIUO0Jc9b3OAFn8QTOvfaHj9dgxm80o2bmMPuafl5dwSIWNwnwLqgL3BSKs/aaNG5+p5a0qoyO+eVkxxx/qiq3VdthU/A8dCMDWHUG27Gjvs3z0ndt4+AwPF5zsJRDSyb9mM29cWsyEkQ6KPGZUBR7xh/l6Wzs/eryGFTWhbvtYWWDi4uPdLPnYx+vbel8DfsRBNgA2VwdSKo9n4aF2rptdwNAiCy67CYD72o2bvZ94s77XDn3xwXaun1PAsOLOeg+EdKpqgzyzrCHurNPB+SYe+EEBR45xkOc0YkcHWv1hPvnaz10v7uqz/Ykez4G275ThFm6aXcARo+w4o3V0HWobgyz7zMfZT9clFDej79yW0PHVo2vFfW3xl4TvajYSkL7bU48B7pjioqzQmL1bvdHPql3hHvU//r9Whhfnk+8y88gsDwuXNmRN/a56i99U4ibV/njfyXlccUYhug7X/qGaR9f4EWKwkbzZt1zLmwM5zgNt92DKp9mw/Q65kk9T6X+DQVZfnov3Tsce73jUw1w9XaUkz2hK1a4Qd7/cgtPhRNM0sv0C5IyJbqYd7qbYY4k9hdaqqRwx2sEfLiuNfc5qUbFpauzEBWDT1Ogfpd9yAJtFwaap2DWV5VeVctKReZR4zbHtuuwmDjvIwYs3DOMHB3Wfsfn7jcO5bGYhz90wjMoCU6/tObDMqLd6U1tK5bv7/cx87r+0jFH72WLJAMBuVSkv07j5nBKem1/Yo96Dp+bxm8vKGL1/93oWs0J5mcbPzi7msTndlzeXO1RevHYI0yvzyHd1TjwogNNu4vhDXTx0SWlfu5vw8RxI+w7ON/HIZWVMHu+KJbtQWEdRoNhj4aypHt64tDihuEn0+K7/tt34jcq0uDOBlaOMmcbahiD373YfwaghnZ9/45P49xgsWt5MJJqoyku0rKrfVbz4TTVuUu2P1o56VhWrJctnx4TYAyRv9i3X8uZAj/NA2j3Y8mk2bL9DruTTZPvfYJG1VyA7BoiRSASXFqY1qKKjoiiKMRuhQzgcZuqIIKd2WaLwq5d2scOn4cm35cTy1YMPtLPxu3aeX97IW+vaOO0QO/NP9FLiNVMx1MrDZ3i4/KUGbvprHSPeauTi6flMHu/C3x7hst9vB6DeH2FXa6TP8q4sZoXjDnVR1xjib+828o+1fo49yMqZx+ezf6lGidfM1TO8PPugsTRhwVgbxR4jVNwOE3MnOFgVZxbymiMcFOSbCYV1nl6RfHmP3ybfxDnTPNitKuGIztuftvDqxz5a2iKccpiT0ya6sWoqZ0zKY8EnPp5c1xard+50Lw6bSkSH5Z838/JHPvLtClMOcTJxrAOrpjJ/upcln7TyyhZjVunWk/MYGb0pfPP2AEvfb2LZOj9zKp2cMMHF/qUaFUOtPDbHw8Uvxp9RS/R4DqR9t87wUF5mnJTXbvLz1LJGXl3XxkXHOFlwkhev28yUCS6mltb3GzeJHt9/fObjiNEO8p0mnrhqCGs2+Vmxzs/Y/ayMH2HjwKFWdB0+Xt/zBFuY1zmj+8zn8a+WLd7UTnsggt2qku9Us6p+f/E70LhJtj8KMdhJ3uzjt8nBvDnQ4zyQdg+2fJoN2yeH8mmy/W8wydoBJNHlqdecEOKsiRY+3xrmlsVB6tvMKIqCruu4tQA/Oc0amw167ZNm/rYqgteTh9lszvqrjwBVtUFG3rEt9v9vVQX5rj7MPReVYlIVxu5nnNhW1IRYURPi/CluiHbe3d/T0195V02+MOc+WBVbBrB4Uzu/Xd7CiluHM7TIQuVoB/NHWXl6fTtPrmvjx5v8jDvAxtYdgV5vOD5pghMF2F4XjLtso7/y3d1zZgFetxGiS5Y3cuZf6mJlj67x8+vqAD8+sxirpnL1TC9PrjNO5L+cV0BhnlHv1Q+aOP3PNZ1f+k4Li88vYs7x+dg0lQsm5/HKU8ZN4qEIrPo/H8EQ3PXirliCXLo5wA3fBrjnojIUBUYO7X1GLdHjOZD2lUdv5g6FdW54qib2W173ehPN/ggzJxoxMKbUwiOr/f3GRSLH9453Wmjw6fxkTiHDSyxMPczN1MPcsfIWf5hn/9XAJUt6ntC9TiPhtAUifb4bqi2WcExZVb9Db/GbjrhJpj8KMdhJ3uxdLubNgR7ngbR7sOXTbNg+OZRPk+1/g0lWD7EikQg/PMaCXVM4eqSZm2co6JEQ4XCYcDjM5VMUhkeXB+xsDHH3Sz4cdgeapmEy5cbSrve/6LkE4L6VPhpajHXl8d7Rkw7LV/dcm7+lNcJrHxknO4tZYcq4ziu74++u4rCfbWHE7dt6/c4xHY85/rY9pfLdjYieIBpbQt2SQYfr32xiyw7j5DK8uPNkctAw47+bfGFuemFXj3pzF9Xy8Et1/OnVOpat6Xyi1sKlDRz562omPVgdO2l1uPdDH7WNxu+V7+p9KVIyxzPV9vkDxknbbFK4aXZBtyUot73TwuG/2s7hv9rOI6sTvzeuv+M7qdjM+dOMJSHxOGwmTqp0c8PEnjfc22zGaSYY1ulLMHpbQtelQNlQv0Nv8ZuOuEm2PwoxmEne7F0u5s3eSD5Nfz7Nhu2TQ/k02f43mGT9FchF77Zz8TQjiE/8DwsLd7Txu39FmFSh8/2JtthnH/h7PZsbLHjy7TmxdLXD1pr4Mxr+Nh3ywKTumYHwqq/jnwyfX9nChacWoABDCyzdyro+qWt3lQUmhhUbn39njS/p8ng8LiM8d9T3vt3vagIcUKaR12WZRMcsZPWuUK/7fMXLvS+luWuamwkVVsoKLDisKlaLimZRYvvTl2SOZ6rte2WVj0kHu9AsCpPHu5g4zsG3O4Js2t7OG5+29rhnIVF9Hd+nflRGxVArevTJbe+s9rG+KsBQr5mJo+0cNsrB/qUad5xbQr2vmsfWdsZXS3SWsr/79bRouLW2d5/VzHR9EozfgcRNKv1RiMFK8mbvcjFv9kbyafrzaTZsP1fyaSr9bzDJ6gEkwK9fa2WYJ8KphxuX1y+cYqWqvpV5R2mxpavvfunjL++HyMvz5MzS1Q6BUPxZnIiuJ/1dyVi1Nf7TpF7fFiQQjGC1qHhcif+Ql042HnPc6AvzX+/5ki6Px2k3jq+vrfcTcVOrUWbTVKYPtfBWVRCHrf968cws1/jNhSUcONRKqv/8SOZ4ptq++1b6KM2v4bwTvZQWWrBaVEYOtzJyuJXvVeZx3ewgj75al/Dv3J9HZ3uoGGrMwq1a5+Oo+3e7d+DVRh6Z5eGS0wpw2FSuOM3TLeE0+IwEollUKgtMcZ/aRvQBBQCNLd3LM12ffuI3HXGT7v4oxL5M8mbvcjFv9kbyafrzaaa3Tw7l01T632CS1f8iMZvNhLDw46cb+Wyzsc7cYlL4+Twnh+5nzAo0+8Pc/rdGbDYnVqsVdQ/NPO5rxg+PP/sytdSMZjbCoqk18WR8+EhjOcCWXh5z3F95PK1txvYd1t7DtONJa+3BSOyR3h31nLbklsz88pwiKqInrcaWEJ9+3cqLyxtZ9GY9v3uxlvrmUFLft6faB/DTfzQz5Mat3Pznat78qIkN29ppD0ZQFBheYuFnZxen7R1l46JLOCIRndueq4v7mYVLG2Lvfhpe3D226pqM300Bzjw8/nu8Lj3Ejk2LJhxfJKvq00/8piNu0t0fhRDpJ3mzp72dN9PdbgZZPs309smhfJpK/xtMsvYKpKKAqqo47A5aWnSufnwXz1xdzPDC7oHx4N/r2bTLQn70qavZ/s7HbFE50g5xZlS+f6Qz9htW7Ur8huEDoo92/ryXxxz3Vx5PQ0uYEq+ZIk/vYTo0Gg9Nvs5ZrvrmECVeM6VeE+UONe6N3gsPtWMxK3xTF4qts+/Yx7rGEEXXb+lRZ8HJ3rQeg1Tb19Xd7/u4+33jOJ41wsrNZxYyfqTxLqvZR7nS8tAVV+zR5vR5E3l70DghW7XuCfzTb9qZrxt9+oRDnPBWz4cKzD3aHYu79d+1Z1V9+onfdMRNuvujECL9JG9mPm+mu91dDYZ8muntk0P5NJX+N5hk9RVIVQWLxYLT6WBLg4Vrnqjttp565QY/j78XwuVyYbFYcmrp6kDZrCoLxtpSLp8y3hn3/USnTcyD6BPJPtjtEc53TXNT7uj5I19b6aQgz3jM8aJ/Nydd3putO4wTT2GemUVnFfQov+04FwdGl2Jsr+ucldq0veMmazP3z+tZ7/F5Xv7nqqH89vIhXDYtP/b3HTOXO+p7znA9fIYHtyP5hwDsifa9tbCEldeV8eKCom6ff25jO799ufPhB13fg9Whr7jo7fh+G52J1CwKj8+Lf/JeMNbGsCIjOdftdu/H/R/5YjN4Yw+w9XhX2tRSM4ePMvappiHIda83ZVX9/uI3HXGTSn8UQiRH8mbu5810t3uw5dNMbz9X8mmq/W8wyZohV28Xk00mBU3TcLlcrNxi4vpFtdQ2hfhiWzs3PduIarahaVpSS1dzeSHYrhZjAK0qcNUMLxcfbE+qvIPXbWbpDcO47TgXRN91s+7WYRwQfR/S6o3+buvet921Pzf9sIRPf7EfB+d375gdjzmuqg12WxaSaHlv/ntJfeyehbOnenjhvCJOGW5hUrGZP8318tOzilAVCIZ0Hn298+b+2xbX0dBinHzOODaPVy4sZtYBGvNHWfnr/EK+PyUfJXoSef6DzhNDfXSt/qj9rPx5npfKAmMm9rn5hSw4yZv2+ztSbd8BZRpHjnMy69h8liwoYmqpMeP606Od/GRO50uSV3/Tefz6i4u+ju+7X7QSjN6LcvYJHp75QffkfOcUF3cvKMERfTrbF9/0PDG/s7oFou/Fuu/CUi4cZySYuRVW/riwjGKPkaw+/DL+ze+ZrN9f/KYjbpLtj0KIxEne3HfyZrrbPdjyaaa3nyv5NNX+N5hkzRLWtrBORFeINw40mRSsVisuXeflNS08/3E1iqLgtDtwu52YTKaEl65GdGNbuerf6/zMOS4fi1nhiNEOHh3l4JbqAAfe9m1C5R22VAcoL9P4+YJSbj+vpNsAvL45xMOvdZ5gF4y1MTS6Dt7rNnNupYMb/9mZQEZH38W0/tv4Mzr9lffm7R0hFr/byDknetEsCnMn5zP7eCOJdRzvSETnH6uaeeizzseKr9oV5q9vN3LBSV6smsqMY/I49Whj5qmjmTrw8oqm2MuEAd793Mec4/MxmxT+85QCzvueMTtnNim0tkWoawrF3pOVDqm276X3m7hyVhGaRWHWcfnMOCaPtkCk2wzpmk1+ftZlaUlfcdHf8b33Qx9HjmzkzKnGS5p/eKKXMybl4WvT0SyQ5zTHftevtrZx+uM1Pdp6wfP1TBhhZ/xIO0OLLDx27TAe8Idx2dRY7G34rp1fvlIf97fKZP3+4jcdcZNMfxRCJEfy5r6TN9Pd7sGWTzO9/VzJp6n2v8Eka65A1rW1E+ljXGc2q9isVlwuF3luF3kuN06nI+mnrkZ0Y1uZ1NblyWLhSN+f3f1hY7/7pJW/vdNAQ0sIXe+4VzTx8g63PLWT1Rv9tLZFYp0rGNJZ/207F/+++2Obn1zXxtfftqNHZ2O6ngwnFZtj71R6e21rj+30V97f7/GfL9Rzx1M72LYzSCisoypGmyIRnZ31IX63pJYZf+p5glu4tIFbntzJ1h2BWL2Oc0hNQ5BFb+xi7qLabnXmLqrl5RVNtLZ1vhdKUYzHmt/7XA0NzeG4x2QgxzOV9v34jSZ+v7SWLdUBdN3Yz45k19wa5s2Pmjj9N92frNZXXPR1fDuc9XQdf3i5jupdxgy1026ixGvG4zKSTWtbhNdXNnPeQ9X0ZsI9Vby3poVgSEdRIM9hQlUVQmGd1Rv9TP9VFStqQllVP5H4TTVuukqmPwa7xFsohyfDhEiG5M3Ef49czpuST/d8Ps3U9nMlnyaynwKU2trapP4FsmHDBgCOfqwomWr907yMLSrAaaXXS9S6bpwIIpEIiqKgqmpSg0cd8LXDutpdEKhPvGKWmlRs5rBhGl9sD/D2jlC/5Y/P83LBKcZyhXm/3MbiTcZA+tZjnditKn/4wBf3xvkOPzjIyrNfdx98PzbHw0WnFdLYEsJzXc8bnvsrT0a5Q+WiIx2YVIW/r/X3OViIV89pU3nv6/ZYu/tyw0Qnpfkm3vrS3+eN5umUSvtmlmscU2HFaVP5cluAR9f0v8yxt7iJd3zjufEYJ2OGaRS6zbS2R/hmR4DX1/rjxmA8lQUmzp3opKLMyrbaIM+tbEm47t6un2z8JhM3A+2PQojkSd7ct/JmOts9GPPp3tx+ruTTdPa/fVn2DCAVM5qzhDEeO5qFtK+b14FAEL5q8BPw7QR97zxaOpv01sEGYtUNQzhilIPPN/iZcE9V0uVCZLM9Gb97oj8KIdJL8qYQ6ZEr+VT6X2KyZgkreoiAv46vGvz42iEUoc8lrYmK6MZ3+dqjg0d/3aAcPO4pFdHHHH+20Z9SuRDZTOJXCJFukjfFYJQrcZ0r+5lpWfMQHQDC7QR8O1kXcGPTHBTarNhMSspXI/Xow3nq2tppC7RCsFkGj2lU7lDZXhdie12Iv6xoSbpciGwm8SuESDfJm2IwypW4zpX9zAbZs4RV7HFnjbAydZwd0Lnnn81yf5UQGST9UYjsJ/1UiOwn/XTvkwGkEEIIIYQQQoiEZM89kEIIIYQQQgghspoMIIUQQgghhBBCJEQGkEIIIYQQQgghEiIDSCGEEEIIIYQQCUn5NR76H0dket+FEEIIIYQQQuxFcgVSCCGEEEIIIURCZAAphBBCCCGEECIhMoAUQgghhBBCCJGQlO+B3FOqGuCVNfDvr2FdNdS3gpLid+mA1wFjy+C4g2DmITDUk+kWCiGEEEIIIURuyqoB5KrN8Mi7sGIj2CygKlDgGNh3RnRYWwWrtsDKb2DhZKg8INMtFUIIIYQQQojc8/+cwYjeuZlUHwAAAABJRU5ErkJggg==" alt="cors12.png"></p> <p><img src="/blog/assets/img/cors13.a0ed445b.png" alt="cors13.png"></p> <h5 id="前端代码"><a href="#前端代码" class="header-anchor">#</a> 前端代码</h5> <div class="language-html extra-class"><pre class="language-html"><code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>button</span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>getlist<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>获取列表<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>button</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>button</span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>login<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>登录<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>button</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>script</span> <span class="token attr-name">src</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>https://cdn.bootcss.com/axios/0.19.2/axios.min.js<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span><span class="token script"></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>script</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>script</span><span class="token punctuation">&gt;</span></span><span class="token script"><span class="token language-javascript">
  axios<span class="token punctuation">.</span>defaults<span class="token punctuation">.</span>withCredentials <span class="token operator">=</span> <span class="token boolean">true</span><span class="token punctuation">;</span>
  getlist<span class="token punctuation">.</span><span class="token function-variable function">onclick</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    axios<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token string">'/api/corslist'</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span><span class="token parameter">res</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
      console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>res<span class="token punctuation">.</span>data<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span><span class="token punctuation">;</span>
  login<span class="token punctuation">.</span><span class="token function-variable function">onclick</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    axios<span class="token punctuation">.</span><span class="token function">post</span><span class="token punctuation">(</span><span class="token string">'/api/login'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span><span class="token punctuation">;</span>
</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>script</span><span class="token punctuation">&gt;</span></span>
</code></pre></div><h5 id="后端代码"><a href="#后端代码" class="header-anchor">#</a> 后端代码</h5> <div class="language-js extra-class"><pre class="language-js"><code>router<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token string">'/api/corslist'</span><span class="token punctuation">,</span> <span class="token keyword">async</span> <span class="token parameter">ctx</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  ctx<span class="token punctuation">.</span>body <span class="token operator">=</span> <span class="token punctuation">{</span>
    data<span class="token operator">:</span> <span class="token punctuation">[</span><span class="token punctuation">{</span> name<span class="token operator">:</span> <span class="token string">'秋风的笔记'</span> <span class="token punctuation">}</span><span class="token punctuation">]</span>
  <span class="token punctuation">}</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

router<span class="token punctuation">.</span><span class="token function">post</span><span class="token punctuation">(</span><span class="token string">'/api/login'</span><span class="token punctuation">,</span> <span class="token keyword">async</span> <span class="token parameter">ctx</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  ctx<span class="token punctuation">.</span>cookies<span class="token punctuation">.</span><span class="token function">set</span><span class="token punctuation">(</span><span class="token string">'token'</span><span class="token punctuation">,</span> token<span class="token punctuation">,</span> <span class="token punctuation">{</span>
    expires<span class="token operator">:</span> <span class="token keyword">new</span> <span class="token class-name">Date</span><span class="token punctuation">(</span><span class="token operator">+</span><span class="token keyword">new</span> <span class="token class-name">Date</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token number">1000</span> <span class="token operator">*</span> <span class="token number">60</span> <span class="token operator">*</span> <span class="token number">60</span> <span class="token operator">*</span> <span class="token number">24</span> <span class="token operator">*</span> <span class="token number">7</span><span class="token punctuation">)</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  ctx<span class="token punctuation">.</span>body <span class="token operator">=</span> <span class="token punctuation">{</span>
    msg<span class="token operator">:</span> <span class="token string">'成功'</span><span class="token punctuation">,</span>
    code<span class="token operator">:</span> <span class="token number">0</span>
  <span class="token punctuation">}</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><h5 id="效果"><a href="#效果" class="header-anchor">#</a> 效果</h5> <p>访问 <code>http://localhost:8000/charles</code></p> <p><img src="data:image/png;base64,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" alt="cors14.png"></p> <p><img src="/blog/assets/img/cors15.380ebba4.png" alt="cors15.png"></p> <p>nice~ 完美解决。</p> <p>对了。这里又有一个注意点。在 <code>Mac mojave 10.14</code> 中会出现 <code>charles</code> 抓不到本地包的情况。这个时候需要<strong>自定义一个域名</strong>，然后配置 <code>hosts</code> 指定到 <code>127.0.0.1</code>。然后修改访问方式 <code>http://localhost.charlesproxy.com:8000/charles</code>。</p> <p><img src="/blog/assets/img/cors16.3f24e09c.png" alt="cors16.png"></p> <p><img src="data:image/png;base64,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" alt="cors17.png"></p> <h3 id="_3-nginx-反向代理"><a href="#_3-nginx-反向代理" class="header-anchor">#</a> 3.Nginx 反向代理</h3> <h4 id="介绍"><a href="#介绍" class="header-anchor">#</a> 介绍</h4> <p><code>Nginx</code> 则是通过<strong>反向代理</strong>的方式，（这里也需要自定义一个域名）这里就是保证我<strong>当前域</strong>，<strong>能获取到静态资源和接口，不关心是怎么获取的</strong>。</p> <h4 id="nginx-安装教程"><a href="#nginx-安装教程" class="header-anchor">#</a> <code>nginx</code> 安装教程</h4> <p>配置下 <code>hosts</code></p> <p><img src="/blog/assets/img/cors18.b9944dc2.png" alt="cors18.png"></p> <p><code>127.0.0.1 local.test</code></p> <p>配置 <code>nginx</code></p> <p><code>nginc.conf</code>文件</p> <div class="language-nginx extra-class"><pre class="language-nginx"><code><span class="token keyword">server</span> <span class="token punctuation">{</span>
  <span class="token keyword">listen</span> <span class="token number">80</span><span class="token punctuation">;</span>
  <span class="token keyword">server_name</span> local<span class="token punctuation">.</span>test<span class="token punctuation">;</span>
  <span class="token keyword">location</span> <span class="token operator">/</span>api <span class="token punctuation">{</span>
    <span class="token keyword">proxy_pass</span> <span class="token keyword">http</span><span class="token punctuation">:</span><span class="token operator">/</span><span class="token operator">/</span>localhost<span class="token punctuation">:</span><span class="token number">8080</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
  <span class="token keyword">location</span> <span class="token operator">/</span> <span class="token punctuation">{</span>
    <span class="token keyword">proxy_pass</span> <span class="token keyword">http</span><span class="token punctuation">:</span><span class="token operator">/</span><span class="token operator">/</span>localhost<span class="token punctuation">:</span><span class="token number">8000</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><h4 id="启动-nginx"><a href="#启动-nginx" class="header-anchor">#</a> 启动 nginx</h4> <div class="language-bash extra-class"><pre class="language-bash"><code><span class="token function">sudo</span> nginx
</code></pre></div><h4 id="重启-nginx"><a href="#重启-nginx" class="header-anchor">#</a> 重启 nginx</h4> <div class="language-bash extra-class"><pre class="language-bash"><code><span class="token function">sudo</span> nginx -s reload
</code></pre></div><p><code>centos 7.3</code>版本及以上的</p> <div class="language-bash extra-class"><pre class="language-bash"><code>systemctl restart nginx
</code></pre></div><h4 id="实现"><a href="#实现" class="header-anchor">#</a> 实现</h4> <p>前端代码</p> <div class="language-html extra-class"><pre class="language-html"><code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>script</span><span class="token punctuation">&gt;</span></span><span class="token script"><span class="token language-javascript">
  axios<span class="token punctuation">.</span>defaults<span class="token punctuation">.</span>withCredentials <span class="token operator">=</span> <span class="token boolean">true</span><span class="token punctuation">;</span>
  getlist<span class="token punctuation">.</span><span class="token function-variable function">onclick</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    axios<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token string">'/api/corslist'</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span><span class="token parameter">res</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
      console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>res<span class="token punctuation">.</span>data<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span><span class="token punctuation">;</span>
  login<span class="token punctuation">.</span><span class="token function-variable function">onclick</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    axios<span class="token punctuation">.</span><span class="token function">post</span><span class="token punctuation">(</span><span class="token string">'/api/login'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span><span class="token punctuation">;</span>
</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>script</span><span class="token punctuation">&gt;</span></span>
</code></pre></div><p>后端代码</p> <div class="language-js extra-class"><pre class="language-js"><code>router<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token string">'/api/corslist'</span><span class="token punctuation">,</span> <span class="token keyword">async</span> <span class="token parameter">ctx</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  ctx<span class="token punctuation">.</span>body <span class="token operator">=</span> <span class="token punctuation">{</span>
    data<span class="token operator">:</span> <span class="token punctuation">[</span><span class="token punctuation">{</span> name<span class="token operator">:</span> <span class="token string">'秋风的笔记'</span> <span class="token punctuation">}</span><span class="token punctuation">]</span>
  <span class="token punctuation">}</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

router<span class="token punctuation">.</span><span class="token function">post</span><span class="token punctuation">(</span><span class="token string">'/api/login'</span><span class="token punctuation">,</span> <span class="token keyword">async</span> <span class="token parameter">ctx</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  ctx<span class="token punctuation">.</span>cookies<span class="token punctuation">.</span><span class="token function">set</span><span class="token punctuation">(</span><span class="token string">'token'</span><span class="token punctuation">,</span> token<span class="token punctuation">,</span> <span class="token punctuation">{</span>
    expires<span class="token operator">:</span> <span class="token keyword">new</span> <span class="token class-name">Date</span><span class="token punctuation">(</span><span class="token operator">+</span><span class="token keyword">new</span> <span class="token class-name">Date</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token number">1000</span> <span class="token operator">*</span> <span class="token number">60</span> <span class="token operator">*</span> <span class="token number">60</span> <span class="token operator">*</span> <span class="token number">24</span> <span class="token operator">*</span> <span class="token number">7</span><span class="token punctuation">)</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  ctx<span class="token punctuation">.</span>body <span class="token operator">=</span> <span class="token punctuation">{</span>
    msg<span class="token operator">:</span> <span class="token string">'成功'</span><span class="token punctuation">,</span>
    code<span class="token operator">:</span> <span class="token number">0</span>
  <span class="token punctuation">}</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><p>效果</p> <p>访问 <code>http://local.test/charles</code></p> <p>浏览器显示</p> <p><img src="/blog/assets/img/cors19.e34b0435.png" alt="cors19.png"></p> <h3 id="_4-jsonp"><a href="#_4-jsonp" class="header-anchor">#</a> 4.JSONP</h3> <p><code>JSONP</code> 主要就是利用了 <code>script</code> 标签<strong>没有跨域限制</strong>的这个特性来完成的。</p> <p>「使用限制」</p> <p>仅支持 <code>GET</code> 方法，如果想使用完整的 <code>REST</code> 接口，请使用 <code>CORS</code> 或者<strong>其他代理方式</strong>。</p> <p>「流程解析」</p> <p>1.前端定义解析的回调函数（例如 <code>jsonpCallback=function(){....}</code>）</p> <p>2.通过 <code>params</code> 形式包装请求参数，并且声明执行函数(例如 <code>cb=jsonpCallback</code>)</p> <p>3.后端获取前端声明的执行函数（<code>jsonpCallback</code>），并以带上参数并调用执行函数的方式传递给前端。</p> <p>「使用示例」</p> <p>后端实现</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">const</span> Koa <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'koa'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> fs <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'fs'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> app <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Koa</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

app<span class="token punctuation">.</span><span class="token function">use</span><span class="token punctuation">(</span><span class="token keyword">async</span> <span class="token punctuation">(</span><span class="token parameter">ctx<span class="token punctuation">,</span> next</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  <span class="token keyword">if</span> <span class="token punctuation">(</span>ctx<span class="token punctuation">.</span>path <span class="token operator">===</span> <span class="token string">'/api/jsonp'</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">const</span> <span class="token punctuation">{</span> cb<span class="token punctuation">,</span> msg <span class="token punctuation">}</span> <span class="token operator">=</span> ctx<span class="token punctuation">.</span>query<span class="token punctuation">;</span>
    ctx<span class="token punctuation">.</span>body <span class="token operator">=</span> <span class="token template-string"><span class="token template-punctuation string">`</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>cb<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">(</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span><span class="token constant">JSON</span><span class="token punctuation">.</span><span class="token function">stringify</span><span class="token punctuation">(</span><span class="token punctuation">{</span> msg <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">)</span><span class="token template-punctuation string">`</span></span><span class="token punctuation">;</span>
    <span class="token keyword">return</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

app<span class="token punctuation">.</span><span class="token function">listen</span><span class="token punctuation">(</span><span class="token number">8080</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><p>前端实现</p> <p>普通 <code>js</code> 示例</p> <div class="language-html extra-class"><pre class="language-html"><code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>script</span> <span class="token attr-name">type</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>text/javascript<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span><span class="token script"><span class="token language-javascript">
  <span class="token comment">// 定义前端执行的回调</span>
  window<span class="token punctuation">.</span><span class="token function-variable function">jsonpCallback</span> <span class="token operator">=</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">res</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>res<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span><span class="token punctuation">;</span>
</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>script</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>script</span>
  <span class="token attr-name">src</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>http://localhost:8080/api/jsonp?msg=hello&amp;cb=jsonpCallback<span class="token punctuation">&quot;</span></span>
  <span class="token attr-name">type</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>text/javascript<span class="token punctuation">&quot;</span></span>
<span class="token punctuation">&gt;</span></span><span class="token script"></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>script</span><span class="token punctuation">&gt;</span></span>
</code></pre></div><p><code>JQuery Ajax</code> 示例</p> <div class="language-html extra-class"><pre class="language-html"><code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>script</span> <span class="token attr-name">src</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>https://cdn.bootcss.com/jquery/3.5.0/jquery.min.js<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span><span class="token script"></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>script</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>script</span><span class="token punctuation">&gt;</span></span><span class="token script"><span class="token language-javascript">
  $<span class="token punctuation">.</span><span class="token function">ajax</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
    url<span class="token operator">:</span> <span class="token string">'http://localhost:8080/api/jsonp'</span><span class="token punctuation">,</span>
    dataType<span class="token operator">:</span> <span class="token string">'jsonp'</span><span class="token punctuation">,</span>
    type<span class="token operator">:</span> <span class="token string">'get'</span><span class="token punctuation">,</span>
    data<span class="token operator">:</span> <span class="token punctuation">{</span>
      msg<span class="token operator">:</span> <span class="token string">'hello'</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
    jsonp<span class="token operator">:</span> <span class="token string">'cb'</span><span class="token punctuation">,</span>
    <span class="token function-variable function">success</span><span class="token operator">:</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">data</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>data<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>script</span><span class="token punctuation">&gt;</span></span>
</code></pre></div><p>「原理解析」</p> <p>其实这就是 <code>js</code> 的魔法</p> <p>我们先来看最简单的 <code>js</code> 调用。嗯，很自然的调用。</p> <div class="language-html extra-class"><pre class="language-html"><code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>script</span><span class="token punctuation">&gt;</span></span><span class="token script"><span class="token language-javascript">
  window<span class="token punctuation">.</span><span class="token function-variable function">jsonpCallback</span> <span class="token operator">=</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">res</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>res<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span><span class="token punctuation">;</span>
</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>script</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>script</span><span class="token punctuation">&gt;</span></span><span class="token script"><span class="token language-javascript">
  <span class="token function">jsonpCallback</span><span class="token punctuation">(</span><span class="token punctuation">{</span> a<span class="token operator">:</span> <span class="token number">1</span> <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>script</span><span class="token punctuation">&gt;</span></span>
</code></pre></div><p>我们稍稍改造一下，以<strong>外链的形式</strong>来调用。</p> <div class="language-html extra-class"><pre class="language-html"><code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>script</span><span class="token punctuation">&gt;</span></span><span class="token script"><span class="token language-javascript">
  window<span class="token punctuation">.</span><span class="token function-variable function">jsonpCallback</span> <span class="token operator">=</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">res</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>res<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span><span class="token punctuation">;</span>
</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>script</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>script</span> <span class="token attr-name">src</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>http://localhost:8080/api/a.js<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span><span class="token script"></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>script</span><span class="token punctuation">&gt;</span></span>

// http://localhost:8080/api/a.js jsonpCallback({a:1});
</code></pre></div><p>我们再改造一下，我们把这个外链的 <code>js</code> 就当做是一个动态的接口，因为本身资源和接口一样，是一个请求，也包含各种参数，也可以<strong>动态化返回</strong>。</p> <div class="language-html extra-class"><pre class="language-html"><code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>script</span><span class="token punctuation">&gt;</span></span><span class="token script"><span class="token language-javascript">
  window<span class="token punctuation">.</span><span class="token function-variable function">jsonpCallback</span> <span class="token operator">=</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">res</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>res<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span><span class="token punctuation">;</span>
</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>script</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>script</span> <span class="token attr-name">src</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>http://localhost:8080/api/a.js?msg=hello&amp;cb=jsonpCallback<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span><span class="token script"></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>script</span><span class="token punctuation">&gt;</span></span>

// http://localhost:8080/api/a.js jsonpCallback({msg:hello});
</code></pre></div><p>返回的响应体是这样的</p> <p><img src="/blog/assets/img/cors20.b71f8a7d.png" alt="cors20.png"></p> <p>你仔细品，细细品，是不是 <code>jsonp</code> 有的优势就是 <code>script</code> 加载 <code>js</code> 的优势，加载的方式只不过换了一种说法, 相当于加载外链资源的内容(<strong>可以是请求返回的内容</strong>)，最终会放入到<code>&lt;script&gt;外链的内容&lt;/script&gt;</code>中，然后浏览器会解析<code>script</code>标签并执行里面的代码。这也告诉我们一个道理，很多东西并没有那么神奇，是在你所学的知识范围内。就好比，桃树和柳树，如果你把他们当成很大跨度的东西去记忆理解，那么世上这么多树，你真的要累死了，你把他们都当成是树，哦吼？你会突然发现，你对世界上所有的树都有所了解，他们都会长叶子，光合作用....当然也有个例，但是你只需要去记忆这些细微的差别，抓住主干。。。嗯，反正就这么个道理。</p> <h3 id="_5-websocket"><a href="#_5-websocket" class="header-anchor">#</a> 5.Websocket</h3> <p><code>WebSocket</code> 规范定义了一种 <code>API</code>，可在网络浏览器和服务器之间建立<strong>套接字</strong>连接。简单地说：客户端和服务器之间存在持久的连接，而且双方都可以随时开始发送数据。详细教程可以看 <a href="https://www.html5rocks.com/zh/tutorials/websockets/basics/" target="_blank" rel="noopener noreferrer">这里<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></p> <p>这种方式本质没有使用了 <code>HTTP</code>, 因此也没有<strong>跨域</strong>的限制，没有什么过多的解释直接上代码吧。</p> <p>前端部分</p> <div class="language-html extra-class"><pre class="language-html"><code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>script</span><span class="token punctuation">&gt;</span></span><span class="token script"><span class="token language-javascript">
  <span class="token keyword">let</span> socket <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">WebSocket</span><span class="token punctuation">(</span><span class="token string">'ws://localhost:8080'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  socket<span class="token punctuation">.</span><span class="token function-variable function">onopen</span> <span class="token operator">=</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    socket<span class="token punctuation">.</span><span class="token function">send</span><span class="token punctuation">(</span><span class="token string">'前端超神路'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span><span class="token punctuation">;</span>
  socket<span class="token punctuation">.</span><span class="token function-variable function">onmessage</span> <span class="token operator">=</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">e</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>e<span class="token punctuation">.</span>data<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span><span class="token punctuation">;</span>
</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>script</span><span class="token punctuation">&gt;</span></span>
</code></pre></div><p>后端部分</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">const</span> WebSocket <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'ws'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> server <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">WebSocket<span class="token punctuation">.</span>Server</span><span class="token punctuation">(</span><span class="token punctuation">{</span> port<span class="token operator">:</span> <span class="token number">8080</span> <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
server<span class="token punctuation">.</span><span class="token function">on</span><span class="token punctuation">(</span><span class="token string">'connection'</span><span class="token punctuation">,</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">socket</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  socket<span class="token punctuation">.</span><span class="token function">on</span><span class="token punctuation">(</span><span class="token string">'message'</span><span class="token punctuation">,</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">data</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    socket<span class="token punctuation">.</span><span class="token function">send</span><span class="token punctuation">(</span>data<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><h3 id="_6-window-postmessage"><a href="#_6-window-postmessage" class="header-anchor">#</a> 6.window.postMessage</h3> <p><code>window.postMessage()</code> 方法可以安全地实现<strong>跨源通信</strong>。通常，对于两个不同页面的脚本，只有当执行它们的页面位于具有<strong>相同的协议</strong>（通常为 <code>https</code>），端口号（<code>443</code> 为 <code>https</code> 的默认值），以及主机 (两个页面的模数 <code>Document.domain</code> 设置为相同的值) 时，这两个脚本才能相互通信。<strong>window.postMessage()</strong> 方法提供了一种受控机制来规避此限制，只要正确的使用，这种方法就很安全。</p> <h4 id="用途"><a href="#用途" class="header-anchor">#</a> 用途</h4> <ul><li><p>1.页面和其打开的新窗口的数据传递</p></li> <li><p>2.多窗口之间消息传递</p></li> <li><p>3.页面与嵌套的 <code>iframe</code> 消息传递</p></li></ul> <h4 id="用法"><a href="#用法" class="header-anchor">#</a> 用法</h4> <p>详细用法请移步 <a href="https://developer.mozilla.org/zh-CN/docs/Web/API/Window/postMessage" target="_blank" rel="noopener noreferrer">这里<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></p> <p><code>otherWindow.postMessage(message, targetOrigin, [transfer]);</code></p> <p><code>otherWindow</code>: 其他窗口的一个引用，比如 <code>iframe</code> 的 <code>contentWindow</code> 属性、执行<code>window.open</code>返回的窗口对象、或者是命名过或数值索引的<code>window.frames</code>。</p> <p><code>message</code>: 将要发送到其他 <code>window</code> 的数据。</p> <p><code>targetOrigin</code>: 通过窗口的 <code>origin</code> 属性来指定哪些窗口能接收到消息事件.</p> <p><code>transfer</code>(可选) : 是一串和 <code>message</code> 同时传递的 <code>Transferable</code> 对象. 这些对象的所有权将被转移给消息的接收方，而发送一方将不再保有所有权</p> <h4 id="示例"><a href="#示例" class="header-anchor">#</a> 示例</h4> <p><code>index.html</code></p> <div class="language-html extra-class"><pre class="language-html"><code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>iframe</span> <span class="token attr-name">src</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>http://localhost:8080<span class="token punctuation">&quot;</span></span> <span class="token attr-name">frameborder</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>0<span class="token punctuation">&quot;</span></span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>iframe<span class="token punctuation">&quot;</span></span> <span class="token attr-name">onload</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>load()<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>iframe</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>script</span><span class="token punctuation">&gt;</span></span><span class="token script"><span class="token language-javascript">
  <span class="token keyword">function</span> <span class="token function">load</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    iframe<span class="token punctuation">.</span>contentWindow<span class="token punctuation">.</span><span class="token function">postMessage</span><span class="token punctuation">(</span><span class="token string">'前端超神路'</span><span class="token punctuation">,</span> <span class="token string">'http://localhost:8080'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    window<span class="token punctuation">.</span><span class="token function-variable function">onmessage</span> <span class="token operator">=</span> <span class="token parameter">e</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
      console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>e<span class="token punctuation">.</span>data<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>script</span><span class="token punctuation">&gt;</span></span>
</code></pre></div><p><code>another.html</code></p> <div class="language-html extra-class"><pre class="language-html"><code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span><span class="token punctuation">&gt;</span></span>hello<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>script</span><span class="token punctuation">&gt;</span></span><span class="token script"><span class="token language-javascript">
  window<span class="token punctuation">.</span><span class="token function-variable function">onmessage</span> <span class="token operator">=</span> <span class="token parameter">e</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>e<span class="token punctuation">.</span>data<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// 前端超神路</span>
    e<span class="token punctuation">.</span>source<span class="token punctuation">.</span><span class="token function">postMessage</span><span class="token punctuation">(</span>e<span class="token punctuation">.</span>data<span class="token punctuation">,</span> e<span class="token punctuation">.</span>origin<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span><span class="token punctuation">;</span>
</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>script</span><span class="token punctuation">&gt;</span></span>
</code></pre></div><h3 id="_7-document-domain-iframe"><a href="#_7-document-domain-iframe" class="header-anchor">#</a> 7.<code>document.domain</code> + <code>Iframe</code></h3> <p>从第 7 种到第 9 种方式，我觉得别人的写的已经很好了，为了完整性，我就参考(照搬)别人的了。如有雷同....（不对，就是雷同....）不要说不出来。</p> <p><strong>「该方式只能用于二级域名相同的情况下，比如 a.test.com 和 b.test.com 适用于该方式」</strong>。只需要给页面添加 <code>document.domain ='test.com'</code> 表示二级域名都相同就可以实现跨域。</p> <div class="language- extra-class"><pre class="language-text"><code>www.   baidu.  com     .
三级域  二级域   顶级域   根域
</code></pre></div><div class="language-html extra-class"><pre class="language-html"><code>// a.test.com
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>body</span><span class="token punctuation">&gt;</span></span>
  helloa
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>iframe</span> <span class="token attr-name">src</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>http://b.test.com/b.html<span class="token punctuation">&quot;</span></span> <span class="token attr-name">frameborder</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>0<span class="token punctuation">&quot;</span></span> <span class="token attr-name">onload</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>load()<span class="token punctuation">&quot;</span></span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>frame<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>iframe</span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>script</span><span class="token punctuation">&gt;</span></span><span class="token script"><span class="token language-javascript">
    document<span class="token punctuation">.</span>domain <span class="token operator">=</span> <span class="token string">'test.com'</span><span class="token punctuation">;</span>
    <span class="token keyword">function</span> <span class="token function">load</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>frame<span class="token punctuation">.</span>contentWindow<span class="token punctuation">.</span>a<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
  </span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>script</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>body</span><span class="token punctuation">&gt;</span></span>
</code></pre></div><div class="language-html extra-class"><pre class="language-html"><code>// b.test.com
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>body</span><span class="token punctuation">&gt;</span></span>
  hellob
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>script</span><span class="token punctuation">&gt;</span></span><span class="token script"><span class="token language-javascript">
    document<span class="token punctuation">.</span>domain <span class="token operator">=</span> <span class="token string">'test.com'</span><span class="token punctuation">;</span>
    <span class="token keyword">var</span> a <span class="token operator">=</span> <span class="token number">100</span><span class="token punctuation">;</span>
  </span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>script</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>body</span><span class="token punctuation">&gt;</span></span>
</code></pre></div><h3 id="_8-window-location-hash-iframe"><a href="#_8-window-location-hash-iframe" class="header-anchor">#</a> 8. <code>window.location.hash + Iframe</code></h3> <h4 id="实现原理"><a href="#实现原理" class="header-anchor">#</a> 实现原理</h4> <p>原理就是通过 <code>url</code> 带 <code>hash</code> ，通过一个<strong>非跨域的中间页面</strong>来<strong>传递数据</strong>。</p> <h4 id="实现流程"><a href="#实现流程" class="header-anchor">#</a> 实现流程</h4> <p>一开始 <code>a.html</code> 给 <code>c.html</code> 传一个 <code>hash</code> 值，然后 <code>c.html</code> 收到 <code>hash</code> 值后，再把 <code>hash</code> 值传递给 <code>b.html</code>，最后 <code>b.html</code> 将结果放到 <code>a.html</code> 的 <code>hash</code> 值中。同样的，<code>a.html</code> 和 <code>b.html</code> 是同域的，都是 <code>http://localhost:8000</code>，而 <code>c.html</code> 是 <code>http://localhost:8080</code></p> <div class="language-html extra-class"><pre class="language-html"><code>// a.html
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>iframe</span> <span class="token attr-name">src</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>http://localhost:8080/hash/c.html#name1<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>iframe</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>script</span><span class="token punctuation">&gt;</span></span><span class="token script"><span class="token language-javascript">
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>location<span class="token punctuation">.</span>hash<span class="token punctuation">)</span><span class="token punctuation">;</span>
  window<span class="token punctuation">.</span><span class="token function-variable function">onhashchange</span> <span class="token operator">=</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>location<span class="token punctuation">.</span>hash<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span><span class="token punctuation">;</span>
</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>script</span><span class="token punctuation">&gt;</span></span>
</code></pre></div><div class="language-html extra-class"><pre class="language-html"><code>// b.html
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>script</span><span class="token punctuation">&gt;</span></span><span class="token script"><span class="token language-javascript">
  <span class="token comment">// parent: c; parent.parent: a</span>
  window<span class="token punctuation">.</span>parent<span class="token punctuation">.</span>parent<span class="token punctuation">.</span>location<span class="token punctuation">.</span>hash <span class="token operator">=</span> location<span class="token punctuation">.</span>hash<span class="token punctuation">;</span>
</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>script</span><span class="token punctuation">&gt;</span></span>
</code></pre></div><div class="language-html extra-class"><pre class="language-html"><code>// c.html
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>body</span><span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>body</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>script</span><span class="token punctuation">&gt;</span></span><span class="token script"><span class="token language-javascript">
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>location<span class="token punctuation">.</span>hash<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token keyword">const</span> iframe <span class="token operator">=</span> document<span class="token punctuation">.</span><span class="token function">createElement</span><span class="token punctuation">(</span><span class="token string">'iframe'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  iframe<span class="token punctuation">.</span>src <span class="token operator">=</span> <span class="token string">'http://localhost:8000/hash/b.html#name2'</span><span class="token punctuation">;</span>
  document<span class="token punctuation">.</span>body<span class="token punctuation">.</span><span class="token function">appendChild</span><span class="token punctuation">(</span>iframe<span class="token punctuation">)</span><span class="token punctuation">;</span>
</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>script</span><span class="token punctuation">&gt;</span></span>
</code></pre></div><p>这样就通过<strong>中间商</strong>(<code>b.html</code>)，实现了<code>a.html</code>和<code>c.html</code>之间(<strong>不同域</strong>)的跨域通信</p> <h3 id="_9-window-name-iframe"><a href="#_9-window-name-iframe" class="header-anchor">#</a> 9.window.name + Iframe</h3> <p><code>window</code> 对象的 <code>name</code> 属性是一个很特别的属性，当该 <code>window</code> 的 <code>location</code> 变化，然后重新加载，它的 <code>name</code> 属性可以依然保持不变。</p> <p>其中 <code>a.html</code> 和 <code>b.html</code> 是<strong>同域</strong>的，都是<code>http://localhost:8000</code>，而 <code>c.html</code> 是 <code>http://localhost:8080</code></p> <div class="language-html extra-class"><pre class="language-html"><code>// a.html
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>iframe</span>
  <span class="token attr-name">src</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>http://localhost:8080/name/c.html<span class="token punctuation">&quot;</span></span>
  <span class="token attr-name">frameborder</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>0<span class="token punctuation">&quot;</span></span>
  <span class="token attr-name">onload</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>load()<span class="token punctuation">&quot;</span></span>
  <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>iframe<span class="token punctuation">&quot;</span></span>
<span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>iframe</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>script</span><span class="token punctuation">&gt;</span></span><span class="token script"><span class="token language-javascript">
  <span class="token keyword">let</span> first <span class="token operator">=</span> <span class="token boolean">true</span><span class="token punctuation">;</span>
  <span class="token comment">// onload事件会触发2次，第1次加载跨域页，并留存数据于window.name</span>
  <span class="token keyword">function</span> <span class="token function">load</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>first<span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token comment">// 第1次onload(跨域页)成功后，切换到同域代理页面</span>
      iframe<span class="token punctuation">.</span>src <span class="token operator">=</span> <span class="token string">'http://localhost:8000/name/b.html'</span><span class="token punctuation">;</span>
      first <span class="token operator">=</span> <span class="token boolean">false</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>
      <span class="token comment">// 第2次onload(同域b.html页)成功后，读取同域window.name中数据</span>
      console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>iframe<span class="token punctuation">.</span>contentWindow<span class="token punctuation">.</span>name<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span>
</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>script</span><span class="token punctuation">&gt;</span></span>
</code></pre></div><p><code>b.html</code> 为中间代理页，与 <code>a.html</code> 同域，内容为空。</p> <div class="language-html extra-class"><pre class="language-html"><code>// b.html
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span><span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span>
</code></pre></div><div class="language-html extra-class"><pre class="language-html"><code>// c.html
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>script</span><span class="token punctuation">&gt;</span></span><span class="token script"><span class="token language-javascript">
  window<span class="token punctuation">.</span>name <span class="token operator">=</span> <span class="token string">'前端超神路'</span><span class="token punctuation">;</span>
</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>script</span><span class="token punctuation">&gt;</span></span>
</code></pre></div><p>通过 <code>iframe</code> 的 <code>src</code> 属性由外域转向本地域，跨域数据即由 <code>iframe</code> 的 <code>window.name</code> 从外域传递到本地域。这个就<strong>巧妙地绕过了浏览器的跨域访问限制</strong>，但同时它又是安全操作。</p> <h3 id="_10-浏览器开启跨域（终极方案）"><a href="#_10-浏览器开启跨域（终极方案）" class="header-anchor">#</a> 10.浏览器开启跨域（终极方案）</h3> <p>其实讲下其实<strong>跨域问题是浏览器策略</strong>，源头是他，那么能否能关闭这个功能呢？</p> <p>答案是肯定的。</p> <blockquote><p>注意事项: 因为浏览器是众多 <code>web</code> 页面入口。我们是否也可以像客户端那种，就是用一个单独的专门宿主浏览器，来打开调试我们的开发页面。例如这里以 <code>chrome canary</code> 为例，这个是我专门调试页面的浏览器，不会用它来访问其他 <code>web url</code>。因此它也相对于安全一些。当然这个方式，只限于当你真的被跨域折磨地崩溃的时候才建议使用以下。使用后，请以正常的方式将他打开，以免你不小心用这个模式干了其他的事。</p></blockquote> <h4 id="windows"><a href="#windows" class="header-anchor">#</a> Windows</h4> <div class="language- extra-class"><pre class="language-text"><code>找到你安装的目录
.\Google\Chrome\Application\chrome.exe --disable-web-security --user-data-dir=xxxx
</code></pre></div><h4 id="mac"><a href="#mac" class="header-anchor">#</a> Mac</h4> <p><code>~/Downloads/chrome-data</code> 这个目录<strong>可以自定义</strong>.</p> <div class="language- extra-class"><pre class="language-text"><code>/Applications/Google\ Chrome\ Canary.app/Contents/MacOS/Google\ Chrome\ Canary  --disable-web-security --user-data-dir=~/Downloads/chrome-data
</code></pre></div><p>效果展示</p> <p><img src="/blog/assets/img/cors21.90c7e7b1.png" alt="cors21.png"></p> <p>嗯，使用起来很香~，但是再次提醒，一般情况千万别轻易使用这个方式，这个方式好比<strong>七伤拳</strong>，使用的好威力无比，使用不好，很容易伤到自己。</p> <h2 id="三、为什么需要跨域？"><a href="#三、为什么需要跨域？" class="header-anchor">#</a> 三、为什么需要跨域？</h2> <p>在最一开始，我们知道了，跨域只存在于浏览器端。而浏览器为 <code>web</code> 提供访问入口。我们在可以浏览器内打开很多页面。正是这样的开放形态，所以我们需要对他有所限制。就比如林子大了，什么鸟都有，我们需要有一个<strong>统一的规范</strong>来进行约定才能保障这个安全性。</p> <h3 id="_1-限制不同源的请求"><a href="#_1-限制不同源的请求" class="header-anchor">#</a> 1.限制不同源的请求</h3> <p>这里还是用最常用的方式来讲解，例如用户登录 <code>a</code> 网站，同时新开 <code>tab</code> 打开了 <code>b</code> 网站，如果不限制同源， <code>b</code> 可以像 <code>a</code> 网站发起任何请求，会让不法分子有机可趁。</p> <h3 id="_2-限制-dom-操作"><a href="#_2-限制-dom-操作" class="header-anchor">#</a> 2.限制 dom 操作</h3> <p>举个例子吧, 你先登录下 <code>www.baidu.com</code> , 然后访问<a href="https://zerolty.com/node-demo/index.html" target="_blank" rel="noopener noreferrer">这个网址<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a>。</p> <p><img src="/blog/assets/img/cors22.3dcfe2f7.png" alt="cors22.png"></p> <p>你会发现，这个和真实的百度一模一样，如果再把域名搞的相似一些，是不是很容易被骗，如果可以进行 dom 操作...那么大家的信息在这种钓鱼网站眼里都是一颗颗小白菜，等着被收割。</p> <p>可以在 <code>http</code> 返回头 添加<code>X-Frame-Options: SAMEORIGIN</code> 防止被别人添加至 <code>iframe</code>。</p> <h2 id="写在最后"><a href="#写在最后" class="header-anchor">#</a> 写在最后</h2> <p>以上最常用的就是<code>前 4 种</code>方式，特别是<code>第 2 种</code>非常常见，我里面也提到了多种示例，大家可以慢慢消化一下。希望未来有更加安全的方式来限制 <code>web</code> ，解决跨域的头疼，哈哈哈哈。</p> <blockquote><p>有一个不成熟的想法，可以搞这么一个浏览器，只让访问内网/本地网络，专门给开发者用来调试页面用，对于静态资源可以配置白名单，这样是不是就没有跨域问题了，23333。上述如有错误，请第一时间指出，我会进行修改，以免给大家来误导。</p></blockquote> <h2 id="参考资料"><a href="#参考资料" class="header-anchor">#</a> 参考资料</h2> <ul><li><p><a href="https://stackoverflow.com/questions/12296910/so-jsonp-or-cors" target="_blank" rel="noopener noreferrer">https://stackoverflow.com/questions/12296910/so-jsonp-or-cors<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></p></li> <li><p><a href="https://juejin.im/post/5c23993de51d457b8c1f4ee1#heading-18" target="_blank" rel="noopener noreferrer">https://juejin.im/post/5c23993de51d457b8c1f4ee1#heading-18<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></p></li> <li><p><a href="https://juejin.im/post/5a6320d56fb9a01cb64ee191" target="_blank" rel="noopener noreferrer">https://juejin.im/post/5a6320d56fb9a01cb64ee191<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></p></li> <li><p><a href="https://developer.mozilla.org/zh-CN/docs/Web/HTTP/Access_control_CORS" target="_blank" rel="noopener noreferrer">https://developer.mozilla.org/zh-CN/docs/Web/HTTP/Access_control_CORS<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></p></li> <li><p><a href="https://developer.mozilla.org/zh-CN/docs/Web/Security/Same-origin_policy" target="_blank" rel="noopener noreferrer">https://developer.mozilla.org/zh-CN/docs/Web/Security/Same-origin_policy<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></p></li></ul> <h2 id="最后"><a href="#最后" class="header-anchor">#</a> 最后</h2> <p>文中若有不准确或错误的地方，欢迎指出，有兴趣可以的关注下<a href="https://github.com/GolderBrother" target="_blank" rel="noopener noreferrer">Github<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a>~</p> <div class="gitalk-container"><div id="gitalk-container"></div></div> <div class="gitalk-container"><div id="gitalk-container"></div></div></div> <footer class="page-edit"><!----> <div class="last-updated"><span class="prefix">Last Updated:</span> <span class="time">2020/9/7 下午8:45:37</span></div></footer> <div class="page-nav"><p class="inner"><span class="prev">
      ←
      <a href="/blog/views/webpack/webpack-optimize.html" class="prev">webpack 优化篇</a></span> <span class="next"><a href="/blog/views/vite/vite-study.html">vite原理剖析</a>
      →
    </span></p></div> </main></div><div class="global-ui"><!----></div></div>
    <script src="/blog/assets/js/app.74817549.js" defer></script><script src="/blog/assets/js/2.f761193d.js" defer></script><script src="/blog/assets/js/6.4efa9fa4.js" defer></script><script src="/blog/assets/js/23.dbb39e0a.js" defer></script>
  </body>
</html>
